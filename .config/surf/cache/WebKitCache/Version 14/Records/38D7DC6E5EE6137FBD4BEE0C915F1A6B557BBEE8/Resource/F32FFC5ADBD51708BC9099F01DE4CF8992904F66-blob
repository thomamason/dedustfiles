JAd.prototype.gO=ea(335,function(a){this.C.D.kV(a)});RAd.prototype.gO=ea(334,function(a){this.D.gO(a)});roa.prototype.Um=ea(57,function(){return Ii(this,2)});Ai.prototype.wx=ea(53,function(){return H(this,12)});function zJf(a){GR(a,function(b){b=new (b.H())(a.J,a.Za);ER(a,b);b.setVisible(!0)},"ritzmaestro")}function AJf(a,b){GR(a,function(c){c=c.C(b,this.J,this.Pa);ER(this,c);c.setVisible(!0)},"ritzmaestro")}
function BJf(a,b){GR(a,function(c){c=c.D(b,this.J,this.Pa);ER(this,c);c.setVisible(!0)},"ritzmaestro")}function CJf(a,b){var c=pd;qd(a,function(d,e){return c(b(d),b(e))})}function DJf(a){Gi(this,a,0,-1,null,null)}x(DJf,Fi);function EJf(a,b){var c=this;this.H=new qk;this.H.yh=!0;this.J=new qk;this.L=a;this.F=new tf;this.D=new Map;this.C=new Map;this.Ja=new hn(this);this.Ja.listen(b,"external_data_change",function(){FJf(c);c.F.dispatchEvent(null)});FJf(this)}
function GJf(a,b,c){for(var d=ka(bg(b,1)),e=d.next();!e.done;e=d.next()){e=e.value;var f=e.getFunctionName(),h=a.D.get(f);h?H(e,5)?(a.D.delete(f),a.C.set(f,h)):(f=H(e,3),I(h,8,f),(e=H(e,4))?I(h,9,e):$f(h,9)):(h=a.C.get(f),e=H(e,3),I(h,8,e),a.D.set(f,h),a.C.delete(f))}a.F.dispatchEvent(null);yk(Ao(uo(a.L.cf("/editactions"),{data:a.H.serialize(b)}),"POST"),c).Ve()}
function FJf(a){var b=HJf(a),c=new Map,d=new Map;b=ka(b);for(var e=b.next();!e.done;e=b.next())e=e.value,Wf(e,8)?c.set(e.getFunctionName(),e):H(e,11)||d.set(e.getFunctionName(),e);a.D=c;a.C=d}function HJf(a){return ritz_api.RitzModelApi.getCustomFunctions().map(function(b){return a.J.Sc(Ai.va(),b)})}function IJf(a){Gi(this,a,0,-1,null,null)}x(IJf,Fi);function JJf(a){Gi(this,a,0,-1,KJf,null)}x(JJf,Fi);function LJf(a){Gi(this,a,0,-1,null,null)}x(LJf,Fi);var KJf=[5,7,16,18,37,39];
LJf.prototype.getLabel=function(){return K(this,1)};function MJf(a){Gi(this,a,0,-1,NJf,null)}x(MJf,Fi);function E6(a){Gi(this,a,0,-1,null,null)}x(E6,Fi);var NJf=[1];MJf.prototype.Mt=function(a,b){Wi(this,1,a,E6,b)};r=E6.prototype;r.Rg=function(){return K(this,2)};r.Vj=function(a){L(this,2,a)};r.getKey=function(){return K(this,3)};r.getUrl=function(){return K(this,4)};r.zm=function(){return Ki(this,5,!1)};r.dc=function(a){L(this,5,a)};r.Ma=function(a){L(this,6,a)};function OJf(a){var b=PJf;this.J=a;this.country=this.language=null;this.H="https://clients5.google.com";this.D=null;this.C=new JJf;this.F=null;this.size=b;this.scrolling="auto"}OJf.prototype.clone=function(){return Yd(this)};function QJf(a){M.call(this);this.F=a;a=v(this.L,this);this.F.D=a;this.D=new Ln;this.H=new Qk;this.C=new Qk}x(QJf,M);QJf.prototype.J=0;QJf.prototype.connect=function(){this.F.connect(v(this.D.callback,this.D));this.D.addCallback(v(this.dispatchEvent,this,"Li"))};QJf.prototype.call=function(a,b,c,d){this.D.addCallback(function(){var e={data:b,messageId:this.J};this.H.set(this.J,{IX:c,HX:d});this.J++;this.F.send(a,e)},this)};
function RJf(a,b,c,d){a.D.addCallback(function(){this.F.send("_response",{data:b,messageId:c,result:d})},a)}QJf.prototype.L=function(a,b){if(sa(b))try{var c=JSON.parse(b)||{}}catch(d){return}else c=b;"_response"==a?(a=c,b=this.H.get(a.messageId),this.H.remove(a.Ef),(c=a.result)&&Ha(b.IX)&&b.IX(a.data),!c&&Ha(b.HX)&&b.HX(Error(a.data.message))):SJf(this,a,c)};
function SJf(a,b,c){if(b=a.C.get(b)){var d=v(function(e){RJf(this,e||{},c.messageId,!0)},a);a=v(function(e){var f={};f.message=e&&e.message||"";RJf(this,f,c.messageId,!1)},a);try{b(c.data,d,a)}catch(e){a(e)}}};function TJf(a,b,c){P.call(this,c);this.J=a;this.L=new QJf(this.J);this.C=b;this.H=this.D=null;this.F=b.D}x(TJf,P);r=TJf.prototype;r.getWidth=function(){return Iv(this.getElement()).width};r.setWidth=function(a){Gv(this.getElement(),a+"px");this.H.width=a;this.C.size.width=a};r.getHeight=function(){return Iv(this.getElement()).height};r.setHeight=function(a){Hv(this.getElement(),a+"px");this.H.height=a;this.C.size.height=a};r.Aa=function(){TJf.Oa.Aa.call(this);Fv(this.getElement(),this.C.size);UJf(this)};
function VJf(a,b){N(a.F,!b);a.D.style.visibility=b?"visible":"hidden"}function UJf(a){var b=a.oa();a.D=b.Aa("DIV");a.D.style.position="absolute";a.F=a.F||b.Aa("DIV");VJf(a,!1);var c=a.getElement();b.appendChild(c,a.D);b.appendChild(c,a.F);a_d(a.J,a.D,v(function(d){b.DH(d,{frameborder:0,style:"border: 0; vertical-align: bottom; transform: translateZ(0);",scrolling:this.C.scrolling,width:this.C.size.width,height:this.C.size.height});this.H=d},a));a.L.connect()};function WJf(a){this.C=new OJf(a);this.Za=void 0}var PJf=new Ll(735,500);function XJf(a,b){L(a.C.C,3,b);return a}function YJf(a){L(a.C.C,12,!0);return a}function ZJf(a,b){L(a.C.C,5,b||[])}function $Jf(a,b){L(a.C.C,6,b);return a}WJf.prototype.setHeight=function(a){this.C.size.height=a;return this};WJf.prototype.setWidth=function(a){this.C.size.width=a;return this};function aKf(a,b){L(a.C.C,9,b);L(a.C.C,10,!0);return a}
WJf.prototype.build=function(){var a=this.C.H,b=al(a+"/webstore/wall/widget","container",this.C.J,"utm_source",Wk(window.location.href),"utm_medium","apps-widget","ref",Zk(window.location.href));Ii(this.C.C,15)&&(b=al(b,"hdpa","true"));if(Ri(this.C.C,LJf,37)&&0<Ri(this.C.C,LJf,37).length){for(var c=Ri(this.C.C,LJf,37),d="",e=0;e<c.length;e++)0!=e&&(d+=","),d+=c[e].getLabel()+":"+K(c[e],2);b=al(b,"exp",d)}null!=this.C.language&&(b=al(b,"hl",this.C.language));null!=this.C.country&&(b=al(b,"gl",this.C.country));
null!=this.C.F&&(b=al(b,"authuser",this.C.F));Ki(this.C.C,41,!1)&&(b=al(b,"force_show_apps",""));c={};Wd(c,"pu",b);Wd(c,"ph",a);Wd(c,"tp",1);Wd(c,"osh",!0);a=new XY(c,this.Za);return new TJf(a,this.C.clone(),this.Za)};function bKf(a){D.call(this);this.C=a;this.D=a.L;a=v(this.eSb,this);this.D.C.set("beforeInstall",a);a=v(this.L2b,this);this.D.C.set("afterInstall",a);a=v(this.fTb,this);this.D.C.set("launch",a);a=v(this.Mbb,this);this.D.C.set("getStoreConfig",a);a=v(this.O2b,this);this.D.C.set("onRendered",a);a=v(this.ubb,this);this.D.C.set("getPopupUrl",a);a=v(this.FSb,this);this.D.C.set("onEscape",a);a=v(this.N2b,this);this.D.C.set("onManageMenu",a);a=v(this.M2b,this);this.D.C.set("onManageMenuEvent",a);a=v(this.fSb,
this);this.D.C.set("beforeNavigate",a)}x(bKf,D);r=bKf.prototype;r.getView=g("C");r.JVa=ba();r.$Oa=function(a,b){b(!0)};r.ova=ba();r.pPa=function(a,b){b(null)};r.Vqa=ba();r.IVa=function(a,b){b(null)};r.HVa=ba();r.Hqa=function(){this.D.call("navigate",{navigatePage:"userItems",forceRefresh:!1})};function cKf(a,b,c){var d={};d.itemId=b;a.D.call("uninstall",d,c,xa)}r.fSb=function(a,b){b({shouldNavigate:!0})};r.O2b=function(){VJf(this.C,!0);this.JVa()};
r.eSb=function(a,b){this.$Oa(a.itemId,function(c){var d={};d.shouldInstall=c;b(d)})};r.L2b=function(a,b){this.ova(a.itemId,!!a.installResult);b()};r.fTb=function(a,b){b()};r.Mbb=function(a,b){a={};a.storeConfigProto=this.C.C.C.serialize();b(a)};r.ubb=function(a,b){this.pPa(a.itemId,function(c){var d={};d.installFlowPopupUrl=c;b(d)})};r.FSb=function(a,b){this.Vqa();b()};r.N2b=function(a,b){this.IVa(a.itemId,function(c){var d={};d.manageMenuProto=c.serialize();b(d)})};
r.M2b=function(a){this.HVa(a.itemId,a.manageMenuEventKey)};function dKf(){return R('<div class="waffle-edit-actions-dialog-scroll"><div class="waffle-edit-actions-dialog-actions-row-container"></div><div class="waffle-edit-actions-empty" role="alert">There are no macros</div></div>')}
function eKf(a){return R('<div class="waffle-edit-actions-row"><div class="waffle-edit-actions-row-name"><input class="waffle-edit-actions-name-input jfk-textinput" maxlength="50"/><div class="waffle-edit-actions-shortcut-conflict-message"></div></div><div class="waffle-edit-actions-options"><div class="waffle-edit-actions-row-shortcut-prefix">'+Q(a.Eta)+'</div><div class="waffle-edit-actions-row-shortcut"><input class="waffle-edit-actions-row-shortcut-input jfk-textinput" maxlength="1"/></div><div class="waffle-edit-actions-row-menu"></div></div></div>')}
;function fKf(a,b,c,d){qA.call(this,void 0,!1,d);var e=this;this.R=a;this.O=Array.from(this.R.D.values());CJf(this.O,function(f){return f.getFunctionName()});this.F=b;this.V=c;this.C=new Map;this.L=null;this.H=new Scc("Macro removed","UNDO",function(){return gKf(e)},void 0,this.oa(),"off");this.qa(this.H);IA(this.V,this.H);gx(this,ix(new dx,lx,!1,!0).set("save","Update",!0))}t(fKf,qA);
fKf.prototype.Aa=function(){qA.prototype.Aa.call(this);this.Rq=!1;fx(this,!1);hKf(this,!1);B(A(),"docs-egmd")?(V(ax(this),"waffle-edit-actions-dialog-gm"),sx(this,"save")):V(ax(this),"waffle-edit-actions-dialog");this.setTitle("Manage macros");this.Eb().appendChild(W(dKf));for(var a=this.Ea("waffle-edit-actions-dialog-actions-row-container"),b=ka(this.O),c=b.next();!c.done;c=b.next()){c=c.value;var d=new iKf(c,this.F);this.Fa(d);this.C.set(c.getFunctionName(),d);d.render(a)}N(this.Ea("waffle-edit-actions-empty"),
!1);this.H.render();V(this.H.La(),"waffle-edit-actions-undo-remove-toast")};function hKf(a,b){hx(a.D,"save").disabled=!b}fKf.prototype.Ga=function(){var a=this;qA.prototype.Ga.call(this);jKf(this);this.getHandler().listen(this,"dialogselect",this.ea).listen(this.La(),"keydown",function(b){13==b.keyCode&&"INPUT"==b.target.tagName&&(b.target.setSelectionRange(0,0),b.target.blur(),b.preventDefault());90==b.keyCode&&b.ctrlKey&&gKf(a)});kKf(this)};
function jKf(a){for(var b={},c=ka(a.C.values()),d=c.next();!d.done;b={nK:b.nK},d=c.next())b.nK=d.value,a.getHandler().listen(b.nK.V,"action",function(e){return function(){return lKf(a,e.nK)}}(b)).listen(mKf(b.nK),"input",function(e){return function(){var f=e.nK;nKf(f)?ZV(f.$I):YV(f.$I,"Must be a number from 0 to 9 or blank.",!0);f=!kKf(a)&&nKf(f);hKf(a,f)}}(b)).listen(oKf(b.nK),"input",function(){a.F.C(29573);hKf(a,!0)})}
function kKf(a){var b=new Map;a=ka(a.C.values());for(var c=a.next();!c.done;c=a.next())c=c.value,b.has(pKf(c))?b.get(pKf(c)).push(c):b.set(pKf(c),[c]);a=!1;c=null;b=ka(b);for(var d=b.next();!d.done;d=b.next()){var e=ka(d.value);d=e.next().value;e=e.next().value;1<e.length&&""!=d?(a=!0,c=d,e.forEach(function(h){h=h.Ea("waffle-edit-actions-shortcut-conflict-message");tu(h,"Conflicts with another shortcut");N(h,!0)})):e.forEach(function(h){h=h.Ea("waffle-edit-actions-shortcut-conflict-message");N(h,
!1)})}if(a){var f="Can't save conflicting shortcut "+c;setTimeout(function(){return tK(f)})}return a}function lKf(a,b){hKf(a,!0);a.L=b;a.C.delete(b.Ba);N(b.La(),!1);kKf(a);a.H.setVisible(!0);0==a.C.size&&N(a.Ea("waffle-edit-actions-empty"),!0);a.La().focus();var c="Macro "+(b.C.getValue()+" was removed, Ctrl-Z to undo");setTimeout(function(){return tK(c)});a.F.C(29572)}
function gKf(a){if(null!=a.L){var b=a.L;a.C.set(b.Ba,b);N(b.La(),!0);N(a.Ea("waffle-edit-actions-empty"),!1);kKf(a);a.L=null;var c="Macro "+(b.C.getValue()+" was restored.");setTimeout(function(){return tK(c)});a.F.C(29577)}}
fKf.prototype.ea=function(a){var b=this;if("cancel"==a.key)this.F.C(29569);else if("save"==a.key){for(var c=ka(this.C.values()),d=c.next();!d.done;d=c.next())if(d=d.value,!nKf(d)||""!=qKf(d)){a.preventDefault();return}kKf(this)?a.preventDefault():(a=rKf(this),GJf(this.R,a,function(){var e=HA(b.V,"Failed to update macros.",Lt(),!0,0,!0,void 0,!0,["waffle-edit-actions-update-failed"]);e.D=!0;e.render();e.setVisible(!0)}),this.F.C(29574),setTimeout(function(){return tK("Macros updated")}))}};
function rKf(a){for(var b=new Occ,c=ka(a.O),d=c.next();!d.done;d=c.next()){var e=d.value;d=new bO;var f=!1,h=a.C.get(e.getFunctionName()),k=H(e,9),l=H(e,8);h?(k!=pKf(h)&&(k=pKf(h),f=!0),l!=h.C.getValue()&&(l=h.C.getValue(),f=!0)):(I(d,5,!0),f=!0);f&&(f=e.Nh(),I(d,1,f),e=e.getFunctionName(),I(d,2,e),I(d,3,l),k&&I(d,4,k),Yf(b,1,d))}return b}
function iKf(a,b,c){P.call(this,c);this.xa=a;this.Ha=H(a,8);this.Ba=a.getFunctionName();this.J=(a=H(a,9))?a.split("+"):[];this.D=new Sz;this.Fa(this.D);this.L=this.O=null;this.C=new Sz;this.Fa(this.C);this.ea=new wA;this.qa(this.ea);this.Da=b;b=Ix(ly,"waffle-overflow-menu-material");this.H=new By(void 0,void 0,b,this.oa());this.qa(this.H);this.R=new ry("Edit script");this.qa(this.R);this.V=new ry("Remove");this.qa(this.V);this.$I=new XV(this.oa());this.qa(this.$I);this.F=new XV(this.oa());this.qa(this.F)}
t(iKf,P);iKf.prototype.Aa=function(){var a=(ad(this.J)?sKf:this.J.slice(0,this.J.length-1)).join(" + ")+" + ";a=W(eKf,{Eta:C.Ym.np?a.replace(/Ctrl/g,"\u2318").replace(/Alt/g,"Option"):a});this.wb(a)};
iKf.prototype.Ga=function(){var a=this;this.D.Va(this.Ea("waffle-edit-actions-row-shortcut-input"));this.D.setValue(Nc(this.J)||"");B(A(),"docs-egmd")||V(this.Ea("waffle-edit-actions-row-shortcut"),TZ.getInstance().Yb());var b=this.Ea("waffle-edit-actions-name-input");this.C.Va(b);this.C.setValue(this.Ha);B(A(),"docs-egmd")||V(this.Ea("waffle-edit-actions-row-name"),TZ.getInstance().Yb());this.ea.Va(b);this.$I.setPosition(3,2);this.$I.render();b=this.D.La();this.$I.nj(b);$V(this.$I,b);ZV(this.$I);
this.F.setPosition(0,2);this.F.render();b=this.C.La();this.F.nj(b);$V(this.F,b);ZV(this.F);b=new Bw(this.H.Eb(),13);gW(this.H,b);this.H.dP=!0;this.H.Pc(this.R);this.H.Pc(this.V);b=this.Ea("waffle-edit-actions-row-menu");this.H.Va(b);"black"==Jy()&&V(b,"waffle-overflow-menu-material-white");this.getHandler().listen(this.R,"action",function(){(Jt(),$s).Fb({scriptId:a.xa.Nh(),filename:a.xa.getFileName()});a.Da.C(29570)}).listen(this.C.La(),"blur",function(){""==qKf(a)?ZV(a.F):YV(a.F,qKf(a),!0)}).listen(this.D.La(),
"click",function(){return a.D.La().select()}).listen(mKf(this),"input",function(){return a.Da.C(29571)});Gw(this.Ea("waffle-edit-actions-name-input"),"Macro name");Gw(this.D.La(),"Numeric shortcut key");Gw(b,"More options button")};function pKf(a){var b=a.D.getValue();return""==b?"":(ad(a.J)?sKf:a.J.slice(0,a.J.length-1)).join("+")+"+"+b}function mKf(a){null==a.O&&(a.O=new vA(a.D.La()),a.qa(a.O));return a.O}function oKf(a){null==a.L&&(a.L=new vA(a.C.La()),a.qa(a.L));return a.L}
function nKf(a){a=a.D.getValue();return""==a||/^\d$/.test(a)}function qKf(a){a=a.C.getValue();return""==a?"Macro name cannot be empty.":/\r|\n/.test(a)?"Macro name cannot contain line-break characters.":""}var sKf=["Ctrl","Alt","Shift"];function tKf(){return R('<div class="waffle-import-custom-function-actions-title-separator"></div><div class="waffle-import-custom-function-actions-dialog-scroll"><div class="waffle-import-custom-functions-row-container"></div></div>')}
function uKf(a){var b=a.CVb,c=a.fileName;a='<div class="waffle-import-custom-function-row" tabindex="0"><div class="waffle-import-custom-function-name">'+Q(a.functionName)+'</div><div class="waffle-import-custom-function-metadata"><div class="waffle-import-custom-function-project-name"><span class="waffle-import-custom-function-description-label">';a=a+'Project:</span><span class="function-description-seperator"></span>'+(Q(b)+'</div><div class="waffle-import-custom-function-file-name"><span class="waffle-import-custom-function-description-label">');
a=a+'File:</span><span class="function-description-seperator"></span>'+(Q(c)+'</div></div><div class="waffle-import-custom-function-view-script"></div><div class="waffle-import-custom-function-add-function"></div></div>');return R(a)};function vKf(a,b,c,d){qA.call(this,void 0,!1,d);this.ea=a;this.H=Array.from(this.ea.C.values());CJf(this.H,function(e){return e.getFunctionName()});this.V=b;this.xa=c;this.R=[];this.F=[];this.C=HA(this.xa,"Function added.",Lt(),!1,3E3,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);this.qa(this.C);this.Ha=new zA(this.oa());this.qa(this.Ha);this.L=new io(this.O,3E3,this);this.qa(this.L)}t(vKf,qA);
vKf.prototype.Aa=function(){qA.prototype.Aa.call(this);V(ax(this),"waffle-import-custom-function-actions-dialog");this.setTitle("Import");var a=this.oa().Aa("DIV","waffle-import-custom-function-title-description","Added functions will appear in the menu under Tools > Macros");Yw(this).appendChild(a);this.Eb().appendChild(W(tKf));a=this.Ea("waffle-import-custom-functions-row-container");for(var b=ka(this.H),c=b.next();!c.done;c=b.next())c=new wKf(c.value,this.V),this.Fa(c),c.render(a),this.R.push(c);
this.C.render();this.C.setVisible(!1);gx(this,null)};vKf.prototype.Ga=function(){var a=this;qA.prototype.Ga.call(this);for(var b={},c=ka(this.R),d=c.next();!d.done;b={i4:b.i4},d=c.next())b.i4=d.value,this.getHandler().listen(b.i4.D,"action",function(e){return function(){return xKf(a,e.i4)}}(b));this.getHandler().listen(this,"hide",function(){return a.O()})};
function xKf(a,b){yKf(b);var c=zKf(b.C);AKf(a,c);b=b.Ea("waffle-import-custom-function-add-function");b.setAttribute("tabindex","0");Gw(b,"This function has been added.");b.focus();a.V.C(29576);setTimeout(function(){return a.C.setVisible(!0)})}function zKf(a){var b=new bO,c=a.Nh();I(b,1,c);c=a.getFunctionName();I(b,2,c);a=a.getFunctionName();I(b,3,a);return b}function AKf(a,b){a.F.push(b);a.L.start()}
vKf.prototype.O=function(){var a=this;if(0<this.F.length){var b=new Occ;this.F.forEach(function(c){Yf(b,1,c)});GJf(this.ea,b,function(){var c=HA(a.xa,"Failed to add function.",Lt(),!1,1E4,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);c.D=!0;c.render();c.setVisible(!0)});this.F=[]}};
function wKf(a,b,c){P.call(this,c);this.C=a;this.H=b;a=B(A(),"docs-egmd")?BA.getInstance():void 0;this.D=new ny("Add function",a,c);this.Fa(this.D);this.F=new ny("Edit script",a,c);this.Fa(this.F)}t(wKf,P);wKf.prototype.Aa=function(){P.prototype.Aa.call(this);var a=W(uKf,{functionName:this.C.getFunctionName(),CVb:this.C.tZ(),fileName:this.C.getFileName()});this.wb(a);this.D.render(this.Ea("waffle-import-custom-function-add-function"));this.F.render(this.Ea("waffle-import-custom-function-view-script"))};
wKf.prototype.Ga=function(){var a=this;P.prototype.Ga.call(this);this.getHandler().listen(this.F,"action",function(){(Jt(),$s).Fb({scriptId:a.C.Nh(),filename:a.C.getFileName()});a.H.C(29575)});var b="Function: "+(this.C.getFunctionName()+(", from project: "+(this.C.tZ()+(", defined in file: "+this.C.getFileName()))));Gw(this.La(),b)};function yKf(a){N(a.D.La(),!1);V(a.Ea("waffle-import-custom-function-add-function"),"waffle-import-custom-function-actions-checkmark")};function BKf(a,b){this.C=!1;this.D=a;this.F=b}t(BKf,qf);BKf.prototype.getState=g("F");BKf.prototype.Ia=function(){qf.prototype.Ia.call(this)};function CKf(a,b){D.call(this);this.H=a;this.C=b;this.F=new qk}t(CKf,D);CKf.prototype.D=function(){var a=this.H,b=null;if(null!=this.C&&null!=this.C.getSelection()){var c=this.C.getSelection();b=xva(c);b=b[b.length-1];var d=ef(c.Bb()),e={};b=(e.gid=d,e.scol=b.xc(),e.ecol=b.cd(),e.srow=b.Bc(),e.erow=b.$c(),e);Wd(b,"sel",this.F.serialize(c.C));b=yl(b)}return new BKf(a,b)};function DKf(a,b,c,d,e,f){D.call(this);this.C=a;this.functionName=b;this.F=d||null;this.D=ra(f)?f:null}t(DKf,D);function F6(a){Gi(this,a,0,-1,EKf,null)}x(F6,Fi);var EKf=[6];r=F6.prototype;r.Rg=function(){return K(this,2)};r.Vj=function(a){L(this,2,a)};r.getKey=function(){return K(this,5)};function G6(a){return Ri(a,F6,6)}r.Pc=function(a){Wi(this,6,a,F6,void 0)};r.Ma=function(a){L(this,7,a)};r.wx=function(){return K(this,13)};function FKf(a){Gi(this,a,"amep",-1,null,null)}x(FKf,Fi);FKf.Ef="amep";FKf.prototype.Sb=function(){return Qi(this,F6,1,1)};FKf.prototype.hf=function(a){Si(this,1,a)};FKf.prototype.nha=function(){L(this,1,void 0)};FKf.prototype.ws=function(){return null!=K(this,1)};function H6(a){Sm.call(this,a)}t(H6,Sm);function GKf(a){Sm.call(this,"amep");this.D=new FKf(a)}t(GKf,H6);GKf.prototype.C=g("D");function HKf(a){Gi(this,a,0,-1,null,null)}x(HKf,Fi);function I6(a){return K(a,2)}HKf.prototype.getName=function(){return K(this,3)};HKf.prototype.Be=function(a){L(this,3,a)};HKf.prototype.Ok=function(){return K(this,13)};function J6(a,b){this.C=void 0===a?null:a;this.D=(void 0===b?null:b)||null}J6.prototype.F=g("D");function IKf(a,b){return B(A(),"docs-emgsmw")?null==a.F||null==K(b,18)?!1:a.D===K(b,18):a.C===K(b,1)}function JKf(a){return new J6(K(a,1),K(a,18))};function KKf(a){Gi(this,a,"der",-1,null,null)}x(KKf,Fi);KKf.Ef="der";KKf.prototype.Um=function(){return Ii(this,1)};function LKf(a){Gi(this,a,"eer",-1,null,null)}x(LKf,Fi);LKf.Ef="eer";LKf.prototype.Um=function(){return Ii(this,1)};function MKf(a,b,c){this.D=a;this.C=b;this.F=c}MKf.prototype.getVersionInfo=g("F");function NKf(a,b){this.C=a;this.D=b}NKf.prototype.getVersionInfo=g("D");function OKf(a,b){this.C=a;this.Md=b}OKf.prototype.getExtension=g("C");OKf.prototype.isEnabled=g("Md");function PKf(a){this.C=new Ll(980<window.innerWidth-100?980:510,Math.max(425,window.innerHeight-100));this.scrolling="auto";this.F="https://gsuite.google.com";this.D=a};function QKf(a){M.call(this);this.C=a;a=this.L.bind(this);this.C.D=a;this.D=new Map;this.J=new Map;this.H=0;this.F=null}t(QKf,M);QKf.prototype.connect=function(){var a=this;this.F=(new mn(function(b){a.C.connect(b)})).then(function(){a.dispatchEvent("Mi")})};function RKf(a,b,c){a.J.set(b,c)}QKf.prototype.call=function(a,b,c,d){var e=this;this.F.then(function(){var f={data:b,messageId:e.H};e.D.set(e.H,{IX:c,HX:d});e.H++;e.C.send(a,f)})};
function SKf(a,b,c,d){a.F.then(function(){a.C.send("_response",{data:b,messageId:c,result:d})})}QKf.prototype.L=function(a,b){if(sa(b))try{var c=JSON.parse(b)||{}}catch(d){return}else c=b;if("_response"==a){if(a=TKf(c),c=Number(a.messageId),b=this.D.get(c))this.D.delete(c),(c=!!a.result)&&Ha(b.IX)&&b.IX(a.data),!c&&Ha(b.HX)&&b.HX(Error(String(a.data.message)))}else UKf(this,a,TKf(c))};function TKf(a){return{messageId:a.messageId,data:a.data,result:a.result}}
function UKf(a,b,c){if(b=a.J.get(b)){var d=function(f){SKf(a,f||{},Number(c.messageId),!0)},e=function(f){var h={};h.message=f&&f.message||"";SKf(this,h,Number(c.messageId),!1)}.bind(a);try{b(c.data,d,e)}catch(f){e(f)}}}QKf.prototype.close=function(){this.C.close()};function VKf(a,b,c){P.call(this,c);this.H=a;this.L=new QKf(this.H);this.F=b;this.C=b.H}t(VKf,P);VKf.prototype.Aa=function(){P.prototype.Aa.call(this);Fv(this.La(),this.F.C);WKf(this)};function XKf(a){N(a.C,!0);a.D.style.visibility="hidden"}VKf.prototype.setWidth=function(a){Gv(this.La(),a+"px");Gv(this.J,a+"px")};VKf.prototype.setHeight=function(a){Hv(this.La(),a+"px");Hv(this.J,a+"px")};
function WKf(a){var b=a.oa();a.D=b.Aa("DIV");a.C=a.C||b.Aa("DIV");XKf(a);var c=a.getElement();b.appendChild(c,a.D);b.appendChild(c,a.C);a_d(a.H,a.D,function(d){b.DH(d,{frameBorder:0,visibility:"visible",style:"border: 0; vertical-align: bottom;",scrolling:a.F.scrolling});Fv(d,a.F.C);a.J=d});a.L.connect()};function YKf(){var a={"business-tools":2,education:3,productivity:4,"sales-and-crm":5,"accounting-and-finance":6,"administration-and-management":7,"erp-and-logistics":8,"hr-and-legal":9,"marketing-and-analytics":10,"academic-resources":11,"teacher-and-admin-tools":12,"creative-tools":13,"web-development":14,"office-applications":15,"task-management":17,communication:18,utilities:19,"works-with-drive":20,"popular-apps":21,"top-rated":22,marquee:23,"works-with-android":24,"works-with-form":25,"works-with-doc":26,
"works-with-spreadsheet":27,"works-with-slides":34,"isv-for-work-apps":28,"new-and-notable":29,"works-with-gmail":33,"works-with-calendar":35};this.rb={};this.C={};if(a)for(var b in a){var c=b,d=a[b];this.rb[c]=d;this.C[d]=c}}YKf.prototype.get=function(a){return this.rb[a]};YKf.prototype.remove=function(a){var b=this.rb[a];void 0!==b&&(delete this.rb[a],delete this.C[b])};var ZKf=new YKf;function $Kf(a){return ZKf.C[a]||"undefined"};var K6={},aLf=(K6.gmail_addon={lG:$Kf(33),WO:"gaw"},K6.drive_app={lG:$Kf(20),WO:"drive_app_widget"},K6.docs_addon={lG:$Kf(26),WO:"docs_addon_widget"},K6.sheets_addon={lG:$Kf(27),WO:"sheets_addon_widget"},K6.slides_addon={lG:$Kf(34),WO:"slides_addon_widget"},K6.forms_addon={lG:$Kf(25),WO:"forms_addon_widget"},K6.calendar_addon={lG:$Kf(35),WO:"caw"},K6);function bLf(a,b){b=void 0===b?!1:b;this.Za=Lt(document);this.C=new PKf(a);this.H=0;this.D=[];this.L=b}
bLf.prototype.setWidth=function(a){this.C.C.width=980<a?980:510;return this};bLf.prototype.setHeight=function(a){this.C.C.height=Math.max(425,a);return this};function cLf(a){var b=Lc(A(),"docs-gsmd");a.C.F=b}function dLf(a,b){a.D=b}
bLf.prototype.build=function(){var a={},b=aLf[this.C.D];if(!b)throw Error("Unimplemented container type");var c=this.C.F+"/u/"+this.H;this.L?c+="/marketplace/appfinder/myapps":this.F?c+="/marketplace/appfinder/app/"+this.F:b.lG&&(c+="/marketplace/appfinder/category/"+aLf[this.C.D].lG);c=al(c,"origin",Zk(window.location.href),"extension_type",this.C.D,"pann",b.WO);0<this.D.length&&(c=al(c,"pre_installed_app_ids",this.D.join(",")));this.J&&(c=al(c,"hl",this.J));a.pu=c;a.ph=this.C.F;a.tp=1;a.osh=!0;
a=new XY(a,this.Za);return new VKf(a,this.C,this.Za)};function eLf(a){qA.call(this);this.C=a;cx(this,!0);this.Dx(!1);gx(this,null);fx(this,!1)}t(eLf,qA);eLf.prototype.Aa=function(){qA.prototype.Aa.call(this);this.C.render(this.Eb())};eLf.prototype.Ga=function(){qA.prototype.Ga.call(this);var a=this.La();Ew(a,"labelledby");Gw(a,"Add-ons");V(ax(this),"gsm-widget")};function fLf(a){Gi(this,a,0,-1,gLf,null)}x(fLf,Fi);function L6(a){Gi(this,a,0,-1,null,null)}x(L6,Fi);var gLf=[1];r=L6.prototype;r.Rg=function(){return K(this,2)};r.Vj=function(a){L(this,2,a)};r.getKey=function(){return K(this,3)};r.getUrl=function(){return K(this,4)};r.zm=function(){return Ki(this,5,!1)};r.dc=function(a){L(this,5,a)};r.Ma=function(a){L(this,6,a)};fLf.prototype.Mt=function(a,b){Wi(this,1,a,L6,b)};function hLf(a){P.call(this);this.C=a;this.D=a.L;iLf(this)}t(hLf,P);
function iLf(a){RKf(a.D,"onRendered",function(){var b=a.C;N(b.C,!1);b.D.style.visibility="visible";a.UNa()});RKf(a.D,"onAfterInstall",function(b){var c=b.script_id,d=b.user_version_info;a.RNa(b.app_id,c?c:void 0,d?d:void 0)});RKf(a.D,"onAfterUninstall",function(b){var c=b.user_version_info;a.XOa(b.app_id,c?c:void 0)});RKf(a.D,"getDocumentName",function(b,c){c&&c({document_name:""})});RKf(a.D,"onManageMenu",function(b,c){b=a.TNa(Number(b.app_id));if(c){var d={};d.manage_menu_proto=b.serialize();c(d)}});
RKf(a.D,"onManageMenuEvent",function(b){a.SNa(Number(b.app_id),String(b.manage_menu_event_key))});RKf(a.D,"onClose",function(){a.dPa()})}r=hLf.prototype;r.UNa=ba();r.RNa=ba();r.XOa=ba();r.TNa=function(){return new fLf};r.SNa=ba();r.dPa=ba();function jLf(a,b){var c=new cj,d=new DJf;if(b){var e=K(b,1);L(d,1,e);e=Ii(b,12);L(d,2,e);null!=K(b,18)&&(e=K(b,18),L(d,5,e));b=Ii(b,19);L(d,6,b)}b=Kc(A(),"docs-tcmt");e=!!b;L(d,3,e);e&&L(d,4,b);Si(c,73,d);return gy(hy(new fy,c),a).build()}function kLf(a){var b=new cj,c=new DJf;null!=a.C&&L(c,1,a.C);null!=a.D&&L(c,5,a.D);Si(b,73,c);return gy(hy(new fy,b),90).build()};function lLf(a,b,c){hLf.call(this,a);this.F=b;this.H=c;this.F.Mi=!0}t(lLf,hLf);r=lLf.prototype;r.UNa=function(){(Jt(),hVa).Fb()};r.RNa=function(a,b,c){a=new J6(null,a);(Jt(),gVa).Fb(new MKf(a,String(b),c),kLf(a))};r.XOa=function(a,b){a=new J6(null,a);(Jt(),kVa).Fb(new NKf(a,b),kLf(a))};
r.TNa=function(a){var b=new fLf,c=this.H(new J6(null,a));if(!c)return b;a=c.getExtension();c=c.isEnabled();var d=new L6;d.Vj("Use in this document");L(d,3,"useInDoc");d.dc(!!Ii(a,4)||!!Ii(a,12));d.Ma(c);var e=new L6;e.Vj("Help");L(e,3,"help");d=[d,e];Ii(a,9)&&(e=new L6,L(e,1,!0),d.push(e),Ii(a,8)&&(a=new L6,a.Ma(c),a.Vj("Settings"),L(a,3,"settings"),d.push(a)),a=new L6,a.Vj("Report an issue"),L(a,3,"reportIssue"),d.push(a));Vi(b,1,d);return b};
r.SNa=function(a,b){var c=new J6(null,a);a=kLf(c);switch(b){case "help":b=this.H(c);if(!b)break;b=b.getExtension();(Jt(),bt).Fb(I6(b),a);break;case "reportIssue":(Jt(),iVa).Fb(c,a);break;case "settings":(Jt(),jVa).Fb(c,a);F(this.F);break;case "useInDoc":(Jt(),lVa).Fb(c,a)}};r.dPa=function(){this.F.setVisible(!1)};function mLf(a,b,c){D.call(this);this.C=nLf(a);this.F=b;this.D=c}t(mLf,D);function oLf(a,b,c,d,e){b=new bLf(b,e);cLf(b);a.D&&(b.J=a.D);dLf(b,c.map(function(f){return f.D}));d&&d.D&&(b.F=d.D);a=Lc(A(),"gaia_session_id");a=Bd(a)?NaN:Number(a);isNaN(a)||(b.H=a);return b.build()}function pLf(a,b){var c=new eLf(b);a=new lLf(b,c,a.F);c.qa(a);return c}
function nLf(a){if(a==(oz(),lz))return"docs_addon";if(a==(oz(),mz))return"sheets_addon";if(a==(oz(),nz))return"slides_addon";if(a==(oz(),t7a))return"forms_addon";throw Error("Unsupported document type for GSM  ["+a+"]");};function qLf(a,b){qA.call(this);this.C=b.build();gx(this,N3a());this.setTitle(a)}x(qLf,qA);function rLf(a){var b=tA();b=Bd(b)?NaN:Number(b);a=new WJf(a);var c=Lc(A(),"docs-cwsd");a.C.H=c;isNaN(b)||(a.C.F=b);return a}qLf.prototype.Aa=function(){qLf.Oa.Aa.call(this);this.C.render(this.Eb());du($w(this))};qLf.prototype.Km=function(){qLf.Oa.Km.call(this);try{C.Hb&&this.oa().Wb().body.focus(),this.getElement().focus()}catch(a){}};qLf.prototype.getView=g("C");function M6(a,b){qA.call(this,void 0,!0,b);Xw(this,Ie(a));this.setVisible(!0);this.Mi=!0;gx(this,ix(new dx,{key:"close",caption:"Close"},!0,!0));sx(this,"close");this.setTitle("Oops")}t(M6,qA);M6.prototype.Ga=function(){qA.prototype.Ga.call(this);this.addEventListener("dialogselect",this.C)};M6.prototype.Dd=function(){qA.prototype.Dd.call(this);this.removeEventListener("dialogselect",this.C)};M6.prototype.Km=function(){qA.prototype.Km.call(this);this.getElement().focus()};
M6.prototype.C=function(a){"close"==a.key&&this.setVisible(!1)};function sLf(a,b,c,d){bKf.call(this,a.getView());this.F=a;this.H=b;this.O=c;this.L=this.R=this.J=null;this.V=!!d;this.F.Mi=!0}t(sLf,bKf);r=sLf.prototype;
r.IVa=function(a,b){var c=this.O(new J6(a));a=new MJf;var d=new E6;d.Vj("Remove");L(d,3,"remove");if(null!=c){var e=c.getExtension(),f=c.isEnabled();c=new E6;L(c,1,!0);var h=new E6;h.Vj("Use in this document");L(h,3,"useInDoc");h.dc(!!Ii(e,4)||!!Ii(e,12));h.Ma(f);var k=new E6;k.Vj("Help");L(k,3,"help");h=[h,k];Ii(e,9)&&(h.push(c),Ii(e,8)&&(k=new E6,k.Ma(f),k.Vj("Settings"),L(k,3,"settings"),h.push(k)),f=new E6,f.Vj("Report an issue"),L(f,3,"reportIssue"),h.push(f),Ii(e,10)||h.push(c,d));Vi(a,1,h)}else Vi(a,
1,[d]);b(a)};r.HVa=function(a,b){var c=new J6(a),d=kLf(c);switch(b){case "remove":cKf(this,a,function(){(Jt(),kVa).Fb(new NKf(c),d)});break;case "settings":(Jt(),jVa).Fb(c,d);F(this.F);break;case "useInDoc":(Jt(),lVa).Fb(c,d);break;case "reportIssue":(Jt(),iVa).Fb(c,d);break;case "help":if(a=this.O(c))a=a.getExtension(),(Jt(),bt).Fb(I6(a),d)}};r.JVa=function(){this.V&&this.Hqa();(Jt(),hVa).Fb()};
r.pPa=function(a,b){this.H.H?(tLf(this.H),b(null)):(uLf(this.H,new J6(a),v(this.Leb,this,b)),a=this.F.t6(),this.F.Mi=!1,this.F.setVisible(!1),this.F.Mi=a)};r.$Oa=function(a,b){var c=this;B(A(),"docs-emib")?vLf(this.H,new J6(a),function(d){null==d?(new M6("This add-on is not ready to be installed. Check back in 2-3 days."),b(!1)):wLf(c,b)}):wLf(this,b)};function wLf(a,b){null===a.L||null===a.J?b(!1):a.L?b(!0):a.H.f7(a.J,function(c){b(!(null===c||ra(c)))},a.R||void 0)}
r.ova=function(a,b){F(this.F);b&&null!==this.J&&(a=new J6(a),(Jt(),gVa).Fb(new MKf(a,this.J),kLf(a)))};r.Vqa=function(){this.F.setVisible(!1)};r.Hqa=function(){this.D.call("filterOptions",{showFilterOptions:!1});bKf.prototype.Hqa.call(this)};r.Leb=function(a,b,c,d){this.J=b||null;this.R=d||null;null!=b?this.H.f7(b,v(this.QGb,this,a),d||void 0):(new M6("Unable to install add-on"),a(null))};r.QGb=function(a,b){null===b?a(null):(this.L=!ra(b),a(this.L?null:b))};function xLf(a,b,c,d,e,f){D.call(this);this.O=yLf(a);this.R=b;this.C=null;this.V=c;this.ea=d;this.J=e;this.L=f;this.H=new mLf(a,d,f);this.D=null;this.F=B(A(),"docs-emgsmw")}t(xLf,D);
function zLf(a,b,c,d){d=void 0===d?!1:d;if(1136>Ut().width){var e=735;var f=Math.min(455,Ut().height-176)}else e=975,f=Math.min(603,Ut().height-176);var h="scrollbars=yes,width=600,height=500,left="+(Math.max(0,Math.floor((document.body.clientWidth-600)/2))+(window.screenLeft||window.screenX))+",top="+(Math.max(0,Math.floor((document.body.clientHeight-500)/2))+(window.screenTop||window.screenY));e=YJf(aKf(XJf($Jf(rLf(a.O).setHeight(f),!!d),"Free"),h)).setWidth(e);ZJf(e,b.map(function(k){return k.C}));
c&&c.C&&L(e.C.C,1,c.C);a.J&&(e.C.country=a.J);a.L&&(e.C.language=a.L);a.C&&!a.C.isDisposed()&&a.C.dispose();a.C=new qLf("Add-ons",e);V(ax(a.C),"webstore-widget");b=new sLf(a.C,a.V,a.ea,d);a.C.qa(b);ALf(a,a.C)}function ALf(a,b){a.R.Gh(b);b.setVisible(!0)}function yLf(a){if(a==(oz(),lz))return"GOOGLE_DOCUMENT";if(a==(oz(),mz))return"GOOGLE_SPREADSHEET";if(a==(oz(),nz))return"GOOGLE_SLIDES";if(a==(oz(),t7a))return"GOOGLE_FORM";throw Error("Unsupported document type for webstore widget  ["+a+"]");};function BLf(a){Gi(this,a,"iar",-1,null,null)}x(BLf,Fi);BLf.Ef="iar";BLf.prototype.Um=function(){return Ii(this,1)};function N6(a,b,c,d){var e=K(a,4)+"-polymorphic-"+(K(a,1)||"");Su.call(this,e);this.D=a;this.R=Sc(b,function(f){return new N6(f,[],!1)},this);this.Ma(this.isEnabled());this.Da=c;this.Ba=ta(d)?d:!0}t(N6,Su);N6.prototype.isInstalled=g("Ba");N6.prototype.Fb=function(){(Jt(),mVa).Fb(this)};N6.prototype.isEnabled=function(){return this.R&&(0<this.R.length?!0:!!Ii(this.D,7))};N6.prototype.getLabel=function(){return this.D.Rg()||K(this.D,10)||""};function CLf(){Sm.call(this,"Ti")}t(CLf,Sm);function DLf(){M.call(this);this.C={};this.C[1]={};this.C[0]={};this.D=new Mu(this);this.qa(this.D);this.D.subscribe((Jt(),mVa),"action",this.F)}t(DLf,M);DLf.prototype.F=function(a){a.Da||0<a.R.length?this.dispatchEvent(new CLf(a)):(a=new DKf(K(a.D,4),K(a.D,3),void 0,K(a.D,9)||void 0,void 0,a.D.wx()||void 0),(Jt(),at).Fb(a))};function ELf(a,b,c){c=c||FLf();Ue(c.location,a);b!=xa&&(a=new yhc(function(){return c?c.closed:!0}),a.mEa=b,a.start(100,-1))}function FLf(){return dw("",{target:"_blank",height:500,width:600,top:(screen.height-500)/2,left:(screen.width-600)/2,scrollbars:!0})};function GLf(a){Gi(this,a,"ger",-1,HLf,null)}x(GLf,Fi);var HLf=[1];GLf.Ef="ger";function ILf(a){Gi(this,a,"ier",-1,null,null)}x(ILf,Fi);ILf.Ef="ier";ILf.prototype.Um=function(){return Ii(this,1)};function JLf(a){Gi(this,a,0,-1,null,null)}x(JLf,Fi);JLf.prototype.getName=function(){return K(this,1)};JLf.prototype.Be=function(a){L(this,1,a)};function KLf(a){Gi(this,a,0,-1,LLf,null)}x(KLf,Fi);var LLf=[4];r=KLf.prototype;r.getId=function(){return K(this,1)};r.Ae=function(a){L(this,1,a)};r.getName=function(){return K(this,2)};r.Be=function(a){L(this,2,a)};r.$e=function(){return K(this,3)};r.Wk=function(a){L(this,3,a)};function MLf(a){Gi(this,a,"llr",-1,NLf,null)}x(MLf,Fi);var NLf=[2];MLf.Ef="llr";MLf.prototype.Um=function(){return Ii(this,1)};function OLf(a){Gi(this,a,"lsir",-1,null,null)}x(OLf,Fi);OLf.Ef="lsir";OLf.prototype.Um=function(){return Ii(this,1)};OLf.prototype.getName=function(){return K(this,3)};OLf.prototype.Be=function(a){L(this,3,a)};function PLf(a){Gi(this,a,"oau",-1,null,null)}x(PLf,Fi);PLf.Ef="oau";PLf.prototype.Um=function(){return Ii(this,1)};function QLf(a){Gi(this,a,"rar",-1,null,null)}x(QLf,Fi);QLf.Ef="rar";QLf.prototype.Um=function(){return Ii(this,1)};function RLf(a){Gi(this,a,"uer",-1,null,null)}x(RLf,Fi);RLf.Ef="uer";RLf.prototype.Um=function(){return Ii(this,1)};function SLf(a,b,c,d){D.call(this);this.D=a;this.F=c;this.C=d||new TLf}t(SLf,D);r=SLf.prototype;r.kKa=function(a,b,c,d,e,f,h){a=["ruid",Ja({}),this.C.C,this.D,this.C.F,a,this.C.R,b,this.C.D,c,this.C.H,e,this.C.Da,f,this.C.Ba,h];a=xo(xk(Ao(O6(this,this.C.V),"POST"),2),a).Jq();d&&(zk(a,v(this.KGb,this,d)),yk(a,v(this.job,this,d)));a.Ve()};r.cancel=function(a){a=["ruid",Ja({}),this.C.C,this.D,this.C.J,a];xo(xk(Ao(O6(this,this.C.L),"POST"),2),a).Jq().Ve()};
r.resume=function(a,b,c){a=["ruid",Ja({}),this.C.C,this.D,this.C.J,a,this.C.O,b];a=xo(xk(Ao(O6(this,this.C.Ka),"POST"),2),a).Jq();c&&(zk(a,v(this.MGb,this,c)),yk(a,v(this.zvb,this,c)));a.Ve()};function ULf(a,b){var c=["ruid",Ja({}),a.C.C,a.D];c=xo(xk(O6(a,a.C.ea),2),c);b&&(zk(c,v(a.Sob,a,b)),yk(c,v(a.Rob,a,b)));c.Ve()}r.KGb=function(a,b){b=b.Le();b=new BLf(b[0]);a(b)};r.job=function(a){var b=new BLf;L(b,1,!1);a(b)};r.Sob=function(a,b){b=b.Le();b=new MLf(b[0]);a(b)};
r.Rob=function(a){var b=new MLf;L(b,1,!1);a(b)};r.MGb=function(a,b){b=b.Le();b=new QLf(b[0]);a(b)};r.zvb=function(a){var b=new QLf;L(b,1,!1);a(b)};function VLf(a,b,c){b=["ruid",Ja({}),"storeitemid",b.C];b=xo(xk(O6(a,a.C.xa),2),b);c&&(zk(b,v(a.npb,a,c)),yk(b,v(a.mpb,a,c)));b.Ve()}r.npb=function(a,b){b=b.Le();b=new OLf(b[0]);a(b)};r.mpb=function(a){var b=new OLf;L(b,1,!1);a(b)};function WLf(a,b){var c=["ruid",Ja({}),a.C.C,a.D];yk(zk(xo(xk(O6(a,"/scripts/getitems"),1),c),v(a.zmb,a,b)),xa).Ve()}
function XLf(a,b,c){b=["ruid",Ja({}),a.C.C,a.D,"storeitemid",b.C];b=xo(Ao(O6(a,"/scripts/installitem"),"POST"),b).Jq();c&&(zk(b,v(function(d,e){e=e.Le();e=new ILf(e[0]);d(e)},a,c)),a=new ILf,L(a,1,!1),yk(b,La(c,a)));b.Ve()}r.zmb=function(a,b){b=b.Le();b=new GLf(b[0]);a(b)};
function YLf(a,b,c,d){function e(h,k){k=k.Le();k=new RLf(k[0]);h(k)}var f=["ruid",Ja({}),a.C.C,a.D];null!=b.C&&f.push("storeitemid",b.C);null!=b.D&&f.push("appid",b.D);d&&f.push("versioninfo",d);b=xo(Ao(O6(a,"/scripts/uninstallitem"),"POST"),f).Jq();c&&(zk(b,v(e,a,c)),a=new RLf,L(a,1,!1),yk(b,La(c,a)));b.Ve()}
r.CBa=function(a,b,c,d,e,f){a=["ruid",Ja({}),this.C.C,this.D,this.C.D,e,"extensionid",a,"justInstalled",d];null!=b.C&&a.push("cwsid",b.C);null!=b.D&&a.push("appid",b.D);f&&a.push("versioninfo",f);b=xo(xk(Ao(O6(this,"/scripts/enableitem"),"POST"),1),a).Jq();c&&(zk(b,v(this.Mkb,this,c)),yk(b,v(this.Lkb,this,c)));b.Ve()};r.Mkb=function(a,b){b=b.Le();b=new LKf(b[0]);a(b)};r.Lkb=function(a){var b=new LKf;L(b,1,!1);a(b)};
r.T3a=function(a,b,c,d){a=["ruid",Ja({}),this.C.C,this.D,this.C.D,d,"extensionid",a];null!=b.C&&a.push("cwsid",b.C);null!=b.D&&a.push("appid",b.D);b=xo(xk(Ao(O6(this,"/scripts/disableitem"),"POST"),1),a).Jq();c&&(zk(b,v(this.ojb,this,c)),yk(b,v(this.njb,this,c)));b.Ve()};r.ojb=function(a,b){b=b.Le();b=new KKf(b[0]);a(b)};r.njb=function(a){var b=new KKf;L(b,1,!1);a(b)};
function ZLf(a,b,c,d){b=["ruid",Ja({}),a.C.F,b,a.C.C,a.D];d&&(dd(b,a.C.H),dd(b,d));d=xo(xk(O6(a,a.C.Ha),2),b).Jq();c&&(zk(d,v(a.LGb,a,c)),yk(d,v(a.Arb,a,c)));d.Ve()}r.LGb=function(a,b){b=b.Le();b=new PLf(b[0]);a(b)};r.Arb=function(a){var b=new PLf;L(b,1,!1);a(b)};function O6(a,b){return zo(a.F.cf(b)).setTimeout(4E4)}
function TLf(a,b,c,d,e,f,h,k,l,m,p,q,u,w,y,E,O,S){D.call(this);this.C=a||"id";this.F=c||"lib";this.R=d||"func";this.D=e||"ctx";this.J=f||"pid";this.H=E||"eei";this.Da=O||"usit";this.Ba=ra(S)?S:"did";this.O=h||"ca";this.V=k||"/scripts/invoke";this.L=l||"/scripts/cancel";this.ea=m||"/scripts/libraries";this.Ka=p||"/scripts/resume";this.Na=u||"/scripts/uiready";this.xa=w||"/scripts/lookupstoreitem";this.Ha=y||"/scripts/oauthurl"}t(TLf,D);function $Lf(a,b,c,d,e,f,h,k,l,m,p,q){D.call(this);var u=this;this.Ha=m?V0a(m):void 0;this.Da=m?W0a(m):void 0;this.Ba=a;this.C=d;this.Ka=e;this.xa=b;this.O=f;this.F=h;this.L=k;this.D=[];this.H=l;this.J=new IK("mae-show_addons_menu_promo");Bx(c,this.J,"mae-show_addons_menu_promo");this.ea=p||null;this.V=q||null;this.R=new xLf(this.Ba,this.xa,this,function(w){if(w=u.getExtension(w)){var y=2==u.H?!1:1==u.H?!(!Ii(w,10)||!Ii(w,9)):!0;w=new OKf(w,y)}else w=void 0;return w},this.Da,this.Ha);this.qa(this.R);
(Jt(),gVa).Ob(br,this.dlb,this);gVa.Ma(!0);hVa.Ob(br,this.elb,this);hVa.Ma(!0);iVa.Ob(br,this.flb,this);iVa.Ma(!0);jVa.Ob(br,this.glb,this);jVa.Ma(!0);kVa.Ob(br,this.hlb,this);kVa.Ma(!0);lVa.Ob(br,this.ilb,this);lVa.Ma(!0)}t($Lf,D);r=$Lf.prototype;r.elb=function(){aMf(this)};r.dlb=function(a){a=a.data;bMf(this,a.C,a.D,a.getVersionInfo())};r.flb=function(a){a=a.data;var b=this.getExtension(a);this.xRa(a,I6(b),b.getName(),K(b,6)||void 0,K(b,11)||void 0)};
r.glb=function(a){a=this.getExtension(a.data);cMf(this,I6(a))};r.hlb=function(a){a=a.data;var b=a.C,c=this.getExtension(b);c=c&&I6(c);dMf(this,c,b,xa,a.getVersionInfo())};r.ilb=function(a){a=a.data;var b=this.getExtension(a);Ii(b,4)||Ii(b,12)?eMf(this,I6(b),a,function(c){c&&(L(b,4,!1),L(b,12,!1))}):fMf(this,I6(b),a,function(c){c&&L(b,4,!0)})};
function gMf(a,b,c,d,e,f,h){a.C.pE();if(b){var k=v(function(){var l=hMf(this.C);l&&iMf(l,b);XLf(this.F,d,v(function(m){m.Um()?bMf(this,b,d):(jMf(this.C.C,"Server error. Unable to load third-party application"),kMf(this))},this))},a);lMf(a,b,c,k,e,f,h)}else new M6("Add-on not found. Try again or check back later."),f&&f.close()}
function mMf(a,b,c,d){d=void 0===d?!1:d;if(a.H)tLf(a),kMf(a);else if(nMf(a,b))d=a.getExtension(b).getName(),oMf(a.C.C,Cd(d+" is already installed")),kMf(a);else if(B(A(),"docs-emgsmw")&&!d)a.zP(b);else{var e=c?null:FLf();P6(a.C);uLf(a,b,v(function(f,h,k){gMf(this,f,h,b,c,e,k)},a))}}function lMf(a,b,c,d,e,f,h){function k(){l(b,function(m){m||d()},h)}var l=v(a.f7,a);a.f7(b,function(m){m?e?pMf(m,c+" needs your permission to run.",k,"Let's get started"):ELf(m,k,f):(f&&f.close(),d())},h)}
r.zP=function(a){var b=this.R,c=qMf(this,!1);if(b.F){var d=b.H;a=oLf(d,d.C,c,a,!1);d=pLf(d,a);b.D=d;ALf(b,b.D)}else zLf(b,c,a,!1);rMf(this)};function qMf(a,b){return(void 0===b?0:b)?a.D.map(function(c){return JKf(c)}):a.D.filter(function(c){return Ii(c,10)&&Ii(c,9)}).map(function(c){return JKf(c)})}function cMf(a,b){P6(a.C);var c=v(function(d,e){this.C.pE();d&&d(e)},a,void 0);zWd(a.O.D,v(a.F.kKa,a.F,b,"doSettings",a.L().getState()||void 0,c))}
function fMf(a,b,c,d){P6(a.C);zWd(a.O.D,v(a.F.CBa,a.F,b,c,v(function(e,f){if(f.Um()){var h=a.getExtension(c);h&&L(h,4,!0);aMf(a)}a.C.pE();e&&e(f.Um())},a,d),void 0,a.L().getState()||void 0))}function eMf(a,b,c,d){P6(a.C);zWd(a.O.D,v(a.F.T3a,a.F,b,c,v(function(e,f){if(f.Um()){(Jt(),dVa).Fb(b);var h=a.getExtension(c);h&&(L(h,4,!1),L(h,12,!1));aMf(a)}a.C.pE();e&&e(f.Um())},a,d),a.L().getState()||void 0))}
function dMf(a,b,c,d,e){YLf(a.F,c,v(function(f,h){if(h.Um()&&b){(Jt(),dVa).Fb(b);var k=a.D.findIndex(function(l){return IKf(c,l)});-1!=k&&hd(a.D,k);(k=hMf(a.C))&&Vd(k.V,b)}aMf(a,function(){return f(h.Um())})},a,d),e)}
r.xRa=function(a,b,c,d,e){e?dw(e):(sMf(this.C,v(function(f,h){var k=this.F,l=v(this.C.S_b,this.C,c,h,d),m=v(this.C.R_b,this.C);f=["ruid",Ja({}),k.C.C,k.D,k.C.F,b,"issuedesc",f,"includeUserInfo",h];null!=a.C&&f.push("storeitemid",a.C);null!=a.D&&f.push("appid",a.D);xo(yk(zk(xk(Ao(O6(k,"/scripts/sendissuereport"),"POST"),1),je(l)),je(m)),f).Jq().Ve()},this),c),rMf(this))};
function tLf(a){if(1==a.H)var b="Add-ons aren't allowed in your domain. Talk to your domain administrator for more information.";else if(2==a.H)b="Add-ons aren't allowed while in safe mode.";else return;cWd(a.xa,"Oops",b,void 0,void 0,"Close")}function uLf(a,b,c){VLf(a.F,b,function(d){d.Um()?c(K(d,2),d.getName(),K(d,7)):c(null,null,null)})}function vLf(a,b,c){VLf(a.F,b,function(d){d.Um()?c(K(d,9)):c(null)})}r.f7=function(a,b,c){ZLf(this.F,a,function(d){b(d.Um()?K(d,2):null)},c)};
function bMf(a,b,c,d){function e(){var f=a.getExtension(c),h=hMf(a.C);h=B(A(),"docs-emgsmw")||(h?h.isVisible():!1);if(f&&!h){h=f.getName();var k=ef(K(f,7));f=ef(K(f,6));a.C.dispatchEvent(new tMf(h,k,f))&&(f=new uMf(h,k,f),f.render(),f.setVisible(!0))}}P6(a.C);zWd(a.O.D,v(a.F.CBa,a.F,b,c,function(f){a.C.pE();f.Um()?aMf(a,e):(jMf(a.C.C,"Unable to install add-on"),kMf(a))},!0,a.L().getState()||void 0,d))}
function aMf(a,b){b=void 0===b?xa:b;WLf(a.F,v(function(c,d){d=Ri(d,HKf,1);cd(this.D);d=ka(d);for(var e=d.next();!e.done;e=d.next())this.D.push(e.value);vMf(this);kMf(this);c()},a,b))}
function vMf(a){for(var b=a.Ka,c=jd(a.D),d=0;d<c.length;++d){var e=c[d],f=I6(e);if(!b.C[1][f]){var h=new F6,k=String(Ja(h));L(h,1,k);h.Vj(e.getName());k=I6(e);L(h,4,k);h.Ma(!0);k=e.getName();L(h,10,k);L(h,11,1);k=!(!Ii(e,10)&&!Ii(e,9));e=new N6(h,[],!0,k,Ii(e,19)||!1);e.setVisible(!0);b.C[Ji(e.D,11,0)][f]=e;b.dispatchEvent("Ri")}}if(b=a.C.O)if(ad(a.D)&&!a.J.getValue())a=a.Ba,Rk(b.F.F,"mae-promo-id")||(a=new wMf(a),a.render(),c=new ry(""),c.Ae("mae-promo-id"),c.Qc("script-promo-menu-item"),c.setContent(a.getElement()),
cz(b.O,c,(Jt(),fVa),void 0,void 0,jLf(3)),b.C.Ec(),b.F.Ec(),xMf(b.F,c)),(Jt(),ft).Ma(!1),yMf(b);else{c=jd(a.D);if(b.J){qd(c,b.Ha);f=new Qk;tta(f,b.C.F);b.F.Ec();b.C.Ec();d=[];for(e=0;e<c.length;++e){k=c[e];var l=I6(k),m=!(!Ii(k,10)&&!Ii(k,9));d.push(l);h=f.get(l);var p=zMf(k);if(h)l=h.Sb(),m&&!p&&(m=l.Hc(0),p="addon-menu-install-"+I6(k),m&&m.getId()==p&&(l.$l(0).dispose(),2==l.Mc()&&(l.Hc(0),l.$l(0).dispose())));else{h=new Fz("");h.Ae(l);h.Ma(2==b.R?!1:1==b.R?!!(k&&Ii(k,10)&&Ii(k,9)):!0);var q=new wy;
m||p||AMf(b,q,k);BMf(b,q,l,[],k);h.hf(q)}k=k.getName();m=Yt("span");m.appendChild(Zt(k));h.setContent(m);xMf(b.C,h)}for(e=0;e<b.V.length;++e)xMf(b.C,f.get(b.V[e]));if(b.L)for(f=f.We(),e=0;e<f.length;++e)if(0>d.indexOf(f[e])&&0>b.V.indexOf(f[e])&&(h=b.xa[f[e]])){for(k=0;k<h.length;++k)b.L.gO(h[k]);delete b.xa[f[e]]}(Jt(),ft).Ma(!!c.length);yMf(b)}a.V&&a.V.D(!!a.D.length)}}
function kMf(a){var b=hMf(a.C);if(b){var c=jd(a.D),d=a.H;b.D=[];for(var e=0;e<c.length;e++){var f=c[e];if(Ii(f,12)||Ii(f,4))td(b.D,f,b.a$a),b.J&&!Ii(f,12)&&(b.J=!1)}(Jt(),gt).Ma(0<b.D.length);b.Da=0==d;b.Ba=!0;b.xa=1==b.D.length&&null!=CMf(b);b.Db()&&DMf(b);a.ea&&a.ea.D(0<b.D.length)}}r.getExtension=function(a){return this.D.find(function(b){return IKf(a,b)})};function EMf(a,b){return a.D.find(function(c){return I6(c)===b})}function nMf(a,b){a=a.getExtension(b);return!!a&&!!Ii(a,9)}
function rMf(a){if(!a.J.getValue()&&(a.J.setValue(!0),ad(a.D))){var b=a.C.O;if(b){var c=St("docs-menu-superscript",b.H.getElement());c&&Kv(c,0);b.F.Ec();yMf(b);vMf(a)}}};function FMf(a,b,c,d,e,f,h,k,l,m,p,q,u){this.H=a;this.O=b;this.L=c;this.V=d;this.R=e;this.ea=f;this.Da=h;this.D=k;this.C=l;this.J=m;this.xa=p;this.Ba=q;this.F=u}function GMf(a,b){a=a.L;if(b){a=new hl(a);var c=a.F;c+=xd(c,"/")?"":"/";xd(c,"/start/")&&(c=c.replace("start/",""));c+=Mfa("d/%s/edit",b);pl(a,c);a=a.toString()}return a};function HMf(a){Gi(this,a,0,-1,null,null)}x(HMf,Fi);function IMf(a){Gi(this,a,"paep",-1,null,null)}x(IMf,Fi);IMf.Ef="paep";IMf.prototype.getUrl=function(){return K(this,1)};IMf.prototype.qg=function(){return K(this,2)};function JMf(a){Sm.call(this,"paep");this.D=new IMf(a)}t(JMf,H6);JMf.prototype.C=g("D");function KMf(a){Gi(this,a,0,-1,null,null)}x(KMf,Fi);KMf.prototype.Ej=function(){return K(this,2)};function LMf(a){Gi(this,a,"rfep",-1,null,null)}x(LMf,Fi);LMf.Ef="rfep";LMf.prototype.getFunctionName=function(){return K(this,2)};LMf.prototype.wx=function(){return K(this,5)};function MMf(a){Sm.call(this,"rfep");this.D=new LMf(a)}t(MMf,H6);MMf.prototype.C=g("D");function NMf(a){Gi(this,a,"sfep",-1,null,null)}x(NMf,Fi);NMf.Ef="sfep";NMf.prototype.y7=function(){return K(this,2)};NMf.prototype.qg=function(){return K(this,3)};function OMf(a){Sm.call(this,"sfep");this.D=new NMf(a)}t(OMf,H6);OMf.prototype.C=g("D");function PMf(a){Gi(this,a,"step",-1,null,null)}x(PMf,Fi);PMf.Ef="step";function QMf(a){Sm.call(this,"step");this.D=new PMf(a)}t(QMf,H6);QMf.prototype.C=g("D");function RMf(a){Gi(this,a,"saep",-1,null,null)}x(RMf,Fi);RMf.Ef="saep";r=RMf.prototype;r.getTitle=function(){return K(this,2)};r.setTitle=function(a){L(this,2,a)};r.getWidth=function(){return K(this,4)};r.setWidth=function(a){L(this,4,a)};r.getHeight=function(){return K(this,5)};r.setHeight=function(a){L(this,5,a)};r.jE=function(){return null!=K(this,6)};function SMf(a){Sm.call(this,"saep");this.D=new RMf(a)}t(SMf,H6);SMf.prototype.C=g("D");function TMf(a){Gi(this,a,"snep",-1,null,null)}x(TMf,Fi);TMf.Ef="snep";r=TMf.prototype;r.getType=function(){return Ji(this,1,0)};r.setType=function(a){L(this,1,a)};r.clearType=function(){L(this,1,void 0)};r.hasType=function(){return null!=K(this,1)};r.getText=function(){return K(this,2)};r.hasText=function(){return null!=K(this,2)};r.getTitle=function(){return K(this,3)};r.setTitle=function(a){L(this,3,a)};function UMf(a){Sm.call(this,"snep");this.D=new TMf(a)}t(UMf,H6);UMf.prototype.C=g("D");function VMf(a){Gi(this,a,"spep",-1,WMf,null)}x(VMf,Fi);var WMf=[4];VMf.Ef="spep";VMf.prototype.getTitle=function(){return K(this,2)};VMf.prototype.setTitle=function(a){L(this,2,a)};function XMf(a){Sm.call(this,"spep");this.D=new VMf(a)}t(XMf,H6);XMf.prototype.C=g("D");function YMf(a){Gi(this,a,"stbep",-1,null,null)}x(YMf,Fi);YMf.Ef="stbep";r=YMf.prototype;r.getFunctionName=function(){return K(this,2)};r.Rg=function(){return K(this,3)};r.Vj=function(a){L(this,3,a)};r.getUrl=function(){return K(this,5)};r.wx=function(){return K(this,6)};function ZMf(a){Sm.call(this,"stbep");this.D=new YMf(a)}t(ZMf,H6);ZMf.prototype.C=g("D");function $Mf(a){Gi(this,a,"sttep",-1,null,null)}x($Mf,Fi);$Mf.Ef="sttep";$Mf.prototype.getText=function(){return K(this,1)};$Mf.prototype.hasText=function(){return null!=K(this,1)};$Mf.prototype.Qk=function(){return K(this,2)};$Mf.prototype.Pd=function(a){L(this,2,a)};function aNf(a){Sm.call(this,"sttep");this.D=new $Mf(a)}t(aNf,H6);aNf.prototype.C=g("D");function bNf(){M.call(this);this.C=null}t(bNf,M);bNf.prototype.bind=function(a){this.C=a;this.C.subscribe("13",this.D,this)};
bNf.prototype.D=function(a){Ca(a);switch(a[0]){case "amep":a=new GKf(a);this.dispatchEvent(a);break;case "paep":a=new JMf(a);this.dispatchEvent(a);break;case "rfep":a=new MMf(a);this.dispatchEvent(a);break;case "sfep":a=new OMf(a);this.dispatchEvent(a);break;case "step":a=new QMf(a);this.dispatchEvent(a);break;case "saep":a=new SMf(a);this.dispatchEvent(a);break;case "snep":a=new UMf(a);this.dispatchEvent(a);break;case "spep":a=new XMf(a);this.dispatchEvent(a);break;case "stbep":a=new ZMf(a);this.dispatchEvent(a);
break;case "sttep":a=new aNf(a),this.dispatchEvent(a)}};bNf.prototype.Ia=function(){this.C&&this.C.unsubscribe("13",this.D,this);M.prototype.Ia.call(this)};function cNf(a,b){M.call(this);this.Ja=new hn(this);this.qa(this.Ja);this.C={};this.D=a;this.F=b}t(cNf,M);r=cNf.prototype;r.start=function(){this.Ja.listen(this.F,"sfep",v(this.oMa,this));this.Ja.listen(this.F,"step",v(this.JGb,this))};function dNf(a,b,c,d){d=v(a.IGb,a,b,xa,d||xa);a.D.resume(b,c,d)}r.HGb=function(a,b,c,d,e,f){f.Um()?(a=K(f,2),this.C[a]=new eNf(a,b,d,e),c(a,Ki(f,3,!1))):(b=new NMf,L(b,2,6),e(b))};r.IGb=function(a,b,c,d){d.Um()?b():(c(),b=new NMf,L(b,1,a),L(b,2,6),this.oMa(new OMf(b.Ig())))};
r.JGb=function(a){a=a.C();var b=K(a,1);if(Pd(this.C,b)){var c=Xd(this.C,b);(0,c.GGb)(a);c.dispose();Vd(this.C,b)}};r.oMa=function(a){a=a.C();var b=K(a,1);if(Pd(this.C,b)){var c=Xd(this.C,b);(0,c.j$a)(a);c.dispose();Vd(this.C,b)}a="Google Apps Script: "+a.qg();window.console.log(a)};r.Ia=function(){zf(this.C);M.prototype.Ia.call(this)};function eNf(a,b,c,d){D.call(this);this.C=b;this.GGb=c;this.j$a=d}t(eNf,D);eNf.prototype.getFunctionName=g("C");function fNf(a,b,c){b=c||b;c=a.id;var d=a.tBb,e=a.bea,f=a.x2a,h=a.CQ,k=a.pha;return R('<div class="'+U(a.Vu)+'" aria-labelledby="title'+U(c)+'" tabindex="0" role="region"><div class="'+U(d)+'"><div class="'+U(e)+'" id="title'+U(c)+'"></div><div class="'+U(f)+'" tabindex="0" title="'+U("Close sidebar")+'" aria-label="'+U("Close sidebar")+'" role="button">'+Q(xA({icon:k},b))+'</div></div><div class="'+U(h)+'"></div></div>')}
function gNf(a){a=a.caption;return R('<div class="'+U("docs-script-button-bar-text")+" "+U("docs-titlebar-button")+" "+U("goog-inline-block")+'" tabindex="0">'+Q(a)+"</div>")}function hNf(a){a=a.text;return R('<div class="'+U("docs-script-button-bar-bubble-content")+'">'+Q(a)+"</div>")}
function iNf(a){var b=a.iconName,c=a.title;a=a.description;return R('<div class="'+U("script-promo-menu-item-content")+'"><div class="'+U("script-promo-menu-item-icon")+'" aria-hidden="true"><img src="//ssl.gstatic.com/docs/common/'+U(b)+'.svg"/></div><div class="'+U("script-promo-menu-item-text")+'"><div class="'+U("script-promo-menu-item-title")+'">'+Q(c)+'</div><div class="'+U("script-promo-menu-item-description")+'">'+Q(a)+"</div></div></div>")}
function jNf(a){var b=a.functionName;a=a.Msa;return R('<div class="'+U("func-entry")+'" aria-checked="false" role="radio" tabindex="-1"><div class="'+U("goog-inline-block")+" "+U("func-entry-rb")+'">&nbsp;</div><div class="'+U("goog-inline-block")+" "+U("func-entry-func")+'">'+Q(b)+'</div><div class="'+U("goog-inline-block")+" "+U("func-entry-lib")+'">'+Q(a)+"</div></div>")}
function kNf(a){var b=a.Fm,c=a.description;a=a.$Cb;var d='<div class="'+U("script-help-dialog-content")+'"><div class="'+U("script-help-dialog-content-left")+" "+U("goog-inline-block")+(a?" "+U("script-help-dialog-content-left-gsm-onhold")+" ":"")+'">';a?(c=d,a='<div class="'+U("script-help-dialog-content-section")+" "+U("script-help-dialog-content-section-gsm-onhold")+'" tabindex="0"><div class="'+U("script-help-dialog-content-title")+'">',d=d={mha:"script-help-dialog-content-title-caution-icon"},
d=d.mha,d=R("<div"+(d?' class="'+U(d)+'"':"")+'><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11,15 L13,15 L13,17 L11,17 L11,15 Z M11,7 L13,7 L13,13 L11,13 L11,7 Z M11.99,2 C6.47,2 2,6.48 2,12 C2,17.52 6.47,22 11.99,22 C17.52,22 22,17.52 22,12 C22,6.48 17.52,2 11.99,2 Z M12,20 C7.58,20 4,16.42 4,12 C4,7.58 7.58,4 12,4 C16.42,4 20,7.58 20,12 C20,16.42 16.42,20 12,20 Z" id="path-1"></path></defs><g id="caution" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="alert/error_outline_24px"><mask id="mask-2" fill="white"><use xlink:href="#path-1"></use></mask><g id="ic_error_outline_24px" fill-rule="nonzero"></g><g id="_c/Red/600" mask="url(#mask-2)" fill="#D93025" fill-rule="evenodd"><rect id="swatch" x="0" y="0" width="24" height="24"></rect></g></g></g></svg></div>'),
d=c+(a+Q(d)+"<span>"),d+="Add-on not available in \n G Suite Marketplace</span></div><div>The developer of this add-on has not accepted the terms and conditions of G Suite Marketplace.</div></div>"):(d+='<div class="'+U("script-help-dialog-content-section")+'" tabindex="0"><div class="'+U("script-help-dialog-content-title")+'">',d=d+"Getting started</div><div>"+(Q(c)+"</div></div>"));d+='</div><div id="'+U(b.p4)+'" class="'+U("script-help-dialog-buttons")+" "+U("goog-inline-block")+'"></div></div>';
return R(d)}function lNf(a){var b=a.Fm,c=a.title,d=a.description;a=a.zt;b='<div class="'+U("script-postinstallbubble-content")+'"><div id="'+U(b.TITLE)+'" class="'+U("script-postinstallbubble-title")+'">'+Q(c)+'</div><div id="'+U(b.vy)+'" class="'+U("script-postinstallbubble-description")+'">'+Q(d);a&&(b+=" ",c='<a href="'+U(uw(a))+'" target="_blank">Learn more</a>',b+=c);return R(b+"</div></div>")}
function mNf(a){var b=a.RBa;a='<p class="'+U("script-reportissue-dialog-description-label")+'" tabindex="0">';var c="Describe the issue for the creators of <strong>"+(Q(b)+"</strong>:");a=a+c+('</p><textarea class="'+U("jfk-textinput")+" "+U("script-reportissue-dialog-description")+'"></textarea><p class="'+U("script-reportissue-dialog-disclaimer")+'" tabindex="0">');a=a+'Only this description will be sent: no information from your open document.</p><div class="'+(U("script-reportissue-dialog-nonanonymous")+
'" tabindex="0"><div class="'+U("script-reportissue-dialog-nonanonymous-control")+" "+U("goog-inline-block")+'"><div class="'+U("script-reportissue-dialog-nonanonymous-checkbox")+" "+U("jfk-checkbox")+'"></div></div><div class="'+U("script-reportissue-dialog-nonanonymous-label")+" "+U("goog-inline-block")+'"><div class="'+U("script-reportissue-dialog-nonanonymous-optional-text")+" "+U("goog-inline-block")+'">');a+="(Optional)</div> ";b="Include your name and email address so the creators of <strong>"+
(Q(b)+" </strong>can follow up.");a=a+b+"</div></div>";return R(a)}
function nNf(a,b,c){b=c||b;a=a||{};a=a.$b;c='<div class="'+U("func-actions")+'">';c+=Q(gz({id:"func-action-new",content:rw("New"),style:0},b));c+=Q(gz({id:"func-action-run",content:rw("Run"),style:0,xd:"jfk-button-collapse-right"},b));c+=Q(gz({id:"func-action-edit",content:rw("Edit..."),style:0,xd:"jfk-button-collapse-left"},b));c+=Q(gz({id:"func-action-reload",content:rw(""+Q(xA({icon:a?"docs-icon-img docs-icon-reload-rtl":"docs-icon-img docs-icon-reload"},b))),style:0,width:1,title:"Reload"},b));
c+='</div><div class="'+U("func-header")+'"><div class="'+U("func-header-rb")+" "+U("goog-inline-block")+'"></div><div class="'+U("func-header-func")+" "+U("goog-inline-block")+'">';c=c+'Function</div><div class="'+(U("func-header-lib")+" "+U("goog-inline-block")+'">');c=c+'Script</div></div><div class="'+(U("func-entries")+'" role="radiogroup" tabindex="0"></div>');return R(c)}function oNf(){var a='<div class="'+U("func-loading")+'">';return R(a+"Fetching scripts...</div>")}
function pNf(){var a='<div class="'+U("func-none")+'">';return R(a+"No scripts found</div>")};function qNf(){}t(qNf,Hx);qNf.prototype.Yb=n("func-entry");qNf.prototype.Cg=n(!1);qNf.prototype.Aa=function(a){return W(jNf,{functionName:a.getFunctionName(),Msa:a.XDb},void 0,a.oa())};ya(qNf);function Q6(a,b,c,d,e,f){Kx.call(this,null,d||qNf.getInstance(),e);this.TKa=a;this.C=ra(f)?f:null;this.XDb=b;this.D=c;this.mf(16,!0);this.mf(32,!0);Ox(this,16,!0);Nx(this,16,!1)}t(Q6,Kx);Q6.prototype.Fq=function(a){Kx.prototype.Fq.call(this,a);a&&this.getElement()&&this.getElement().focus()};Q6.prototype.wx=g("C");Q6.prototype.getFunctionName=g("D");Q6.prototype.fc=function(a){Kx.prototype.fc.call(this,a);this.dc(a);this.getElement()&&uu(this.getElement(),a)};function rNf(a,b){qA.call(this,void 0,void 0,a);this.O=b||!1;this.zr=new Ny;this.qa(this.zr);this.Rd=new Cx;this.qa(this.Rd);this.H=new hz("");this.qa(this.H);this.C=new hz("");this.qa(this.C);this.F=new hz("");this.qa(this.F);this.L=new hz("");this.qa(this.L);a=new dx(a);a.set("close","Close",!1,!0);cx(this,!1);gx(this,a);this.setTitle("Script manager")}t(rNf,qA);r=rNf.prototype;
r.reset=function(a){this.zr.clear();this.hd(!0);0===a?(a=W(oNf,{},void 0,this.oa()),a=new Kx(a),a.mf(32,!1),this.Fa(a,!0)):1===a&&(a=W(pNf,{},void 0,this.oa()),a=new Kx(a),a.mf(32,!1),this.Fa(a,!0))};r.focus=function(){if(this.Db()&&0<this.zr.Ei()){var a=this.zr.zf();a&&a.Fq(!0)}else qA.prototype.focus.call(this)};r.hd=function(a){a=qA.prototype.hd.call(this,a);this.zr.clear();sNf(this);return a};
r.Gf=function(a,b,c){qA.prototype.Gf.call(this,a,b,c);a instanceof Q6&&(b=a.isChecked(),this.zr.Pc(a),1==this.zr.Ei()||b)&&(R5a(this.zr,a),a.Fq(!0));sNf(this)};r.Aa=function(){qA.prototype.Aa.call(this);var a=this.Eb();V(a,"script-explorer-contents");ux(a,nNf,{$b:this.O});a=fu(hu(a));this.H.Va(a[0]);this.F.Va(a[1]);this.C.Va(a[2]);this.L.Va(a[3]);sx(this,"run")};
r.Ga=function(){qA.prototype.Ga.call(this);Dx(this.Rd,this.Eb());sNf(this);this.addEventListener("dialogselect",de(!0));Xm(this,"action",this.HGa,void 0,this);Xm(this.Rd,"key",this.hHa,void 0,this);var a=new ex("new",this.H.getContent());Xm(this.H,"action",v(this.dispatchEvent,this,a));a=new ex("run",this.F.getContent());Xm(this.F,"action",v(this.dispatchEvent,this,a));a=new ex("edit",this.C.getContent());Xm(this.C,"action",v(this.dispatchEvent,this,a));a=new ex("reload",this.L.getContent());Xm(this.L,
"action",v(this.dispatchEvent,this,a))};r.Dd=function(){qA.prototype.Dd.call(this);Ex(this.Rd);dn(this,"action",this.HGa,void 0,this);dn(this.Rd,"key",this.hHa,void 0,this);gn(this.H);gn(this.F);gn(this.C);gn(this.L)};r.Eb=function(){var a=qA.prototype.Eb.call(this),b=fu(a);return 0<b.length?b[2]:a};r.HGa=function(a){sNf(this);a.target instanceof Q6&&(R5a(this.zr,a.target),a.target.Fq(!0))};
r.hHa=function(a){var b=this.zr.Ei();if(0<b)switch(a.keyCode){case 38:this.zr.Ye(Ek(this.zr.Vh()-1,b));a.preventDefault();this.focus();break;case 40:this.zr.Ye(Ek(this.zr.Vh()+1,b)),a.preventDefault(),this.focus()}};function sNf(a){var b=!!a.zr.zf();a.F.setVisible(b);a.C.setVisible(b)};function tNf(a,b){this.D=a;this.C=b}function uNf(a){if(a.D.R){var b=a.D.ea;b&&mMf(a.C,new J6(b),!0,!0);aMf(a.C,function(){var c=!a.D.C;(Jt(),ct).Ma(c);a.D.Da&&c&&a.C.zP();if(c=a.D.xa)if(c=a.C.getExtension(new J6(c))||EMf(a.C,c)){var d=a.C,e=d.C.O;e&&(P6(d.C),d=v(d.C.pE,d.C),vNf(e,I6(c),d))}})}};function wNf(){D.call(this);this.F=new Qk}t(wNf,sW);wNf.prototype.C=function(){return this.F.Ld()};function xMf(a,b){a.F.set(b.getId(),b)}wNf.prototype.Ec=function(){this.F.clear()};function wMf(a,b){P.call(this,b);this.C=a}t(wMf,P);
wMf.prototype.Aa=function(){P.prototype.Aa.call(this);var a=this.C==(oz(),lz)?"Do more with Docs":this.C==(oz(),t7a)?"Do more with Forms":this.C==(oz(),mz)?"Do more with Sheets":this.C==(oz(),nz)?"Do more with Slides":"Do more with Docs",b=this.C==(oz(),lz)?"Looking for even more Docs features? Receive a few add-ons.":this.C==(oz(),t7a)?"Looking for even more Forms features? Receive a few add-ons.":this.C==(oz(),mz)?"Looking for even more Sheets features? Get a few add-ons.":this.C==(oz(),nz)?"Looking for even more Slides features? Get a few add-ons.":
"Looking for even more Docs features? Receive a few add-ons.",c=this.C==(oz(),lz)?"addon_docs_promo":this.C==(oz(),t7a)?"addon_forms_promo":this.C==(oz(),mz)?"addon_sheets_promo":this.C==(oz(),nz)?"addon_slides_promo":"addon_docs_promo",d=this.oa();this.Dc(W(iNf,{title:a,description:b,iconName:c},void 0,d))};function xNf(){}t(xNf,ly);xNf.prototype.Aa=function(a){a=ly.prototype.Aa.call(this,a);Cw(a,"menuitem");return a};xNf.prototype.Yb=n("goog-control");xNf.prototype.Wm=function(a){a=ly.prototype.Wm.call(this,a);a.push("menu-button","goog-inline-block");return a};ya(xNf);function yNf(a,b,c,d,e){D.call(this);this.O=b;this.R=c;this.H=a;this.D={};this.Ba={};this.xa={};this.ea=[];this.V=[];this.J=d||null;this.L=e||null;this.C=new wNf;this.F=new wNf;this.Ja=new hn;this.qa(this.Ja);this.Da=[]}t(yNf,D);yNf.prototype.Ia=function(){zf(this.D);D.prototype.Ia.call(this)};yNf.prototype.ws=function(a){return Pd(this.D,a)};
function zNf(a,b,c){c=c?[c]:Nd(a.D);for(var d=0;d<c.length;d++)for(var e=c[d].Sb(),f=0;f<e.Mc();f++){var h=e.Hc(f);if(h instanceof ry&&h.getId()==b||h instanceof Fz&&(h=zNf(a,b,h)))return h}return null}
function ANf(a,b,c,d,e){if(K(b,3)){var f=Ii(b,7)||!1,h=b.Rg(),k=K(b,10),l=new ry("");l.Ae(K(b,1)||String(Ja(l)));var m=[Zt(h)];d&&b.getKey()&&(d+=b.getKey().toUpperCase(),d=A6a(l,(Jt(),at),[d]),a.ea.push(d),m.push(d));l.setContent(m);b=new DKf(K(b,4),K(b,3),void 0,K(b,9)||void 0,void 0,b.wx()||void 0);cz(a.O,l,(Jt(),at),null,de(b),jLf(3,e));l.Ma(f);a.L&&f&&k&&(e=h+(" ("+(k+")")),c.push(a.L.Aq(at,[b],de(e),de(e))[0]));return l}if(!b.Rg())return new vy;if(0<G6(b).length){l=new wy;f=G6(b);for(h=0;h<
f.length;h++)l.Fa(ANf(a,f[h],c,d,e),!0);a=new Fz(b.Rg());a.Ae(K(b,1)||String(Ja(a)));a.hf(l);return a}throw Error("Unsupported menu item type.");}yNf.prototype.Ha=function(a,b){return zd(a.getName(),b.getName())};function BMf(a,b,c,d,e){if(b.E_()){var f=new F6,h=String(Ja(f));L(f,1,h);b.Fa(ANf(a,f,d),!0)}d=new ry("Help");d.Ae(String(Ja(d)));cz(a.O,d,(Jt(),bt),null,de(c),jLf(3,e));d.Ma(!0);b.Fa(d,!0)}
function AMf(a,b,c){var d=new ry("");d.Ae("addon-menu-install-"+I6(c));cz(a.O,d,(Jt(),eVa),wzd,de(I6(c)),jLf(3,c));d.Ma(!0);b.Fa(d,!0)}function zMf(a){return B(A(),"docs-emgsmw")&&Ii(a,19)||!1}function yMf(a){a.J.X$((Jt(),ISa).getId())||uW(a.J,(Jt(),ISa).getId(),[a.F,null]);a.J.X$((Jt(),HSa).getId())||uW(a.J,(Jt(),HSa).getId(),[a.C]);a.J.Sb((Jt(),et).getId(),!0)}
function vNf(a,b,c){var d=c||xa;(c=a.C.F.get(b))?-1===a.Da.indexOf(b)?(b=vn(v(function(e){e.dispatchEvent("load")},a,c),1E4),b=v(function(e,f,h){this.H.Zaa((Jt(),et).getId());e.zg(!0);e.DF();wn(h);f()},a,c,d,b),a.Ja.Kc(c,"load",b)):(a.H.Zaa((Jt(),et).getId()),c.dD(),c.zg(!0),c.DF(),d()):d()};function BNf(a,b,c){b=c||b;c=a.pha;a='<div class="'+U(a.Vu)+'" aria-labelledby="addon-sidebar-title" tabindex="0" role="region"><div class="'+U("addon-sidebar-header")+'"><div class="'+U("addon-sidebar-title")+'" id="addon-sidebar-title">';a+="Document add-ons";c=rw(""+Q(xA({icon:c},b)));a+="</div>"+Q(gz({xd:"addon-sidebar-close docs-material",content:c,style:4,title:"Close sidebar"},b))+'</div><div class="'+U("addon-sidebar-content")+'"><div class="'+U("addon-sidebar-banner")+'"></div><div class="'+
U("addon-sidebar-introduction")+'"></div></div><div class="'+U("addon-sidebar-empty-caption")+'"><div class="'+U("addon-sidebar-empty-title")+'">';a=a+'No document add-ons</div><div class="'+(U("addon-sidebar-empty-description")+'">');return R(a+"This document doesn't include any add-ons</div></div></div>")}
function CNf(a){var b=a.W0a;a=a.V0a;return R('<img class="'+U("addon-sidebar-banner-image")+'" src='+NY(vw(b))+" alt="+NY(a)+' /><div class="'+U("addon-sidebar-banner-image-overlay")+'"></div>')};function DNf(a){var b=a.icon,c=a.title,d=a.category,e=a.summary,f=a.isInstalled,h=a.g2b;a=R;b='<div class="'+U("addon-sidebar-card")+'" aria-label="'+U(c)+'" tabindex="0" role="region"><div class="'+U("addon-sidebar-card-header")+'"><div class="'+U("addon-sidebar-card-icon")+'">'+(b?'<img class="'+U("addon-sidebar-card-icon-image")+'" src='+NY(vw(b))+" alt="+NY(c)+" />":"")+'</div><div class="'+U("addon-sidebar-card-header-content")+'"><div class="'+U("addon-sidebar-card-title")+'"><div class="'+
U("addon-sidebar-card-title-caption")+(h?" "+U("addon-sidebar-card-two-line-title-caption"):"")+'">'+Q(c)+"</div>";f?(c=c={mha:"addon-sidebar-card-check",color:"#455A64"},f=c.mha,c=c.color,f=R("<div"+(f?' class="'+U(f)+'"':"")+'><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 48 48" fill="'+U(null!=c?c:"#000")+'"><path d="M0 0h48v48H0z" fill="none"/><path d="M24 4C12.95 4 4 12.95 4 24c0 11.04 8.95 20 20 20 11.04 0 20-8.96 20-20 0-11.05-8.96-20-20-20zm-4 30L10 24l2.83-2.83L20 28.34l15.17-15.17L38 16 20 34z"/></svg></div>'),
f=Q(f)):f="";return a(b+f+'</div><div class="'+U("addon-sidebar-card-category")+'">'+Q(d)+"</div></div></div>"+(e?'<div class="'+U("addon-sidebar-card-summary")+'">'+Q(e)+"</div>":"")+"</div>")};function ENf(){}t(ENf,$P);ENf.prototype.Yb=n("docs-material-menu-button-flat-primary");ENf.prototype.$p=function(){return W(Yoc,{className:"docs-material-menu-button-flat-primary-dropdown"})};ya(ENf);function FNf(a,b,c,d,e){c=void 0===c?ENf.getInstance():c;By.call(this,a,b,c,d,e)}t(FNf,By);function GNf(){}t(GNf,$P);GNf.prototype.Yb=n("docs-material-menu-button-raised-primary");GNf.prototype.$p=function(){return W(Yoc,{className:"docs-material-menu-button-raised-primary-dropdown"})};ya(GNf);function HNf(a,b,c,d,e){c=void 0===c?GNf.getInstance():c;By.call(this,a,b,c,d,e)}t(HNf,By);function INf(a,b,c,d,e){D.call(this);this.D=a;this.C=b;this.F=c;this.H=d;this.Za=e||Lt()}t(INf,D);
function JNf(a,b){if(!b)return KNf(a);b=G6(b);if(1==b.length&&K(b[0],3)){var c=KNf(a);b=b[0];c.Ma(!!Ii(b,7));b=new DKf(K(b,4),K(b,3),void 0,K(b,9)||void 0);cz(a.D,c,(Jt(),at),{enabled:!0},de(b),a.F);return c}c=new wy(a.Za);for(var d=0;d<b.length;d++)c.Fa(LNf(a,b[d]),!0);b=[Zt("Use")];a=a.C?new HNf(b,c,void 0,a.Za):new FNf(b,c,void 0,a.Za);a.qf("Use");a.Qc("addon-sidebar-card-menu-button");a.Ma(!0);return a}
function LNf(a,b){if(K(b,3)){var c=b.Rg(),d=new ry("");d.Qc(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");d.setContent([Zt(c)]);c=new DKf(K(b,4),K(b,3),void 0,K(b,9)||void 0);cz(a.D,d,(Jt(),at),{enabled:!0},de(c),a.F);d.Ma(!!Ii(b,7));return d}if(!b.Rg())return new vy;if(0<G6(b).length){d=new wy(a.Za);c=G6(b);for(var e=0;e<c.length;e++)d.Fa(LNf(a,c[e]),!0);b=new Fz(b.Rg());b.Qc(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");b.hf(d);return b}throw Error("Unsupported menu item type.");
}function KNf(a){var b=[Zt("Use")];a=a.C?new f_(b,a.Za):new UT(b,a.Za);a.qf("Use");a.Qc("addon-sidebar-card-button");a.Ma(!1);return a};function MNf(a,b,c,d,e){P.call(this,e);this.D=a;this.ea=b;this.R=B(A(),"docs-emgsmw")&&Ii(this.D,19)||!1;this.H=!(!Ii(this.D,10)&&!Ii(this.D,9));this.O=new az(void 0,void 0,!0,NA.getInstance());this.qa(this.O);this.V=jLf(10,this.D);this.J=new Kx(void 0,void 0,e);this.qa(this.J);this.F=new INf(this.O,c,this.V,d,e);this.qa(this.F);if(this.H)a=JNf(this.F);else{a=this.F;b=this.D;a:switch(a.H){case oz(),lz:c="Add to Docs";break a;case oz(),nz:c="Add to Slides";break a;case oz(),mz:c="Add to Sheets";break a;
default:throw Error("Unsupported document type");}d=[Zt(c)];d=a.C?new f_(d,a.Za):new UT(d,a.Za);d.qf(c);d.Qc("addon-sidebar-card-button");d.Ma(!1);cz(a.D,d,(Jt(),eVa),{enabled:!0},de(I6(b)),a.F);a=d}this.C=a;a=this.F;b=this.D;c=new UT([Zt("Help")],a.Za);c.qf("Help");c.Qc("addon-sidebar-card-button");c.Ma(!1);c.Pd("Help");cz(a.D,c,(Jt(),bt),{enabled:!0},de(I6(b)),a.F);this.L=c}t(MNf,P);
MNf.prototype.Aa=function(){P.prototype.Aa.call(this);var a=K(this.D,15)||"";a&&(a=il(new hl(a),"https").toString());var b=this.oa();a={icon:a,title:this.D.getName(),category:this.D.Ok(),isInstalled:this.H,summary:K(this.D,14),g2b:C.Ed};b=W(DNf,a,void 0,b);this.wb(b);this.Dc(b)};MNf.prototype.Dc=function(a){P.prototype.Dc.call(this,a);a=this.Ea("addon-sidebar-card-title-caption");Cw(a,"button");this.Fa(this.J);this.J.Va(a)};
MNf.prototype.Ga=function(){P.prototype.Ga.call(this);cz(this.O,this.J,(Jt(),ft),{},de(JKf(this.D)),this.V);NNf(this);!this.H&&this.R&&(this.Fa(this.L,!0),this.L.Ma(!0))};MNf.prototype.Ia=function(){F(this.C);F(this.L);P.prototype.Ia.call(this)};function ONf(a,b){a.H&&(a.C.getParent()==a&&a.removeChild(a.C,!0),F(a.C),a.C=JNf(a.F,b),a.Db()&&NNf(a))}
function NNf(a){a.Fa(a.C,!0);a.H||(a.C.Ma(a.ea&&!a.R),a.ea?a.R&&a.C.Pd("Add-on not available in G Suite Marketplace"):a.C.Pd("Disabled for your organisation"))};function PNf(a,b,c){MA.call(this,c);this.F={};this.D=[];this.Da=!1;this.J=a;this.Ka=b;this.V={};this.H=new nP(this.oa(),"addon-sidebar-spinner");this.Fa(this.H);this.C=new hz(void 0,this.oa());this.xa=this.Ba=!1}t(PNf,MA);r=PNf.prototype;r.Aa=function(){MA.prototype.Aa.call(this);var a={Vu:"addon-sidebar",pha:Qu("close-white")};a=W(BNf,a,void 0,this.oa());this.wb(a);this.Dc(a)};
r.Dc=function(a){MA.prototype.Dc.call(this,a);this.H.render(this.Eb());a=this.H.La();Gw(a,"Loading");Cw(a,"status");Dw(a,"live","polite")};r.Ga=function(){MA.prototype.Ga.call(this);QNf(this,!1);RNf(this,!1);this.C.Va(this.Ea("addon-sidebar-close"));this.getHandler().Df(this.C.La(),cn,v(this.pMa,this)).listen(this.getElement(),"keyup",this.gyb);this.Ba&&DMf(this)};r.Eb=function(){return this.fb("addon-sidebar-content")};
function iMf(a,b){a.Db()&&b in a.F&&(a=a.F[b],a.C.setContent("Adding\u2026"),a.C.Ma(!1))}function DMf(a){a.H.setVisible(!1);RNf(a,a.J);QNf(a,0==a.D.length);SNf(a,a.xa);TNf(a);Pc(a.D,function(b){var c=I6(b);b=new MNf(b,this.Da,this.xa,this.Ka,this.oa());ONf(b,this.V[c]);this.Fa(b,!0);this.F[c]=b},a)}function TNf(a){Id(a.F,function(b){this.removeChild(b,!0);F(b)},a);Ud(a.F)}function QNf(a,b){if(a.Db()){var c=a.Ea("addon-sidebar-empty-caption");N(c,b)}b&&RNf(a,!1)}
function RNf(a,b){if(a.Db()){var c=a.Ea("addon-sidebar-introduction");b&&!vu(c)&&tu(c,1<a.D.length?"This template is optimised to work with these add-ons":"This template is optimised to work with this add-on");N(c,b)}}function CMf(a){return 0==a.D.length?null:(a=K(a.D[0],16)||K(a.D[0],17))?il(new hl(a),"https").toString():null}
function SNf(a,b){if(a.Db()){Mw(a.getElement(),"addon-sidebar-with-banner",b);var c=a.Ea("addon-sidebar-banner");b?(b=CMf(a))&&ux(c,CNf,{W0a:b,V0a:a.D[0].getName()}):bu(c)}}r.a$a=function(a,b){return zd(a.getName(),b.getName())};r.gyb=function(a){27==a.keyCode&&(this.getElement()==a.target&&this.pMa(),a.stopPropagation())};r.pMa=function(){this.setVisible(!1);RNf(this,!1);this.J=!1;(Jt(),Ys).Fb()};r.Cg=n(!1);function UNf(a,b){NV.call(this,a,b)}t(UNf,NV);UNf.prototype.Xo=function(){return Jt(),gt};UNf.prototype.Nf=function(){return Jt(),nVa};UNf.prototype.gy=function(a){var b=this.C;b.Db()||b.render();NV.prototype.gy.call(this,a)};UNf.prototype.VSa=function(a){a&&this.Nf().isVisible()&&this.gy(!0)};function R6(a,b,c){this.F=a;this.D=b;this.C=c;Object.defineProperties(this,{path:{get:v(this.sbb,this),set:v(this.EZb,this)},invoke:{get:v(this.Yab,this),set:v(this.AZb,this)},arity:{get:v(this.bab,this),set:v(this.hZb,this)}})}r=R6.prototype;r.sbb=g("F");r.EZb=ca("F");r.Yab=g("D");r.AZb=ca("D");r.bab=g("C");r.hZb=ca("C");function VNf(a,b,c,d,e){P.call(this,e);this.L=a;this.H=b;this.F=c;this.C=d}t(VNf,P);
VNf.prototype.Aa=function(){var a=Lc(A(),"docs-tfh"),b=this.L;a&&(b=vwd(b,{allow_parent:a}));a=q3a(this.oa());Se(a,b);a.width="100%";a.height="100%";a.marginWidth="0";a.marginHeight="0";a.scrolling="no";a.allow="accelerometer ambient-light-sensor autoplay camera encrypted-media fullscreen geolocation gyroscope magnetometer microphone midi payment picture-in-picture speaker usb vr".split(" ").map(function(c){return c+" *;"}).join(" ");this.wb(a);va("payload",this.H,a);va("adapter.hostFunctions",this.F,
a);Daa("adapter.getSessionId",v(this.D,this),a);Daa("adapter.getState",v(this.J,this),a)};VNf.prototype.Cg=n(!1);VNf.prototype.D=function(){var a=this.C().D;return null===a?null:String(a)};VNf.prototype.J=function(){return this.C().getState()};function WNf(a,b,c,d,e,f,h,k,l){qA.call(this,void 0,void 0,l);var m=v(this.setVisible,this,!1),p=v(this.H,this),q=v(this.F,this);e&&this.setTitle(e);this.Yf=f||500;this.Ce=h||300;this.C=new VNf(a,b,[new R6("google.script.host.close",m,0),new R6("google.script.host.closeDialog",m,0),new R6("google.script.host.editor.focus",v(d.Ub,d,3),0),new R6("google.script.host.setWidth",p,1),new R6("google.script.host.setHeight",q,1)],c,l);this.Fa(this.C);cx(this,!!k);gx(this,null)}t(WNf,qA);
WNf.prototype.H=function(a){!isFinite(a)||0>a||Gv(this.Eb(),Math.min(a,Math.floor(.8*Ut().width)))};WNf.prototype.F=function(a){!isFinite(a)||0>a||Hv(this.Eb(),Math.min(a,Math.floor(.8*Ut().height)))};WNf.prototype.Aa=function(){qA.prototype.Aa.call(this);V(this.getElement(),"script-app-dialog");var a=this.Eb();V(a,"script-app-contents");Gv(a,Math.min(this.Yf,Math.floor(.8*Ut().width)));Hv(a,Math.min(this.Ce,Math.floor(.8*Ut().height)));this.C.render(a)};WNf.prototype.Cg=n(!1);function XNf(a){MA.call(this,a);this.C=this.F=this.D=this.H=null}t(XNf,MA);r=XNf.prototype;r.dba=function(){this.C&&(this.removeChild(this.C,!0),this.C.dispose(),this.C=null);this.setVisible(!1)};r.focus=function(){this.C.getElement().focus()};r.Eb=g("F");
r.Aa=function(){var a=this.oa(),b={id:this.getId(),Vu:"script-application-sidebar",tBb:"script-application-sidebar-header",bea:"script-application-sidebar-title",x2a:"script-application-sidebar-close",CQ:"script-application-sidebar-content",pha:Qu("close-white")};b=W(fNf,b,void 0,a);this.wb(b);this.H=a.fb("script-application-sidebar-title",b);this.D=a.fb("script-application-sidebar-close",b);this.F=a.fb("script-application-sidebar-content",b)};
r.Ga=function(){MA.prototype.Ga.call(this);this.getHandler().Df(this.D,cn,v(this.dba,this))};r.Cg=n(!1);r.Ia=function(){delete this.H;delete this.D;delete this.F;delete this.C;MA.prototype.Ia.call(this)};function YNf(a,b){NV.call(this,a,b)}t(YNf,NV);YNf.prototype.Xo=function(){return Jt(),oVa};YNf.prototype.Nf=function(){return Jt(),pVa};function ZNf(a,b,c,d,e){qA.call(this,void 0,!0,c);this.H=a;this.F=d||xa;Xw(this,b);this.setVisible(!0);this.Mi=!0;fx(this,!1);gx(this,ix(ix(new dx,M3a,!0),lx,!1,!0));this.setTitle(e||"Authorisation Required");sx(this,M3a.key)}t(ZNf,qA);ZNf.prototype.Ga=function(){qA.prototype.Ga.call(this);this.addEventListener("dialogselect",this.C)};ZNf.prototype.Dd=function(){qA.prototype.Dd.call(this);this.removeEventListener("dialogselect",this.C)};
ZNf.prototype.C=function(a){"cancel"!=a.key?ELf(this.H,this.F,null):this.F();this.setVisible(!1)};function $Nf(a){qA.call(this,void 0,void 0,void 0);this.F=a;this.C=null;this.Mi=!0;this.setTitle("Message details");gx(this,N3a())}t($Nf,qA);$Nf.prototype.Aa=function(){qA.prototype.Aa.call(this);var a=this.Eb();V(a,"script-error-dialog-content");this.C=Zt(this.F);a.appendChild(this.C)};$Nf.prototype.Ia=function(){qA.prototype.Ia.call(this);this.C&&du(this.C)};function aOf(a){D.call(this);this.C=a}x(aOf,D);function jMf(a,b){b=sz(b,"warning",!0);a.C.postMessage(b);b.getId()}function bOf(a,b){var c=Cd("Running script ");c=Wt("SPAN",null,c);b=b?tz(c,"Cancel",b,"info",!0):sz(c,"info",!0);a.C.postMessage(b);return b.getId()}function oMf(a,b){a.C.postMessage(sz(b,"info",!1,2500))}
function cOf(a,b,c){var d=c?c:"Script "+(Ze(b)+" experienced an error");b=Wt("SPAN","script-error-message",d);b.style.maxWidth="600px";c=v(function(){(new $Nf(d)).setVisible(!0)},a);a.C.postMessage(tz([b],"Details",c,"warning",!0))}aOf.prototype.Ia=function(){delete this.C};function dOf(){D.call(this);this.C=null;this.D=new hn;this.qa(this.D)}t(dOf,D);dOf.prototype.Ia=function(){eOf();fOf(this);D.prototype.Ia.call(this)};function fOf(a){a.D.Ec();a.C&&(a.C.dispose(),a.C=null);eOf()}function eOf(){var a=Ot("docs-script-button-bar");a&&bu(a)};var gOf=new iJ(["http","https"]);function hOf(a){a=ef(a);if(Bd(a)||Dd(a,'"'))return null;var b=Vk(1,a);return b?gOf.contains(b.toLowerCase())?a:null:null};function iOf(a,b,c,d,e,f,h){h=void 0===h?!1:h;qA.call(this);this.ea=Bd(ef(b))?"You can find "+(a+" in the Add-ons menu."):b;this.xa=c;this.Ha=d;this.H=hOf(e);this.V=hOf(f);this.L=h;this.R=Wv(this,jOf);this.C=iz("Learn more");this.Fa(this.C);this.F=new hz("Report an issue");this.Fa(this.F);this.O=new hz("View in shop");this.Fa(this.O);this.setTitle(Cd("Help for "+a));a=new dx;ix(a,{key:lx.key,caption:"Close"},!1,!0);gx(this,a);sx(this,"ok")}t(iOf,qA);r=iOf.prototype;
r.Aa=function(){qA.prototype.Aa.call(this);var a=this.Eb();ux(a,kNf,{description:this.ea,Fm:this.R,$Cb:this.L});V(a,"script-help-dialog")};
r.Ga=function(){qA.prototype.Ga.call(this);var a=this.oa().getElement(this.R.p4);this.L?(this.F.render(a),this.getHandler().listen(this.F,"action",this.iIa),this.C.render(a),this.getHandler().listen(this.C,"action",this.qMa)):(this.H&&(this.C.render(a),this.getHandler().listen(this.C,"action",this.qMa)),this.F.render(a),this.getHandler().listen(this.F,"action",this.iIa),this.O.render(a),this.getHandler().listen(this.O,"action",this.vAb))};
r.qMa=function(){this.L?dw("https://support.google.com/docs?p=GSM_migration"):this.H&&dw(this.H)};r.iIa=function(){this.V?dw(this.V):(this.xa(),this.dispose())};r.vAb=function(){this.Ha();this.dispose()};var jOf={p4:"script-help-dialog-buttonbar"};function tMf(a){Sm.call(this,"Qi");this.RBa=a}t(tMf,Sm);function kOf(a,b,c,d){Sm.call(this,"Pi");this.title=d}t(kOf,Sm);function uMf(a,b,c,d){P.call(this,d);this.H=a;this.F=b;this.J=hOf(c);this.D=Wv(this,lOf);this.C=new Vx(d);this.Fa(this.C);Wx(this.C,!1);this.C.DB=!0;this.C.setPosition(1)}t(uMf,P);r=uMf.prototype;
r.Aa=function(){P.prototype.Aa.call(this);var a=this.oa(),b=this.getElement(),c=this.oa().getElement((Jt(),et).getId()),d=Bd(ef(this.F))?"Find your new add-on in this menu.":this.F;this.C.Qc("script-postinstallbubble-dialog");this.C.nj(c);this.C.render(b);b=this.C.getElement();uu(b,!0);Cw(b,"dialog");Dw(b,"labelledby",this.D.TITLE);Dw(b,"describedby",this.D.vy);this.C.setContent(W(lNf,{title:this.H,description:d,Fm:this.D,zt:this.J},void 0,a))};
r.Ga=function(){P.prototype.Ga.call(this);var a=this.oa().getElement((Jt(),et).getId());this.getHandler().listen(a,"mousedown",this.NGb)};r.setVisible=function(a){if(this.Db()){var b=this.getElement();N(b,a);this.C.setVisible(a);this.C.Yc();vn(this.uZb,300,this)}};r.setTitle=ca("H");r.NGb=function(){this.dispose()};r.uZb=function(){try{C.Hb&&this.oa().Wb().body.focus(),this.C.getElement().focus()}catch(a){}};var lOf={TITLE:"script-postinstallbubble-title",vy:"script-postinstallbubble-description"};function mOf(a,b,c,d,e,f){qA.call(this,void 0,void 0,f);this.L=b;this.F=d;this.H=e;this.C=null;this.setTitle(a);cx(this,!0);a=new dx(f);for(b=0;b<c.length;++b)d=c[b],a.set(d,nOf[d]);a.$M="0";gx(this,a)}t(mOf,qA);r=mOf.prototype;r.Aa=function(){qA.prototype.Aa.call(this);var a=this.oa(),b=this.Eb();V(b,"script-prompt-contents");for(var c=a.Aa("DIV"),d=this.L.split("\n"),e=0;e<d.length;++e)0<e&&c.appendChild(a.Aa("BR")),c.appendChild(Hu(a,d[e]));b.appendChild(c);this.F&&(this.C=a.Aa("INPUT"),b.appendChild(this.C))};
r.Cg=n(!1);r.Ga=function(){qA.prototype.Ga.call(this);this.getHandler().listen(this,"dialogselect",v(this.OGb,this))};r.focus=function(){qA.prototype.focus.call(this);this.C&&this.C.focus()};r.OGb=function(a){this.H(Number(a.key),this.F?this.C.value:null)};var nOf={1:"OK",4:"Cancel",2:"Yes",3:"No"};function oOf(a,b){qA.call(this);this.H=a;this.F=b;gx(this,ix(ix(new dx,{key:"send",caption:"Send"},!0),{key:"cancel",caption:"Cancel"},!1,!0));this.setTitle("Report an issue");this.C=new lT;this.Fa(this.C)}t(oOf,qA);r=oOf.prototype;r.Aa=function(){qA.prototype.Aa.call(this);sx(this,"send");var a=this.oa(),b=this.Eb();V(b,"script-reportissue-dialog-content");ux(b,mNf,{RBa:this.F});a.appendChild($w(this),a.Aa("SPAN",{"class":"script-errormsg"}))};
r.Ga=function(){qA.prototype.Ga.call(this);this.C.Va(this.Ea("script-reportissue-dialog-nonanonymous-checkbox"));var a=this.getHandler();a.listen(this.Ea("script-reportissue-dialog-description"),"input",this.WXb);a.listen(this,"dialogselect",this.PGb)};r.$e=function(){return pOf(this).value};function pOf(a){return a.Ea("script-reportissue-dialog-description")}r.WXb=function(){var a=this.oa();Kw(pOf(this),"script-errorfield");a.pe(this.Ea("script-errormsg"),"")};
r.PGb=function(a){if("send"!=a.key)return!0;a=this.oa();if(Bd(this.$e()))return V(pOf(this),"script-errorfield"),a.pe(this.Ea("script-errormsg"),"Enter a description."),!1;this.H(this.$e(),this.C.isChecked());return!0};function qOf(a,b){TY.call(this,b);this.C=a;this.ea=this.C.C.ppu;this.Na=this.C.C.lpu;this.L=[]}var rOf,sOf;x(qOf,TY);r=qOf.prototype;r.nVb=5;r.ZJ=4;r.tla=0;r.fW=!1;r.I8=!1;r.hRa=null;function tOf(a){return"googlexpc_"+a.C.name+"_msg"}function uOf(a){return"googlexpc_"+a.C.name+"_ack"}function vOf(a){try{if(!a.isDisposed()&&$Zd(a.C))return a.C.Pu.frames||{}}catch(b){}return{}}function wOf(a,b){return vOf(a)[b]}
r.connect=function(){if(!this.isDisposed()&&$Zd(this.C)){if(!this.I8){var a=tOf(this);this.F=xOf(this,a);this.V=UY(this).frames[a];a=uOf(this);this.D=xOf(this,a);this.O=UY(this).frames[a];this.I8=!0}if(yOf(this,tOf(this))&&yOf(this,uOf(this)))this.Da=new zOf(this,wOf(this,tOf(this)),v(this.AVb,this)),this.xa=new zOf(this,wOf(this,uOf(this)),v(this.zVb,this)),this.Qya();else{if(1==VY(this.C))this.hRa||0<this.nVb--||(GZd(this.C,BZd(10)),AOf(this),this.I8=!1,this.hRa=xOf(this,"googlexpc_reconnect_"+
this.C.name));else if(0==VY(this.C)){a=vOf(this);for(var b=a.length,c=0;c<b;c++){try{if(a[c]&&a[c].name)var d=a[c].name}catch(f){}if(d){var e=d.split("_");if(3==e.length&&"googlexpc"==e[0]&&"reconnect"==e[1]){this.C.name=e[2];AOf(this);this.I8=!1;break}}}}UY(this).setTimeout(v(this.connect,this),100)}}};
function xOf(a,b){var c=Yt("IFRAME"),d=c.style;d.position="absolute";d.top="-10px";d.left="10px";d.width="1px";d.height="1px";c.id=c.name=b;c.src=a.ea+"#INITIAL";UY(a).document.body.appendChild(c);return c}function AOf(a){a.F&&(a.F.parentNode.removeChild(a.F),a.F=null,a.V=null);a.D&&(a.D.parentNode.removeChild(a.D),a.D=null,a.O=null)}function yOf(a,b){try{var c=wOf(a,b);if(!c||0!=c.location.href.indexOf(a.Na))return!1}catch(d){return!1}return!0}
r.Qya=function(){var a=vOf(this);a[uOf(this)]&&a[tOf(this)]?(this.Ha=new BOf(this.ea,this.V),this.J=new BOf(this.ea,this.O),UY(this).setTimeout(v(function(){this.Ha.send("SETUP");this.fW=!0},this),100)):(this.Ba||(this.Ba=v(this.Qya,this)),UY(this).setTimeout(this.Ba,100))};function COf(a){if(a.Ka&&a.Pa&&(WY(a.C),a.H)){for(var b=0,c;b<a.H.length;b++)c=a.H[b],a.C.pA(c.uV,c.Zm);delete a.H}}
r.AVb=function(a){if("SETUP"==a)this.J&&(this.J.send("SETUP_ACK"),this.Ka=!0,COf(this));else if(this.C.$q()||this.Ka){var b=a.indexOf("|"),c=a.substring(0,b);a=a.substring(b+1);b=c.indexOf(",");if(-1==b)this.J.send("ACK:"+c),DOf(this,a);else{var d=c.substring(0,b);this.J.send("ACK:"+d);c=c.substring(b+1).split("/");b=parseInt(c[0],10);c=parseInt(c[1],10);1==b&&(this.R=[]);this.R.push(a);b==c&&(DOf(this,this.R.join("")),delete this.R)}}};
r.zVb=function(a){"SETUP_ACK"==a?(this.fW=!1,this.Pa=!0,COf(this)):this.C.$q()&&this.fW&&parseInt(a.split(":")[1],10)==this.tla&&(this.fW=!1,EOf(this))};function EOf(a){if(!a.fW&&a.L.length){var b=a.L.shift();++a.tla;a.Ha.send(a.tla+b);a.fW=!0}}function DOf(a,b){var c=b.indexOf(":"),d=b.substr(0,c);b=b.substring(c+1);a.C.$q()?a.C.pA(d,b):(a.H||(a.H=[])).push({uV:d,Zm:b})}
r.send=function(a,b){a=a+":"+b;if(!C.Hb||3800>=b.length)this.L.push("|"+a);else{b=b.length;for(var c=Math.ceil(b/3800),d=0,e=1;d<b;)this.L.push(","+e+"/"+c+"|"+a.substr(d,3800)),e++,d+=3800}EOf(this)};r.Ia=function(){qOf.Oa.Ia.call(this);gd(FOf,this.Da);gd(FOf,this.xa);this.Da=this.xa=null;du(this.F);du(this.D);this.V=this.O=this.F=this.D=null};
var FOf=[],GOf=v(function(){var a,b=!1;try{for(var c=0;a=FOf[c];c++)b=b||a.Ica()}catch(d){if(a.H.C.close(),!FOf.length)return}a=Ma();b&&(rOf=a);sOf=window.setTimeout(GOf,1E3>a-rOf?10:100)},qOf);function HOf(){rOf=Ma();sOf&&window.clearTimeout(sOf);sOf=window.setTimeout(GOf,10)}function BOf(a,b){if(!/^https?:\/\//.test(a))throw Error("URL "+a+" is invalid");this.F=a;this.D=b;this.C=0}
BOf.prototype.send=function(a){this.C=++this.C%2;a=this.F+"#"+this.C+encodeURIComponent(a);try{C.Ed?Ue(this.D.location,a):this.D.location.replace(a)}catch(b){}HOf()};function zOf(a,b,c){this.H=a;this.D=b;this.F=c;this.C=this.D.location.href.split("#")[0]+"#INITIAL";FOf.push(this);HOf()}zOf.prototype.Ica=function(){var a=this.D.location.href;if(a!=this.C){this.C=a;if(a=a.split("#")[1])a=a.substr(1),this.F(decodeURIComponent(a));return!0}return!1};function S6(a,b){D.call(this);this.D={};this.F={};this.J=0;this.R=b;this.C=a;a=v(this.V,this);this.C.D=a}t(S6,D);S6.prototype.connect=function(a){this.C.connect(a)};function IOf(a,b){var c={role:0,ph:b,cn:"ide.api.ch"};C.Hb?(c.pu=b,c.tp=qOf):c.tp=1;b=new XY(c);b.Pu=a;return b}S6.prototype.O=function(a,b){Ca(b);var c=JOf(this,b[0]),d=JOf(this,b[1]);b=md(b,2);try{var e=a.apply(this,b);Ha(e)?e(c,d):c.call(this,e)}catch(f){d.call(this,null)}};
S6.prototype.V=function(a,b){if(wd(a,"callback.")&&Pd(this.D,a)){var c=Xd(this.D,a);b=null!=b?JSON.parse(b):null;var d=this.F[a];d&&(Vd(this.D,d),Vd(this.F,a),Vd(this.F,d));Vd(this.D,a);c.call(this,b)}};function JOf(a,b){return v(function(c){c=null!=c?yl(c):null;this.C.send(b,c)},a)}S6.prototype.Ia=function(){D.prototype.Ia.call(this);delete this.R;delete this.D;delete this.F;delete this.J;delete this.C};function KOf(a,b,c,d){S6.call(this,IOf(b,c),d||5E3);this.H=a;a=v(this.L,this);RY(this.C,"method.getContainerInfo",v(this.O,this,a),!0)}t(KOf,S6);KOf.prototype.L=function(){var a=this.H.call(),b={};Ec(b,"sid",a.D);a=a.getState();vc(b,"state",a);return b};KOf.prototype.Ia=function(){var a=this.C;S6.prototype.Ia.call(this);a.dispose();delete this.H};function LOf(a,b,c,d,e){D.call(this);this.H=a;this.L=b;this.R=c;this.F=d||null;this.J=e||null;this.C=this.D=null}x(LOf,D);LOf.prototype.open=function(){if(this.F){if(this.F.closed){this.F=null;return}this.D=this.F;this.F=null;Ue(this.D.location,this.H)}else this.D=dw(this.H,{target:this.L});if(this.J)try{this.C=new KOf(this.J,this.D,this.R),this.C.connect(),vn(v(this.O,this,!0),1E5)}catch(a){this.C=null}};
LOf.prototype.O=function(a){try{!this.C||a&&this.C.C.$q()||(this.C.dispose(),this.C=null)}catch(b){this.C=null}};LOf.prototype.close=function(){this.O();this.D&&!this.D.closed&&(this.D.close(),this.D=null)};LOf.prototype.Ia=function(){LOf.Oa.Ia.call(this);this.C&&this.C.dispose();delete this.F;delete this.D;delete this.C;delete this.H;delete this.L};function MOf(a,b,c,d,e,f,h,k,l){M.call(this);this.R=[];this.Ha=!!k;this.F=a;this.O=b;this.qa(this.O);this.ea=new dOf;this.qa(this.ea);this.C=new aOf(qz.getInstance());this.qa(this.C);this.D=null;this.Ba=new YNf(new XNf,l);this.V=null;e&&(this.V=new UNf(new PNf(f,h),l));this.H=new rNf(void 0,k);this.H.Sd(this);this.qa(this.H);this.F.Gh(this.H);this.xa=c;this.Da=d;this.L=this.J=null}t(MOf,M);function hMf(a){return a.V?a.V.C:null}r=MOf.prototype;r.$b=g("Ha");
function NOf(a,b){if(null==b)a.H.reset(0);else{var c=a.H;c.reset(2);for(var d=0;d<b.length;d++)for(var e=b[d],f=Ri(e,JLf,4),h=0;h<f.length;h++){var k=f[h];k=new Q6(e.getId(),e.getName(),k.getName());c.Fa(k,!0)}0===c.Mc()&&c.reset(1);a.H.isVisible()&&a.H.focus()}}function pMf(a,b,c,d){new ZNf(a,(new bB).format(b),void 0,c,d)}function OOf(a,b){var c=Ot("docs-script-button-bar");c&&(bu(c),Bd(ef(a))||(a=new hz(a),a.Qc("docs-titlebar-button"),a.render(c),Xm(a,"action",b)))}
function sMf(a,b,c){a.L&&!a.L.isDisposed()&&(rA(a.F,a.L),a.L.dispose());a.L=new oOf(b,c);a.L.Mi=!0;a.F.Gh(a.L);a.L.setVisible(!0)}
r.S_b=function(a,b,c){var d=this.F,e=c||null;c="<p>";var f="Thanks! Your feedback was sent to the creators of <strong>"+(Q(a)+"</strong>.");c=c+f+"</p>";e&&(c+="<p>",b?(a="You won't receive an individual reply but if you'd like to learn more, go to <a href=\""+(U(uw(e))+'" target="_blank">'+(Q(a)+" help</a>.")),c+=a):(a="You won't receive an individual reply, but if you'd like to learn more, go to <a href=\""+(U(uw(e))+'" target="_blank">'+(Q(a)+" help</a>.")),c+=a),c+="</p>");c=R(c);cWd(d,"Report an issue",
hw(c),void 0,void 0,"Close")};r.R_b=function(){cWd(this.F,"Report an issue","We're sorry, but we encountered an error sending your issue report. Please try again later.",void 0,void 0,"Close")};function P6(a){a.dispatchEvent("Si")&&(a=a.Da,a.C.isVisible()&&a.C.$f(),a.D.Db()||a.D.render(a.F||void 0),a.D.show())}r.pE=function(){this.dispatchEvent("Oi")&&this.Da.D.$f()};r.MUb=function(a,b,c,d,e){a=new LOf(a,"MacroService"+jf(c),b,e,d);this.R.push(a);a.open()};
r.Ia=function(){M.prototype.Ia.call(this);zf(this.R)};function POf(a,b,c,d,e,f,h,k,l,m,p,q,u,w,y,E,O,S,T){D.call(this);this.H=a;this.O=l;this.Pa=k;this.ea=m;this.L=b;this.V=c;this.J=d;this.F=E;this.Ja=new hn(this);this.qa(this.Ja);this.Ka=p;this.Na=w||he;this.R=new cNf(this.V,this.J);this.qa(this.R);this.Da=O||!1;a=this.ea;c=this.Da;this.C=new MOf(e,h,p,q,QOf(a),c,a,u,y);this.qa(this.C);this.Ha=new DLf;h=0;b.D?b.C&&(h=2):h=1;this.D=new $Lf(this.ea,e,f,this.C,this.Ha,this.H,this.V,this.O,h,this.F,S,T);this.qa(this.D);this.xa={};this.Ba=null}x(POf,D);
r=POf.prototype;
r.start=function(){if(Qm(this.H.H,1,1)){this.Ja.listen(this.J,"amep",v(this.xGb,this));this.Ja.listen(this.J,"stbep",v(this.EGb,this));this.Ja.listen(this.J,"sttep",v(this.FGb,this));this.Ja.listen(this.J,"spep",v(this.DGb,this));this.Ja.listen(this.J,"saep",v(this.BGb,this));this.Ja.listen(this.J,"snep",v(this.CGb,this));this.Ja.listen(this.J,"paep",v(this.zGb,this));this.Ja.listen(this.J,"rfep",v(this.AGb,this));this.Ja.listen(this.C,"dialogselect",v(this.blb,this));this.Ja.listen(WK.getInstance(),"pc",
v(this.yGb,this));this.Pa(v(this.Ykb,this));var a=this.H.D;(Jt(),at).Ob(br,this.Wkb,this);cVa.Ob(br,this.yvb,this);Zs.Ob(br,v(a.Ur,a,v(this.vpb,this)));$s.Ob(br,this.zma,this);ct.Ob(br,v(this.KGa,this));ft.Ob(br,v(this.upb,this));fVa.Ob(br,v(this.KGa,this));dVa.Ob(br,this.mjb,this);bt.Ob(br,this.jlb,this);eVa.Ob(br,this.eob,this);qVa.Ob(br,v(this.HB,this,"0"));rVa.Ob(br,v(this.HB,this,"1"));sVa.Ob(br,v(this.HB,this,"2"));tVa.Ob(br,v(this.HB,this,"3"));uVa.Ob(br,v(this.HB,this,"4"));vVa.Ob(br,v(this.HB,
this,"5"));wVa.Ob(br,v(this.HB,this,"6"));xVa.Ob(br,v(this.HB,this,"7"));yVa.Ob(br,v(this.HB,this,"8"));zVa.Ob(br,v(this.HB,this,"9"));this.R.start();ROf(this.ea,this.Da)&&(gt.Ma(!0),gt.Fb(void 0,jLf(19)));uNf(new tNf(this.L,this.D));a=this.L.J;var b=!this.L.C,c=this.V,d=this.O().getState()||void 0;d=["ruid",Ja({}),c.C.C,c.D,c.C.D,d];b||d.push("addon_safe_mode",!0);a&&d.push("addon_dry_run",a);xo(Ao(O6(c,c.C.Na),"POST").setContent(""),d).Jq().Ve()}};
function SOf(a){NOf(a.C,null);var b=v(function(c){c.Um()?NOf(this.C,Ri(c,KLf,2)):(this.C.C.C.postMessage(sz("Could not load scripts.","warning",!0)),NOf(this.C,[]))},a);ULf(a.V,b)}
function TOf(a,b,c,d,e,f){if(d){P6(a.C);var h=v(function(){var q=EMf(this.D,b);q&&!Ii(q,4)&&(L(q,4,!0),kMf(this.D))},a),k=v(function(){this.C.pE();this.H.Fk.dispatchEvent(new In(!0))},a),l=v(function(q){this.C.pE();8!=q.y7()&&cOf(this.C.C,c,q.qg())},a);rMf(a.D)}else{var m=bOf(a.C.C),p=v(function(q){this.R.D.cancel(q);rz(this.C.C.C,m)},a);h=v(function(q){rz(this.C.C.C,m);m=bOf(this.C.C,La(p,q))},a);k=v(function(q){rz(this.C.C.C,m);if(Ii(q,2)){q=this.C.C;var u=Cd("Cancelled script ");q.C.postMessage(sz(u,
"info",!1,2500))}else q=this.C.C,u=Cd("Finished script "),q.C.postMessage(sz(u,"info",!1,2500));this.H.Fk.dispatchEvent(new In(!0))},a);l=v(function(q){rz(this.C.C.C,m);8!=q.y7()&&cOf(this.C.C,c,q.qg())},a)}a.Ka.Ub(3);zWd(a.H.D,v(a.uYb,a,b,c,h,k,l,d,e,f))}r.uYb=function(a,b,c,d,e,f,h,k){var l=this.O().getState()||void 0,m=this.R;c=v(m.HGb,m,a,b,c||xa,d||xa,e||xa);m.D.kKa(a,b,l,c,f,h,k)};
r.yGb=function(a){var b=jd(this.D.D),c={};b=ka(b);for(var d=b.next();!d.done;d=b.next())d=d.value,c["ADD-ON:"+I6(d)]={name:d.getName(),"cws-id":K(d,1),"gsm-application-id":K(d,18),"app-key":I6(d)};$d(a.kF,c)};r.mjb=function(a){a.data==this.Ba&&(a=this.C,a.dispatchEvent("Ni")&&a.Ba.C.dba())};
r.xGb=function(a){a=a.C().Sb();var b={},c=UOf(this,a);if(1==Ji(a,11,0)){var d=K(a,4);d=EMf(this.D,d)}else d=void 0;var e=d,f=e&&(Ii(e,10)||Ii(e,9))||!1,h=e&&Ii(e,19)||!1;d=this.Ha;var k=c,l=K(a,4),m=1==Ji(a,11,0);f=new N6(a,k,m,f,h);f.setVisible(!0);0==Ji(a,11,0)&&(l=f.getLabel());d.C[Ji(a,11,0)][l]=f;d.dispatchEvent("Ri");(d=hMf(this.C))&&K(a,9)&&(1==K(a,12)||5==K(a,12))&&(l=K(a,4),d.V[l]=a,l&&l in d.F&&ONf(d.F[l],a));c=c.reverse();if(d=this.C.O){for(l=0;l<c.length;l++)if(f=c[l],h=f.getKey())if(b[h])L(f,
5,void 0);else{if(this.xa[h]){k=d;m="Ctrl+Alt+Shift+"+h.toUpperCase();m=Zy((Jt(),at),[m]);for(var p=0;p<k.ea.length;p++){var q=k.ea[p];vu(q)==m&&tu(q,"")}}this.xa[h]=K(f,1);b[h]=!0}if(1==Ji(a,11,0)){b=null!=e?e:null;c=[];e=K(a,4);f=!!K(a,9)&&3!=K(a,12);l=d.C.F.get(e);l||(l=new Fz(""),l.Ae(e),h=K(a,10),l.setContent(Zt(h)),l.Ma(2==d.R?!1:f&&1==d.R?!1:!0),d.F.Ec(),xMf(d.C,l),yMf(d));f||d.V.push(e);f=new wy;!b||Ii(b,10)||Ii(b,9)||zMf(b)||(AMf(d,f,b),h=new F6,k=String(Ja(h)),L(h,1,k),f.Fa(ANf(d,h,c),!0));
h=b&&(Ii(b,10)||Ii(b,9))||!1;if(!b||h||!zMf(b))for(a=G6(a),h=0;h<a.length;++h)f.Fa(ANf(d,a[h],c,void 0,b?b:void 0),!0);b&&BMf(d,f,e,c,b);d.xa[e]=c;l.hf(f);l.dispatchEvent("load");d.Da.push(e)}else{b=a.Rg();if(d.ws(b)){d.ws(b);c=d.D[b];delete d.D[b];d.H.removeChild(c,!0);if(d.L)for(e=d.Ba[b],l=0;l<e.length;++l)d.L.gO(e[l]);delete d.Ba[b];c.dispose()}10<=Md(d.D)||(b=[],G6(a),c=a.Rg(),a=ANf(d,a,b,"Ctrl+Alt+Shift+").Sb(),a=new Dz(c,a,xNf.getInstance(),void 0,!0),e=d.H.Mc()?d.H.Mc()-1:0,d.H.Gf(a,e,!0),
d.D[c]=a,d.Ba[c]=b)}}};r.EGb=function(a){a=a.C();var b=a.Rg();b?OOf(b,v(function(c){var d=ef(c.getUrl());Bd(d)||dw(d);d=ef(c.getFunctionName());Bd(d)||TOf(this,K(c,1),d,K(c,4)||void 0,void 0,c.wx()||void 0)},this,a)):eOf()};
r.FGb=function(a){var b=a.C();a=b.getText();b=b.Qk();var c=this.C.ea,d=Ot("docs-script-button-bar");d&&(fOf(c),Bd(ef(a))||(a=W(gNf,{caption:a}),au(d,a),Bd(ef(b))||(c.C=new Vx,c.C.Qc("docs-script-button-bar-bubble"),c.C.setContent(W(hNf,{text:b})),c.C.nj(a),Wx(c.C,!0),c.C.DB=!1,c.C.setPosition(1,1),c.C.Ir(!1),c.C.render(d),c.D.listen(a,"mouseover",v(c.C.setVisible,c.C,!0)).listen(a,"mouseout",v(c.C.setVisible,c.C,!1)))))};
r.DGb=function(a){this.C.pE();var b=a.C(),c=Ki(b,6,!1);a=c?K(b,3).replace(/\n/g," ").replace(/\\n/g,"\n"):K(b,3);var d=K(b,7),e=this.C,f=b.getTitle(),h=K(b,4),k=Ki(b,5,!1);b=v(this.dub,this,K(b,1),c,d);e.D&&(e.D.setVisible(!1),rA(e.F,e.D));e.D=new mOf(f,a,h,k,b);e.D.Mi=!0;e.F.Gh(e.D);e.D.setVisible(!0)};r.dub=function(a,b,c,d,e){var f=new KMf;L(f,1,d);L(f,3,b);L(f,4,c);null!==e&&L(f,2,e);(Jt(),cVa).Fb([a,yl(f.Ig())])};
r.BGb=function(a){a=a.C();var b=this.L;var c=Qi(a,IJf,9);c=K(c,4)||"";c=Xea(c);var d={};d.mid=b.H;b=vwd(c,d);switch(Ji(a,6,0)){case 1:var e=this.C;c=K(a,3);d=this.O;var f=a.getTitle()||void 0;if(e.dispatchEvent(new kOf(b,c,d,f))){var h=e.xa;e=e.Ba.C;e.Db()||(e.render(),e.resize());e.dba();var k=e.oa();k.pe(e.H,f||"Apps Script application");f=v(h.Ub,h,3);e.C=new VNf(b,c,[new R6("google.script.host.close",v(e.dba,e),0),new R6("google.script.host.editor.focus",f,0)],d,k);yf(e.C,f);e.Fa(e.C,!0);(Jt(),
oVa).Fb()}this.Ba=K(a,7)||null;break;default:c=this.C,d=K(a,3),f=this.O,h=a.getTitle()||void 0,e=a.getWidth()||void 0,k=a.getHeight()||void 0,a=Ki(a,8,!1),c.D&&(c.D.setVisible(!1),rA(c.F,c.D)),c.D=new WNf(b,d,f,c.xa,h,e,k,a),c.D.Mi=!0,c.F.Gh(c.D),c.D.setVisible(!0)}};r.CGb=function(a){a=a.C();var b=a.getType();this.Na(b,a.getText(),a.getTitle()||void 0,K(a,4)||void 0)};
r.zGb=function(a){a=a.C();var b=Qi(a,HMf,3);if(b&&K(b,2)){var c=K(b,2);b=new J6(c,K(b,11));Ii(a,4)?(b=this.D.getExtension(b),null!=b&&Ii(b,10)?(b="The add-on "+(b.getName()+" needs your permission to run in this document."),pMf(a.getUrl(),"",void 0,b)):pMf(a.getUrl(),"A script attached to this document needs your permission to run.",void 0,"Updated add-on")):this.D.zP(b)}else pMf(a.getUrl(),"A script attached to this document needs your permission to run.")};
r.AGb=function(a){a=a.C();TOf(this,K(a,1),a.getFunctionName(),K(a,4)||void 0,void 0,a.wx()||void 0)};r.Wkb=function(a){a=a.data;var b=EMf(this.D,a.C);!b||Ii(b,9)?TOf(this,a.C,a.functionName,a.F||void 0,1,a.D||void 0):this.D.zP(JKf(b))};r.yvb=function(a){P6(this.C);var b=a.data;a=b[0];b=b[1];var c=v(function(){this.C.C.C.postMessage(sz("Error resuming script execution","warning",!0))},this);dNf(this.R,a,b,c)};r.vpb=function(){this.C.H.setVisible(!0);SOf(this)};
r.zma=function(a){var b=a.data;a=b?b.scriptId:void 0;a=new hl(GMf(this.L,a?a:void 0));b&&(a=b.editorUri?new hl(b.editorUri):a,b.filename&&a.Cc("f",b.filename),b.lineNumber&&(a.Cc("l",b.lineNumber),a.Cc("s",b.lineNumber)));b=this.H.F;var c=null;Km(this.H.D)||(c=kwd({target:"MacroService"+jf(b)}));this.H.D.Ur(v(this.C.MUb,this.C,a.toString(),this.L.O,b,this.O,c))};r.KGa=function(){this.D.zP()};
r.upb=function(a){if(a.data)this.D.zP(a.data);else{a=this.D;var b=a.R,c=qMf(a,!0);if(b.F){var d=b.H;c=oLf(d,d.C,c,void 0,!0);d=pLf(d,c);b.D=d;ALf(b,b.D)}else zLf(b,c,void 0,!0);rMf(a)}};
r.jlb=function(a){var b=EMf(this.D,a.data);if(b){a=this.D;var c=JKf(b),d=a.getExtension(c);if(null!==d){b=v(a.xRa,a,c,I6(d),d.getName(),K(d,6)||void 0,K(d,11)||void 0);c=v(a.zP,a,c);var e=B(A(),"docs-emgsmw")&&Ii(d,19)||void 0,f=a.C,h=d.getName(),k=ef(K(d,7)),l=K(d,6)||void 0;d=K(d,11)||void 0;e=void 0===e?!1:e;f.J&&!f.J.isDisposed()&&(rA(f.F,f.J),f.J.dispose());f.J=new iOf(h,k,b,c,l,d,e);f.J.Mi=!0;f.F.Gh(f.J);f.J.setVisible(!0);rMf(a)}}};
r.eob=function(a){a.data&&(a=EMf(this.D,a.data),null!=a&&mMf(this.D,JKf(a),!1))};r.blb=function(a){"edit"==a.key?(a=a.target.zr.zf(),a=GMf(this.L,a?a.TKa:void 0),this.zma(new KPa({editorUri:a}))):"new"==a.key?(a=this.L.V,this.zma(new KPa({editorUri:a}))):"reload"==a.key?SOf(this):"run"==a.key&&(a=a.target.zr.zf(),TOf(this,a.TKa,a.getFunctionName(),void 0,void 0,a.wx()))};r.HB=function(a){(a=this.xa[a])&&(a=zNf(this.C.O,a))&&a.isEnabled()&&a.dispatchEvent("action")};
r.Ykb=function(){for(var a=this.C,b=0;b<a.R.length;b++){var c=a.R[b];c.close();c.dispose()}a.R=[]};function UOf(a,b){var c=[];K(b,3)&&c.push(b);b=G6(b);for(var d=0;d<b.length;d++)c=c.concat(UOf(a,b[d]));return c}r.getView=g("C");function QOf(a){return a==(oz(),lz)||a==(oz(),nz)||a==(oz(),mz)}function ROf(a,b){return b&&(a==(oz(),lz)||a==(oz(),mz))};function VOf(a,b,c,d,e,f,h){D.call(this);var k=this;this.D=a;this.L=b;this.Za=e;this.F=d;this.V=new Im;this.C=f;this.ea=h;this.R=new Mu(this);this.qa(this.R);this.R.Ob(Xnb,Yq,this.J);this.Ja=new hn(this);this.qa(this.Ja);Mm(this.V,this.F.F,function(){return k.J()});this.H=new Bz(this.Za.Wb(),!0);this.qa(this.H);this.O={};this.J()}t(VOf,D);VOf.prototype.J=function(){var a=WOf(this),b=this.L.Sb(Ynb.getId(),!0);b.hd(!0);vW(this.L,b,[new PEd(a)]);V(b.getElement(),"waffle-action-menu")};
function WOf(a){var b=Array.from(a.F.D.values());CJf(b,function(q){return H(q,8)});var c=Array.from(a.F.C.values());sv(a.ea,k9c(0<b.length,0<c.length));uD.setProperty("visible",!0);tD.setProperty("visible",!0);var d={};c={};b=ka(b);for(var e=b.next();!e.done;c={Oea:c.Oea},e=b.next()){e=e.value;var f=e.Nh(),h=e.getFunctionName(),k=H(e,8),l=Wf(e,9)?H(e,9):null,m="recorded-action-"+f+":"+h,p=a.D.Yw(m);p||(p=(new Tu(m)).enabled(!0),p.Ca(29583),p=p.build(),c.Oea=new DKf(f,h,void 0,void 0,void 0,e.wx()||
void 0),p.Ob(br,function(q){return function(){(Jt(),at).Fb(q.Oea)}}(c)),yz(a.H,[p]),a.D.Xx(p),a.C&&a.C.Jh(p));p.setProperty("label",k);XOf(a,l)&&p.setProperty("keys",[l]);null==l&&null!=p.getProperty("keys")&&p.setProperty("keys",null);d[m]=p}Id(a.O,function(q,u){d[u]||(q.setProperty("keys",null),a.D.kV(u),a.C&&a.C.gO(u),F(q))});a.O=d;return Nd(d)}function XOf(a,b){return!Xnb.yd()&&null!=b&&/^Ctrl\+Alt\+Shift\+\d$/i.test(b)&&0==(a.H.D[Zb(b)]||[]).length};function YOf(a,b){this.Msa=a;this.Dda=b};function ZOf(a,b,c){b=c||b;a='<div class="waffle-recording-toast" role="complementary" tabIndex="0" aria-describedby="waffle-recording-toast-content"><div class="waffle-recording-toast-top"><div class="waffle-recording-toast-icon"><div class="waffle-recording-toast-outer-circle"><div class="waffle-recording-toast-inner-circle"></div></div></div><div class="waffle-recording-toast-content"><div class="waffle-recording-toast-new-content"></div><div class="waffle-recording-toast-default-content">Recording new macro...</div></div><div class="waffle-recording-toast-right"><div class="waffle-recording-toast-cancel">Cancel</div><div class="waffle-recording-toast-stop">Save</div><div class="waffle-recording-toast-expand-section"><div class="waffle-recording-toast-expand"><div class="waffle-recording-toast-expand-icon"></div></div></div></div></div><div class="waffle-recording-toast-bottom" role="radiogroup"><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-absolute">'+
Q(SU({label:rw('Use absolute references<div class="waffle-recording-toast-label-description">When applying macro, use exact location as recorded</div>')},b));a=a+'</div></div><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-relative">'+Q(SU({label:rw('Use relative references<div class="waffle-recording-toast-label-description">When applying macro, use active selection</div>')},b));return R(a+"</div></div></div></div>")};function $Of(a){P.call(this,a);this.J=new ny("",new BA,this.oa());this.Fa(this.J);this.F=new ny("",new BA,this.oa());this.Fa(this.F);this.D=new az;this.qa(this.D);this.H=null;this.C=0}t($Of,P);r=$Of.prototype;r.Aa=function(){this.wb(W(ZOf))};
r.Ga=function(){P.prototype.Ga.call(this);this.O=new $Y(this.oa(),void 0,"relative");this.L=new $Y(this.oa(),void 0,"absolute");this.O.Va(this.Ea("waffle-recording-toast-relative"));this.L.Va(this.Ea("waffle-recording-toast-absolute"));var a=Yd(dz);Wd(a,"selected",!0);var b=gy(new fy,6).build();cz(this.D,this.O,wD,a,void 0,b);cz(this.D,this.L,xD,a,void 0,b);cz(this.D,this.J,(Jt(),ht),void 0,void 0,b);cz(this.D,this.F,sD,void 0,void 0,b);this.H=new rO(this.Ea("waffle-recording-toast-expand"),this.Ea("waffle-recording-toast-bottom"),
$nb.isVisible(),void 0,this.oa());this.qa(this.H);this.getHandler().listen(this.H,"toggle",this.Oub);this.J.Va(this.Ea("waffle-recording-toast-stop"));this.F.Va(this.Ea("waffle-recording-toast-cancel"))};r.setVisible=function(a){var b=this.La();N(b,a);Dw(b,"hidden",!a);a&&(a=this.oa().Wb(),a=Vt(a)||window,b=Iv(this.La()),this.La().style.left=Math.max(Math.floor(Ut(a).width/2-b.width/2),0)+"px")};
function aPf(a,b){a.Ea("waffle-recording-toast-default-content").style.opacity=0;var c=a.Ea("waffle-recording-toast-new-content");a.oa().pe(c,b);0!=a.C?bPf(a):(wn(a.C),a.C=vn(function(){return bPf(a)},400))}function bPf(a){var b=a.Ea("waffle-recording-toast-new-content");Kw(b,"waffle-recording-toast-slide-in");wn(a.C);a.C=vn(function(){V(b,"waffle-recording-toast-slide-in");wn(a.C);a.C=vn(function(){return cPf(a)},2200)})}
function cPf(a){var b=a.Ea("waffle-recording-toast-default-content"),c=a.Ea("waffle-recording-toast-new-content");Kw(c,"waffle-recording-toast-slide-in");b.style.opacity=1;wn(a.C);a.C=vn(function(){a.C=0},400)}r.Oub=function(a){$nb.setVisible(a.Uy)};r.Ia=function(){wn(this.C);P.prototype.Ia.call(this)};function dPf(a,b,c,d){D.call(this);var e=this;this.xa=a;this.Da=c;this.F=d;this.J=new qk;this.C=ritz_api.ScriptRecorder.createScriptRecorder(ritz_api.RitzModelApi.getTopLevelModel(),ritz_api.RitzModelApi.getRecordingMessages(),T6(this),wD.yd(),function(f){f="Action "+(e.C.countRecordedRequests()+(": "+f));ePf(e,f)},ritz_api.RitzModelApi.getRitzSettings());ritz_api.RitzModelApi.setScriptRecorder(this.C);this.H=new $Of;this.qa(this.H);this.Ba=new Mu(this);this.qa(this.Ba);this.Ba.Ob(wD,br,this.pAb,
this).Ob(xD,br,this.nAb,this).Ob((Jt(),oQa),br,this.Bjb,this).Ob(at,br,this.Yvb,this).Ob(xjb,br,function(){return ritz_api.ScriptRecorderActions.recordRefreshDbQueries(e.C,T6(e),!1)},this).Ob(wjb,br,function(){return ritz_api.ScriptRecorderActions.recordRefreshDbQueries(e.C,T6(e),!0)},this).Ob(CB,br,this.cib,this).Ob(DB,br,function(f){return ritz_api.ScriptRecorderActions.recordEditDbQuery(e.C,T6(e),e.J.serialize(f.data))},this);this.D=new Im;this.qa(this.D);Mm(this.D,a.Ta,function(){e.C.startRecordingAction(!0,
T6(e))});Mm(this.D,a.Na,function(f){if(f.D){var h=f.C.D();"docs-edit"==h?"ritz-waffle"==f.C.C()&&e.C.finishRecordingAction(T6(e)):"docs-undo"==h?(ePf(e,"Undo previous action"),e.C.undo()):"docs-redo"==h&&(ePf(e,"Redo previous action"),e.C.redo())}});Mm(this.D,b.xa,function(f){f.Xr||ritz_api.ScriptRecorderActions.recordUpdateTitle(e.C,T6(e),f.C)});Mm(this.D,this.F.xb,function(f){return fPf(e,f)});Mm(this.D,this.F.Zb,function(){e.R=T6(e)});Mm(this.D,this.F.Tb,function(f){switch(f.D){case "find-next-occurrence":ritz_api.ScriptRecorderActions.recordFind(e.C,
e.R,T6(e),f.C);break;case "replace-current-occurrence":ritz_api.ScriptRecorderActions.recordReplace(e.C,T6(e),f.C)}e.R=null});Mm(this.D,this.F.Ta.D,function(f){ritz_api.ScriptRecorderActions.recordUpdateProtectionAcls(e.C,T6(e),f.C,f.D,f.F,f.H,f.id)});Mm(this.D,b.Fk,function(){ritz_api.ScriptRecorderActions.recordCalledScript(e.C,e.ea,T6(e),e.V);e.ea=null;e.V=null});Mm(this.D,this.F.hc,function(f){ritz_api.ScriptRecorderActions.recordCreateDbQuery(e.C,e.J.serialize(e.L.D.C),e.J.serialize(f.getSelection().C),
e.J.serialize(e.L.C));e.L=null});this.Ja=new hn(this);this.qa(this.Ja);this.L=this.R=this.V=this.ea=this.O=null;this.Ja.listen(this.F.C,"Z",this.ONb).listen(this.F.C,"ea",this.NNb);this.H.render();this.H.setVisible(!0);gPf(this);setTimeout(function(){return tK("All actions are now being recorded. Please use the Tools menu to cancel or save the recording.")})}t(dPf,D);r=dPf.prototype;r.NNb=function(){this.O=T6(this)};
r.ONb=function(a){!a.cC&&UN(this.F)&&(ra(a.mQ)?(a=a.mQ,ritz_api.ScriptRecorderActions.switchToAdjacentSheet(this.C,this.O,T6(this),a)):(a=this.F.C.C.$d(),aPf(this.H,"Activating sheet "+a),ritz_api.ScriptRecorderActions.switchToExplicitSheet(this.C,this.O,T6(this),a)),this.O=null)};function ePf(a,b){aPf(a.H,b);tK("Macro recorder "+b)}function hPf(a){return a.C.endScript(T6(a))}r.Yvb=function(a){this.V=a.data.functionName;this.ea=T6(this)};
function fPf(a,b){var c=T6(a);a.Ja.Kc(a.F,"vb",function(){var d=T6(a);switch(b.H){case "adjust-next-data-region-edge":ritz_api.ScriptRecorderActions.recordAdjustSelectionToNextDataRegionEdge(a.C,c,d,b.D,b.C);break;case "move-next-data-region-edge":ritz_api.ScriptRecorderActions.recordMoveSelectionToNextDataRegionEdge(a.C,c,d,b.D,b.C);break;case "select-all":ritz_api.ScriptRecorderActions.recordSelectAll(a.C,c,d);break;case "select-rows-columns":ritz_api.ScriptRecorderActions.recordSelectRowsColumns(a.C,
c,d,"c"==b.F)}})}r.Bjb=function(a){a=a.data;ritz_api.ScriptRecorderActions.recordMakeCopy(this.C,T6(this),a.C)};r.cib=function(a){a=a.data;var b=this.xa.D.getSelection();this.L=new iPf(a,b)};r.pAb=function(){var a=!this.C.isRelative();this.C.setRelativity(!0);wD.fc(!0);xD.fc(!1);a&&(aPf(this.H,"Using relative references"),tK("Recording with relative references"))};r.nAb=function(){var a=this.C.isRelative();this.C.setRelativity(!1);wD.fc(!1);xD.fc(!0);a&&(aPf(this.H,"Using absolute references"),tK("Recording with absolute references"))};
function gPf(a){(a=NK(a.Da))&&KQ(a)}function T6(a){var b=a.xa.D.getSelection();return a.J.serialize(b.C)}r.Ia=function(){ritz_api.RitzModelApi.clearScriptRecorder();D.prototype.Ia.call(this)};function iPf(a,b){this.C=a;this.D=b};function jPf(a,b,c,d){CA.call(this,"Macro saved",Lt(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-saved"]);this.Qa=a;this.Ba=b;this.O=c;this.Pa=d}t(jPf,CA);jPf.prototype.Aa=function(){CA.prototype.Aa.call(this);var a=Vv(this,"script-recorder-edit-link-id");this.Lt("EDIT SCRIPT",a)};jPf.prototype.Ga=function(){CA.prototype.Ga.call(this);this.getHandler().Df(Xv(this,"script-recorder-edit-link-id"),cn,v(this.L,this,this.Qa,this.Ba,this.O))};
jPf.prototype.L=function(a,b,c){this.Pa.C(29645);(Jt(),$s).Fb(b?{scriptId:a,filename:b,lineNumber:c}:void 0)};function kPf(a,b,c,d,e,f,h,k,l,m){pv.call(this);var p=this;this.Ba=a;this.ea=b;this.Qa=c;this.Na=d;this.R=e;this.J=f;this.Ka=h;this.xa=k;this.O=m;this.Da=new Mu(this);this.qa(this.Da);this.F=null;this.L=!1;this.D=null;this.Pa=l;this.Da.subscribe(vD,"action",this.QZb).subscribe((Jt(),ht),"action",this.F0b).subscribe(aob,"action",this.yYb).subscribe(sD,"action",this.U1a).subscribe(tD,"action",this.s_b).subscribe(uD,"action",this.y_b);rv(this,lPf(this));iv(this.J,this);a=["not-revisions","sheet-access-edit",
Rz()];var q=new hv(a.concat(["docs-script-recording"]));Pc([sD,ht,aob,Znb,xD,wD],function(u){p.J.D(u,q);p.J.F(u,q)});a=new hv(a.concat(["not-docs-script-recording"]));this.J.D(vD,a);this.J.F(vD,a)}t(kPf,pv);r=kPf.prototype;r.QZb=function(){var a=this;this.F=new dPf(this.Qa,this.Na,this.R,this.Ka);sv(this,lPf(this));this.Ka.D.D.Ur(function(){zo(xk(Ao(a.Ba.cf("/startrecordingscript"),"POST"),1).setTimeout(18E4)).Ve()})};
r.F0b=function(){OK(this.R)&&WP(NK(this.R),!0);this.F.H.setVisible(!1);ritz_api.RitzModelApi.clearScriptRecorder();zJf(this.ea)};
r.yYb=function(a){var b=this,c=a.Msa;a=a.Dda;var d=hPf(this.F).sourceCode();mPf(this,HA(this.O,"Saving new macro",Lt(),!0,0,!1,void 0,!0,["waffle-recording-toast-saving"]),!0);this.L=!0;sv(this,lPf(this));zo(yk(zk(xk(Ao(wk(wk(mo(this.Ba.cf("/saverecordedscript"),["script",d]),"name",c),"shortcut",""!=a?"Ctrl+Alt+Shift+"+a:""),"POST"),1),function(e){var f=NXb(e,"scriptId"),h=NXb(e,"filename");e=Number(LK(e,"lineNumber"));f=new jPf(f,h,e,b.Pa);IA(b.O,f);mPf(b,f);b.L=!1;nPf(b)}),function(){mPf(b,HA(b.O,
"Failed to save macro",Lt(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-save-failed"]));b.L=!1;if(b.F){var e=b.F;ritz_api.RitzModelApi.setScriptRecorder(e.C);e.H.setVisible(!0)}sv(b,lPf(b))}).setTimeout(18E4)).Ve()};function nPf(a){F(a.F);a.F=null;sv(a,lPf(a))}r.U1a=function(){nPf(this);setTimeout(function(){return tK("Script recording cancelled")})};function lPf(a){var b={},c=!!a.F;a=a.L;b["docs-script-recording"]=c&&!a;b["not-docs-script-recording"]=!c&&!a;return b}
r.s_b=function(){AJf(this.ea,this.xa)};r.y_b=function(){BJf(this.ea,this.xa)};function mPf(a,b,c){a.D&&(JA(a.O,a.D),a.D.setVisible(!1),F(a.D));a.D=b;a.D.render();c&&(new s_(!0,Lt())).render(St("docs-ui-toast-content",b.getElement()));a.D.setVisible(!0)}r.Ia=function(){F(this.F);this.F=null;this.D&&(F(this.D),this.D=null);pv.prototype.Ia.call(this)};function oPf(a,b,c,d){1==a&&PVb(Ze(c||""),Ze(b),ra(d)?d:-1,!0)};function pPf(a,b,c,d,e,f,h,k,l,m,p,q,u,w,y,E,O,S){D.call(this);this.L=a;this.R=b;this.ea=c;this.xa=d;this.J=e;this.Na=f;this.Ha=h;this.C=k;this.F=l;this.Da=m;this.H=p;this.O=q;this.Pa=u;this.Ja=new hn(this);this.qa(this.Ja);this.Ka=new qk;this.V=new EJf(this.ea,this.F);this.Ta=new kPf(this.ea,this.J,this.R,this.L,this.C.D,y,this.F,this.V,E,O);this.qa(this.Ta);this.Qa=new VOf(y.H,this.C.Ba.C,l,this.V,w,this.C.Ba.xa,S);this.qa(this.Qa);this.D=null}t(pPf,D);
pPf.prototype.init=function(){var a=this.C.Ba.xa;a.Jh(vD);a.Jh(sD);a.Jh((Jt(),ht));a.Jh(wD);a.Jh(xD);a.Jh(tD);a.Jh(uD);a=this.F.Ya.C;var b=this.F.Ya.D;b&&(b+=a?"_"+a:"");a=A();a=B(a,"docs-tintd")&&B(a,"docs-thtea");this.D=new CKf(this.xa,this.R.D);this.qa(this.D);var c=this.L,d=iFa(this.H),e=jFa(this.H),f=this.J,h=this.Na,k=this.Ha,l=v(this.O.O,this.O),m=v(this.D.D,this.D),p=(oz(),mz),q=this.Da,u=this.Pa,w=this.xa,y=iB(dB.getInstance()),E=this.C.Ba.C;var O=A();O=new FMf(Lc(O,"maestro_container_token"),
Lc(O,"maestro_domain"),Lc(O,"maestro_script_editor_uri"),Lc(O,"maestro_new_project_uri"),B(O,"docs-emae"),Lc(O,"mae-pai"),B(O,"mae-cwssw"),B(O,"mae-aoeba"),B(O,"mae-esme"),Lc(O,"mae-dret"),Lc(O,"mae-ses"),B(O,"docs-tdd"),B(O,"mae-seitd"));d=new SLf(c.F,String(w),d,void 0);w=new bNf;w.bind(e);e=O.C?2:O.D?0:1;var S=new az(void 0,void 0,!0,NA.getInstance());k=k?new yNf(k,S,e,E,void 0):null;c=new POf(c,O,d,w,f,h,k,l,m,p,q,u,y,oPf,cPc,b,a);c.qa(d);c.qa(w);c.start();nVa.Ma(QOf(p));gt.Ma(ROf(p,a||!1));oVa.Ma(!0);
pVa.Ma(!0);$s.Ma(!O.Ba||O.F);at.Ma(!0);dVa.Ma(!0);bt.Ma(!0);eVa.Ma(!0);fVa.Ma(!0);Zs.Ma(!0);cVa.Ma(!0);qVa.Ma(!0);rVa.Ma(!0);sVa.Ma(!0);tVa.Ma(!0);uVa.Ma(!0);vVa.Ma(!0);wVa.Ma(!0);xVa.Ma(!0);yVa.Ma(!0);zVa.Ma(!0);this.Ja.listen(rK,"runMacro",v(this.Ba,this))};
pPf.prototype.Ba=function(a){var b=a.Zm;a=Sc(ritz_api.RitzModelApi.getCustomFunctions(),function(c){return this.Ka.Sc(Ai.va(),c)},this);a=Yc(a,function(c){return c.getFunctionName()==b});null!=a&&a.qq()?(Jt(),at).Fb(new DKf(a.Nh()||"",b,void 0,void 0,void 0,a.wx())):sK("Script function "+(b+" could not be found"))};function qPf(a){var b=a.Eta;a='<div class="waffle-record-script-dialog-name-section"><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-name-input" id="waffle-record-script-name-input-label">Name</label></div><div class="waffle-record-script-name"><input class="waffle-record-script-name-input jfk-textinput" id="waffle-record-script-name-input" maxlength="50" aria-labelledby="waffle-record-script-dialog-description-id waffle-record-script-name-input-label"/></div></div><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-shortcut-input">Shortcut (optional)</label></div><div class="waffle-record-script-shortcut"><label for="waffle-record-script-shortcut-input" id="waffle-record-script-shortcut-input-label">'+
(Q(b)+'</label><input class="waffle-record-script-shortcut-input jfk-textinput" id="waffle-record-script-shortcut-input" maxlength="1" aria-labelledby="waffle-record-script-shorcut-description-id"/><div id="waffle-record-script-shorcut-description-id" style="display:none;">');b="Optional numeric shortcut key, use with "+(Q(b)+" to run macro.");return R(a+b+"</div></div>")};function rPf(a,b){qA.call(this,void 0,void 0,b);this.Rq=!1;fx(this,!1);this.O=new qk;this.F=new Sz;this.Fa(this.F);this.H=new XV(this.oa());this.Fa(this.H);this.L=new Sz("Number");this.Fa(this.L);this.C=new XV(this.oa());this.Fa(this.C);gx(this,ix(ix(new dx,{key:"discard",caption:"Discard"},!1),L3a,!0))}t(rPf,qA);r=rPf.prototype;
r.Aa=function(){qA.prototype.Aa.call(this);B(A(),"docs-egmd")?(V(ax(this),"waffle-record-script-dialog-gm"),sx(this,"save")):V(ax(this),"waffle-record-script-dialog");this.setTitle("Save new macro");this.Eb().appendChild(W(qPf,{Eta:C.Ym.np?"\u2318 + Option + Shift +":"Ctrl + Alt + Shift +"}))};
r.Ga=function(){qA.prototype.Ga.call(this);this.F.Va(this.Ea("waffle-record-script-name-input"));B(A(),"docs-egmd")||V(this.Ea("waffle-record-script-name"),TZ.getInstance().Yb());this.F.setValue("Untitled macro");var a=this.F.La();this.H.setPosition(3,2);this.H.render();this.H.nj(a);$V(this.H,a);ZV(this.H);this.L.Va(this.Ea("waffle-record-script-shortcut-input"));B(A(),"docs-egmd")||V(this.Ea("waffle-record-script-shortcut"),TZ.getInstance().Yb());var b=this.L.La();this.C.setPosition(3,2);this.C.render();
this.C.nj(b);$V(this.C,b);ZV(this.C);this.getHandler().listen(this,"dialogselect",this.PNb).listen(a,["focus","blur","change"],this.arb).listen(b,["focus","blur","change"],this.wxb)};r.focus=function(){qA.prototype.focus.call(this);Vz(this.F)};r.arb=function(){""!=this.F.getValue()&&ZV(this.H)};r.wxb=function(){sPf(this)&&ZV(this.C)};
r.PNb=function(a){var b=this,c=gy(new fy,12).build();if("discard"==a.key)sD.Fb(void 0,c);else if("save"==a.key)if(""!=this.F.getValue()||YV(this.H,"Cannot be empty.",!0),sPf(this)||setTimeout(function(){YV(b.C,"Must be a number from 0 to 9 or blank.",!0)}),tPf(this)&&setTimeout(function(){YV(b.C,"Conflicts with another shortcut.",!0)}),""!=this.F.getValue()&&sPf(this)&&!tPf(this)){a=this.F.getValue();var d=this.L.getValue();aob.Fb(new YOf(a,d),c)}else a.preventDefault()};
function sPf(a){a=a.L.getValue();return""==a||/^\d$/.test(a)}function tPf(a){var b="Ctrl+Alt+Shift+"+a.L.getValue();return ritz_api.RitzModelApi.getCustomFunctions().map(function(c){return a.O.Sc(Ai.va(),c)}).some(function(c){return Wf(c,9)&&H(c,9)==b})};function uPf(){jK.apply(this,arguments)}t(uPf,jK);uPf.prototype.F=function(){return pPf};uPf.prototype.H=function(){return rPf};uPf.prototype.C=function(a,b,c){return new fKf(a,b,c,void 0)};uPf.prototype.D=function(a,b,c){return new vKf(a,b,c,void 0)};pK("ritzmaestro",uPf);
