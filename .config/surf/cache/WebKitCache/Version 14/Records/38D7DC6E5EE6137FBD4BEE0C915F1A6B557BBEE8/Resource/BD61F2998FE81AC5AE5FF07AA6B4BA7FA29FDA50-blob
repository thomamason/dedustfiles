Lq.prototype.b$=ea(82,function(){return Wf(this,3)});xG.prototype.b$=ea(81,function(){return Wf(this,5)});Lq.prototype.B7=ea(80,function(){return H(this,3)});xG.prototype.B7=ea(79,function(){return H(this,5)});Lq.prototype.f$=ea(78,function(){return Wf(this,2)});xG.prototype.f$=ea(77,function(){return Wf(this,4)});Lq.prototype.T7=ea(76,function(){return H(this,2)});xG.prototype.T7=ea(75,function(){return H(this,4)});function Ehf(a,b){Oi(a,11,b)}function Fhf(a,b,c){return"r"==c?a.vZ(b):a.eM(b)}
function Ghf(a,b){return(a=AY(a,b))?a.rect:null}function Hhf(a,b){a.D=b}function Ihf(a){Gi(this,a,0,-1,null,null)}x(Ihf,Fi);function Jhf(a){Gi(this,a,0,-1,null,null)}x(Jhf,Fi);var Khf=/['()]/g;function Lhf(a){return"%"+a.charCodeAt(0).toString(16)}function Mhf(a){a=Xe(String(a));Khf.lastIndex=0;return Khf.test(a)?a.replace(Khf,Lhf):a}function Nhf(a,b){this.D=a;this.C=b}function Ohf(a){return a.Ul()+ef(a.C)}
function Phf(a,b,c,d,e,f,h,k,l){Sm.call(this,a);this.D=b;this.F=c;this.C=d;this.H=e;this.L=f;this.xa=h;this.Da=k;this.O=l||null}t(Phf,Sm);
function Qhf(a,b,c,d,e){qA.call(this);this.Qa=c;this.Xa=d.C;this.xa=d;this.Ib=e;this.Ta=null;this.xb=d.Ha;this.setTitle("Find and replace");cx(this,!1);c=this.Eb();d=Lt(c);V(this.La(),"waffle-find-replace-dialog");this.C=d.Aa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C.value=a;this.Ha=d.Aa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F=new VQ(null);this.qa(this.F);this.hc=b;this.R=new BV(this.Qa,v(this.pLb,this),!1,"",!0);this.qa(this.R);this.ea=null;this.O=new kT(!1,
hT.getInstance(),this.oa());this.qa(this.O);this.V=new kT(!1,hT.getInstance(),this.oa());this.qa(this.V);this.L=new kT(!1,hT.getInstance(),this.oa());this.qa(this.L);this.H=new kT(!1,hT.getInstance(),this.oa());this.qa(this.H);this.Zb=this.Ya=this.eb=this.Cb=!1;this.$a=d.Aa("SPAN","waffle-find-replace-dialog-display-message");$1d(this.$a);this.Tb=new vA(this.C);this.qa(this.Tb);d.Aa("LABEL",{"for":"waffle-find-replace-find-scope-select"},"Search");a=d.Aa("LABEL",{"for":"find-replace-case","class":"waffle-findandreplacedialog-checkbox-label"},
"Match case");b=d.Aa("LABEL",{"for":"find-replace-cell","class":"waffle-findandreplacedialog-checkbox-label"},"Match entire cell contents");e=d.Aa("LABEL",{"class":"waffle-findandreplacedialog-checkbox-label"},"Also search within formulae");var f=d.Aa("LABEL",{"for":"find-replace-regex","class":"waffle-findandreplacedialog-checkbox-label"},"Search using regular expressions "),h=d.Aa("SPAN",null,d.Aa("A",{target:"_blank",href:"https://support.google.com/docs?p=spreadsheets_find_replace",style:"vertical-align: bottom;"},
"Help"));this.getHandler().listen(h,["keydown","keypress"],function(u){13==u.keyCode&&u.stopPropagation()});var k=Vv(this,"findLabel"),l=Vv(this,"replaceLabel"),m=Vv(this,"findScopeLabel"),p=d.Aa("DIV","goog-inline-block"),q=d.Aa("DIV","waffle-find-replace-selection-input goog-inline-block");h=d.Aa("TABLE",null,d.Aa("TBODY",null,d.Aa("TR",null,d.Aa("TD","waffle-find-replace-dialog-label",d.Aa("LABEL",{id:k},"Find")),d.Aa("TD",null,this.C)),d.Aa("TR",null,d.Aa("TD","waffle-find-replace-dialog-label",
d.Aa("LABEL",{id:l},"Replace with")),d.Aa("TD",null,this.Ha)),d.Aa("TR",null,d.Aa("TD",null,d.Aa("LABEL",{id:m},"Search")),d.Aa("TD",null,p,q)),d.Aa("TR",null,d.Aa("TD",null,""),d.Aa("TD",null,d.Aa("DIV","waffle-find-replace-option",a),d.Aa("DIV","waffle-find-replace-option",b),d.Aa("DIV","waffle-find-replace-option",f,h),d.Aa("DIV","waffle-find-replace-option",e))),d.Aa("TR",null,d.Aa("TD",{colspan:"2"},this.$a))));this.F.render(p);V(this.F.getElement(),"waffle-find-replace-find-scope-select");this.R.render(q);
Uv(this.O,a);jT(this.O,a);V(this.O.getElement(),"waffle-findandreplacedialog-checkbox");this.O.getElement().id="find-replace-case";Uv(this.V,b);jT(this.V,b);V(this.V.getElement(),"waffle-findandreplacedialog-checkbox");this.V.getElement().id="find-replace-cell";Uv(this.L,f);jT(this.L,f);this.L.getElement().id="find-replace-regex";V(this.L.getElement(),"waffle-findandreplacedialog-checkbox");jT(this.H,e);Uv(this.H,e);V(this.H.getElement(),"waffle-findandreplacedialog-checkbox");Dw(this.C,"labelledby",
k);Dw(this.Ha,"labelledby",l);Dw(this.F.La(),"labelledby",m);d.appendChild(c,h);c=new dx;c.set("findNext","Find",!0);c.set("replace","Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);gx(this,c);sx(this,"done");this.getHandler().listen(this,"dialogselect",this.qLb).listen(this.Tb,"input",this.Una).listen(this.L,"change",this.fwb).listen(this.F,"change",this.Tlb).listen(this.R,"change",this.rLb).listen(this.H,"change",this.iwb);c=new wA;c.Va(this.C);this.qa(c);c=new wA;c.Va(this.Ha);
this.qa(c);Rhf(this);c=new Sw(this.getElement());this.qa(c);this.getHandler().listen(c,"focusin",this.cNa).listen(this.getElement(),"mousedown",this.cNa)}t(Qhf,qA);
function Rhf(a){var b=NK(a.Qa),c=null,d=null;b&&(c=pCc(b),d=VI(a.Xa,c.C).$d());a.H.dc(a.xb);var e=new ry("All sheets",2),f=new ry("This sheet",1),h=new ry("Specific range",0);a.F.Pc(e);a.F.Pc(f);a.F.Pc(h);f=c?hJ(a.Xa,c.C):null;f=(f=c&&f?MI(f,c.rect.Bc(),c.rect.xc()):null)?f.Mh():1;c&&c.rect.Mh()>f?Py(a.F,h):Py(a.F,e);b&&a.R.setValue(zN(c.rect,d))}function Shf(a){var b=a.F.zf().Ra(),c=PK(a.Qa);return 0==b?xN(a.R.getValue(),a.Xa,!1,!0):1!=b||null===c?null:new lm(c,new Tl(0,0,1,1))}r=Qhf.prototype;
r.cNa=function(a){a.target==this.getElement()?this.focus():this.Ib.Ub(2)};r.rLb=function(){Thf(this)};r.iwb=function(){var a=this.H.isChecked();Uxd(this.xa,a)};r.Tlb=function(){Thf(this)};r.fwb=function(){this.L.isChecked()&&this.O.dc(!0);this.Una()};
r.qLb=function(a){if("findNext"==a.key)a.preventDefault(),this.Cb&&(s5(this,null),Uhf(this,"findnext"));else if("replace"==a.key)a.preventDefault(),this.eb&&(s5(this,null),Uhf(this,"replace"));else if("replaceAll"==a.key&&(a.preventDefault(),this.Zb)){a=v(function(){s5(this,null);Uhf(this,"replaceall")},this);var b=this.F.zf().Ra();1<this.Xa.D.length&&2==b&&!this.Ya?(NVd("Replace on all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.Ya=!0):a()}};
r.Una=function(){var a=0==this.C.value.length,b=this.L.isChecked()&&!ritz_api.RitzModelApi.isValidRegex(this.C.value);a=!a&&!b;hx(this.D,"findNext").disabled=!a;this.Cb=a;Vhf(this,a);this.eb&&!a&&Whf(this,!1);Mw(this.C,"waffle-input-error",b)};r.pLb=function(a,b,c){this.Ta=CV(a);this.hc.sf(this,a,b,c,!1,!0)};
function Thf(a){var b=0==a.F.zf().Ra();a.R.setVisible(b);F(a.ea);a.ea=null;var c=Shf(a),d=NK(a.Qa);b&&d&&c&&(a.ea=lP(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.ea.setVisible(!0),a.qa(a.ea))}function Uhf(a,b){if(!a.isDisposed())if(0==a.F.zf().Ra()&&null==Shf(a))Mw(a.R.D,"waffle-range-selection-error",!0),s5(a,"Invalid range");else{var c=a.F.zf().Ra();a.dispatchEvent(new Phf(b,a.C.value,a.Ha.value,c,a.O.isChecked(),a.V.isChecked(),a.L.isChecked(),a.H.isChecked(),Shf(a)))}}
r.setVisible=function(a){var b=this.xa.Jd();Vhf(this,!b);Whf(this,!b);this.Ha.disabled=b;qA.prototype.setVisible.call(this,a);a&&this.Ta&&(this.Ta.focus(),this.Ta=null)};r.tZb=function(a){this.C.value=a};r.ZRa=function(){this.C.select()};r.focus=function(){this.Db()&&this.isVisible()&&(this.C.focus(),this.Ib.Ub(2),Xz(this.C,this.C.value.length),this.Una())};function Whf(a,b,c){b=b&&!a.xa.Jd()&&0==!a.C.value.length;a.eb=b;a=hx(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}
function Vhf(a,b){b=b&&!a.xa.Jd()&&0==!a.C.value.length;a.Zb=b;hx(a.D,"replaceAll").disabled=!b}function s5(a,b){var c=Lt(a.Eb());a=a.$a;b?(0<fu(a).length&&c.appendChild(a,c.Aa("BR")),c.appendChild(a,c.Aa("B",null,Hu(c,b)))):c.hd(a)}r.Ia=function(){qA.prototype.Ia.call(this);this.Ya=!1;Uxd(this.xa,this.xb)};
function Xhf(a,b,c){b=c||b;var d=a.title;c=a.Ir;var e=a.YYb;a=a.xd;a='<div class="office-editing-feedback '+(a?" "+U(a):"")+'"><div class="office-editing-feedback-title">'+Q(d)+'</div><span class="office-editing-feedback-title-separator">&#8208;</span><a href="'+U(uw(e))+'" target="_blank" rel="noreferrer">';a+="Send feedback</a>";c&&(a+=Q(gz({xd:"office-editing-feedback-close-button",content:rw(""+Q(xA({icon:"docs-icon-img docs-icon-close-thin"},b))),style:4,title:"Close"},b)));return R(a+"</div>")}
function Yhf(a,b,c,d){P.call(this,c);this.J=b;a:switch(a){case "editor-header":case "warning-dialogs":c="Office Native Editing";break a;default:c=""}this.D=c;a:switch(a){case "editor-header":a="office-editing-feedback-editor-header";break a;case "warning-dialogs":a="office-editing-feedback-warning-dialogs";break a;default:a=""}this.H=a;(this.C=b?new hz:null)&&this.Fa(this.C);this.F=d||(B(A(),"docs-idu")?Lc(A(),"docs-sddfu"):Lc(A(),"docs-sdttfu"))}t(Yhf,P);
Yhf.prototype.Aa=function(){var a=W(Xhf,{title:this.D,Ir:this.J,YYb:this.F,xd:this.H},void 0,this.oa());this.wb(a);this.C&&this.C.Va(this.Ea("office-editing-feedback-close-button"))};Yhf.prototype.Ga=function(){var a=this;P.prototype.Ga.call(this);this.C&&this.getHandler().listen(this.C,"action",function(){return N(a.La(),!1)})};function Zhf(a){var b=a.title;return R('<div class="docs-native-editing-warning-title-text docs-material-gm-dialog-title-text" id="'+U(a.id)+'">'+Q(b)+"</div>")}
function t5(a,b,c,d){WT.call(this,void 0,a,d,!0);this.$a=c;this.ea=Pj("warning-header-text");this.H=null;if(b.L){b=B(A(),"docs-idu");c=B(A(),"docs-sdsnfl");d=Lc(A(),"docs-sddfu");var e=Lc(A(),"docs-sdttfu");(this.H=!b&&!c||Bd(d)||Bd(e)?null:new Yhf("warning-dialogs",!1,a,b?d:e))&&this.Fa(this.H)}fx(this,!1);this.Dx(!1);this.Mi=!0}t(t5,WT);r=t5.prototype;r.Bx=n("alertdialog");
r.Aa=function(){WT.prototype.Aa.call(this);ux(Yw(this),Zhf,{title:this.$a,id:this.ea});this.vRa();var a=this.La();this.H&&this.H.render(a);var b=this.w7();this.C.setContent(b);this.C.qf(this.w7());if(b=this.F?this.F.Rg():void 0){if(!this.F)throw Error("Attempted to set cancel button content when the cancel button doesnt exist");this.F.setContent(b);this.F.qf(b)}V(a,this.iMa())};r.Ga=function(){WT.prototype.Ga.call(this);Dw(this.La(),"labelledby",this.ea)};r.Cg=n(!1);r.w7=function(){return this.C.Rg()};
function $hf(a){var b=a.Bh,c=a.Fm,d=R;a=a.eYb;a=R('<div class="docs-unsupportedofficefeatureswarning-content-restorefiletext" id="'+U(c.Owa)+'">'+Q(a)+"</div>");c='<div class="docs-unsupportedofficefeatureswarning-content-features-list" id="'+U(c.dwa)+'">';for(var e=b.length,f=0;f<e;f++)c+=R('<div class="docs-unsupportedofficefeatureswarning-content-feature">'+Q({feature:""+b[f]}.feature)+"</div>");b=R(c+"</div>");return d(a+b)}
function aif(a){a=a.zt;a='<a class="'+U("docs-unsupportedofficefeatureswarning-learn-more")+'" target="_blank" rel="noreferrer" href="'+U(uw(a))+'">';return R(a+"Learn more</a>")}var bif={dwa:"features-list",Owa:"restore-file-text"};function u5(a,b,c,d,e){t5.call(this,d,a,c,e);this.Ta=b;this.L=Kd(bif,function(f){return Pj(f)});this.V=Lc(A(),"docs-deuoflmu")}t(u5,t5);u5.prototype.Ga=function(){t5.prototype.Ga.call(this);Dw(this.La(),"describedby",[this.L.Owa,this.L.dwa])};
u5.prototype.vRa=function(){ux(this.Eb(),$hf,{Bh:this.Ta,Fm:this.L,eYb:this.O()});if(this.V){var a=W(aif,{zt:this.V});$w(this).prepend(a)}};u5.prototype.iMa=n("docs-unsupportedofficefeatureswarning");function cif(a,b,c,d,e,f){for(var h=new iJ,k=ka(b),l=k.next();!l.done;l=k.next())h.add(ZBd(l.value));u5.call(this,a,h.Ld(),c,d);this.R=!1;this.Qa=e;this.Ha=f;this.xa=b}t(cif,u5);cif.prototype.w7=n("Continue editing");cif.prototype.O=n("The original file can be restored from version history");
cif.prototype.Ga=function(){var a=this;u5.prototype.Ga.call(this);this.getHandler().listen(this,"od",function(){a.R=!0;a.Qa.Fb(uad(a.xa));return!0})};cif.prototype.Zl=function(){u5.prototype.Zl.call(this);this.R||this.Ha.Fb(uad(this.xa))};function dif(a,b,c){qA.call(this,void 0,void 0,c);this.Mi=!0;this.setTitle("Alt Text");sx(this,"ok");b=b||"";a='<div class="alt-text-dialog-content"><div class="alt-text-dialog-intro">Alt text is accessed by screen readers for people who might have trouble seeing your content.</div><table cellspacing="0" cellpadding="0" role="presentation"><tr class="alt-text-dialog-title-container"><td><label for="alt-text-dialog-title">Title</label></td><td><input id="alt-text-dialog-title" class="jfk-textinput" type="text" maxlength="5000" value="'+
(U(a||"")+'"></td></tr><tr class="alt-text-dialog-description-container"><td><label for="alt-text-dialog-description">');a=a+'Description</label></td><td><textarea id="alt-text-dialog-description" class="jfk-textinput" maxlength="5000">'+(l2a(b)+"</textarea></td></tr></table></div>");a=R(a);Xw(this,hw(a));this.Ae(Vv(this,"alt-text"))}t(dif,qA);dif.prototype.F=function(){return eif(this,"alt-text-dialog-title")};dif.prototype.C=function(){return eif(this,"alt-text-dialog-description")};
function eif(a,b){return(a=a.oa().getElement(b))&&null!=a.value?a.value:null};function fif(a){var b=a.H2b;return R('<div class="docs-binaryupsavewarning-content-text" id="'+U(a.id)+'">'+Q(b)+"</div>")};function gif(a,b,c,d,e,f){t5.call(this,b,a,e);this.O=!1;this.V=c;this.R=d;this.xa=f;this.L=Pj("warning-explanation")}t(gif,t5);r=gif.prototype;r.iMa=n("docs-binaryupsavewarning");r.vRa=function(){ux(this.Eb(),fif,{id:this.L,H2b:this.xa})};r.Ga=function(){var a=this;t5.prototype.Ga.call(this);this.getHandler().listen(this,"od",function(){a.O=!0;a.V.Fb();return!0});Dw(this.La(),"describedby",this.L)};r.w7=n("Continue");r.Zl=function(){t5.prototype.Zl.call(this);this.O||this.R.Fb()};function hif(a){a=a.link;return R('<input type="text" class="'+U("docs-copy-link")+'" value="'+U(a)+'" readonly="readonly">')};function iif(a,b,c,d){qA.call(this,void 0,void 0,a);this.H=this.O=this.L=this.C=null;this.ea="";this.F=b||null;this.xa=c||new gdd(a);this.V=null!=d?d:null;a=new dx;ix(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.xa.C()&&ix(a,{key:"copy-link",caption:"Copy link"});gx(this,a);this.R=new Im;this.qa(this.R)}t(iif,qA);r=iif.prototype;
r.Aa=function(){qA.prototype.Aa.call(this);V(ax(this),"copy-link-dialog");V(hx(this.D,"done"),"copy-link-done-button");this.C=W(hif,{link:this.ea},void 0,this.oa());Dw(this.C,"label","Link to this comment");this.Eb().appendChild(this.C);this.L=hx(this.D,"copy-link");null!==this.V&&(uv(this.nq(),"z-index",this.V),uv(ax(this),"z-index",this.V+1));if(this.L){var a=Wt("DIV");V(a,"copy-link-butter-holder");this.getElement().insertBefore(a,Yw(this));this.O=new qz(a);this.H=sz("Link copied to clipboard.",
"info",!1,4E3);var b=wv(ax(this),"zIndex");uv(a,"z-index",b+1)}};r.Km=function(){var a=this;qA.prototype.Km.call(this);this.F&&Mm(this.R,this.F.D(),function(b){b.C&&a.H&&a.O&&(a.H.isVisible()||a.O.postMessage(a.H),a.C.focus(),a.C.select())});this.C.focus();this.C.select()};r.Zl=function(){qA.prototype.Zl.call(this);this.F&&Tva(this.R,this.F.D())};r.Ga=function(){qA.prototype.Ga.call(this);this.getHandler().listen(this.C,"click",this.UYb);this.L&&this.getHandler().listen(this.L,"click",this.Yhb)};
r.BZb=function(a){this.ea=a;this.C&&(this.C.value=a)};r.UYb=function(a){a.target.focus();a.target.select()};r.Yhb=function(a){a.stopPropagation();this.F&&this.xa.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.F(this.C.value))};r.Ia=function(){qA.prototype.Ia.call(this);F(this.H);delete this.H;delete this.L;delete this.C};function v5(a){P.call(this);this.J=new P;this.qa(this.J);this.D=new Sz("");this.qa(this.D);this.O=new hz("");this.qa(this.O);this.V=a;this.Rd=null}x(v5,P);r=v5.prototype;
r.Ga=function(){v5.Oa.Ga.call(this);var a=Xv(this,"nfd-icwr");this.J.Va(a);this.Fa(this.J);if(a=Xv(this,"nfd-i"))this.D.Va(a),this.D.Sd(this.J),Kw(this.D.getElement(),"jfk-textinput"),a=new wA,a.Va(this.D.getElement()),this.qa(a),this.R=a=new vA(this.D.getElement()),this.qa(a),this.Rd=a=new Cx(this.D.getElement()),this.qa(a),a=new Sw(this.D.getElement()),this.getHandler().listen(a,"focusout",La(this.yVa,!1)).listen(a,"focusin",La(this.yVa,!0)).listen(this.R,"input",this.v2b);a=Xv(this,"nfd-a");this.O.Va(a);
this.Fa(this.O)};r.fu=g("Rd");r.getValue=function(){return this.D.getValue()};r.v2b=function(){var a=this.Ra(),b=this.getValue();I(a.ZI,2,b);this.zVa()};r.zVa=he;r.yVa=function(a){Mw(this.J.getElement(),"nfd-input-focus",a)};r.oP=function(a){this.Pb(a.clone());this.D.setValue(a.Mv());try{this.D.getElement().focus()}catch(b){}};r.nCa=function(){this.D.getElement().focus()};function jif(a,b){a=a.J.getElement();Mw(a,"nfd-invalid",b)};function kif(a){var b=a.JXb;return R("<li class='nfd-format-pill'><div class='nfd-format-display'>"+Q(a.O$a)+"</div><div class='nfd-format-sample'>"+Q(b)+"</div></li>")};function lif(a,b,c){P.call(this);this.Pb(a);this.D=b;this.C=c}t(lif,P);r=lif.prototype;r.Aa=function(){var a=this.Ra(),b=this.C?Vfa(a.Mv(),30):a.Mv();a=this.C?Hxd(a,this.D):"";b=W(kif,{O$a:b,JXb:a});this.wb(b)};r.Ga=function(){P.prototype.Ga.call(this);uu(this.getElement(),!0);var a=new Cx(this.getElement());this.qa(a);this.getHandler().listen(a,"key",this.SLb).listen(this.getElement(),"mousedown",this.RLb).listen(this.getElement(),"dblclick",this.Pjb)};
r.SLb=function(a){function b(c,d){for(;d=c(d);)if(Lv(d)){d.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(iu,this.getElement());break;case 38:b(n_a,this.getElement())}};r.RLb=function(a){a.preventDefault();this.dispatchEvent("change")};r.Pjb=function(){this.dispatchEvent("action")};function mif(a,b,c){P.call(this);this.C=b;this.D=c;nif(this,a)}t(mif,P);mif.prototype.Aa=function(){var a=this.oa().Aa("UL","nfd-pill-container");this.wb(a)};function nif(a,b){Pc(b,function(c){a.Fa(new lif(c,a.C,a.D),!0)})}mif.prototype.filter=function(a){a=a.toLowerCase();this.Pe(function(b){var c=Bd(ef(a)),d=b.Ra().Mv().toLowerCase();c=c||Dd(d,a);N(b.getElement(),c)})};function w5(a){qA.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.Vha();this.Fa(this.input,!0);this.H=new P;this.Fa(this.H,!0);a=this.b8();nd(a,void 0,Ohf);this.C=new mif(a,this.wZ(),this.tTa());this.H.Fa(this.C,!0);gx(this,null);this.Mi=!0}t(w5,qA);r=w5.prototype;r.hNa=n(null);r.tTa=n(!0);r.isEmpty=function(){return Bd(this.input.getValue())};r.wf=function(){return this.input.Ra().wf()};r.Aa=function(){qA.prototype.Aa.call(this);var a=Wt("DIV","dialog-separator");cu(a,Yw(this))};
r.Ga=function(){qA.prototype.Ga.call(this);V(this.H.getElement(),"nfd-dialog-content");this.getHandler().listen(this.C,"change",this.gmb).listen(this.C,"action",this.dqa).listen(this.input.O,"action",this.dqa).listen(this.input,"afterhide",this.reb);this.input.R&&this.getHandler().listen(this.input.R,"input",this.KLb);var a=this.input.fu();a&&this.getHandler().listen(a,"key",this.LLb);a=this.b8()[0];this.input.oP(a)};r.reb=function(a){a.stopPropagation()};
r.gmb=function(a){this.input.oP(a.target.Ra());jif(this.input,!1)};r.KLb=function(){this.C.filter(this.input.getValue());jif(this.input,!this.input.Ra().wf())};r.LLb=function(a){13==a.keyCode&&this.dqa()};r.dqa=function(){this.wf()&&!this.isEmpty()?(nib.Fb(new nW(this.u1(),void 0,this.hNa())),this.setVisible(!1)):(jif(this.input,!0),this.input.nCa())};function x5(a,b,c,d,e){ry.call(this,b,c,d,e);this.C=a}t(x5,ry);x5.prototype.Rg=function(){var a=ry.prototype.Rg.call(this),b=this.getParent();return b&&b instanceof Px&&!b.isVisible()?this.C(a,this.Ra()):a};function oif(a){a=a||{};var b=a.id,c=a.name,d=a.xd,e=a.kVb,f=a.f2b,h=a.maxLength,k=a.value,l=a.dir,m=a.type,p=a.pattern;a=a.attributes;return R('<input class="'+U("jfk-textinput")+(d?" "+U(d):"")+'"'+(b?' id="'+U(b)+'"':"")+(h?' maxlength="'+U(h)+'"':"")+(qw(e)&&qw(f)?' label="'+U(e)+'"':"")+(c?' name="'+U(c)+'"':"")+(e?' placeholder="'+U(e)+'"':"")+' type="'+U(null!=m?m:"text")+'"'+(p?' pattern="'+U(p)+'"':"")+(k?' value="'+U(k)+'"':"")+(l?' dir="'+U(l)+'"':"")+(a?" "+s2a(a):"")+">")};function pif(a,b,c){b=c||b;return R("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+U(a.f0)+"'>"+qif(a)+"</div>"+rif(a,b)+"</div>")}function sif(a,b,c){b=c||b;return R("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+U(a.f0)+"'></div>"+rif(a,b)+"</div>")}
function tif(a,b,c){b=c||b;c=a.DCb;return R("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+U(a.f0)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+qif(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+U(c)+"'></div></div></div></div>"+rif(a,b)+"</div>")}
function uif(){var a="<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+vif({label:""});a+=vif({label:rw("Negative:")});a+=vif({label:rw("Zero:")});a+=vif({label:rw("Text:")});return R(a+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>")}function vif(a){return R("<tr><td class='nfd-sample-label'>"+Q(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function rif(a,b){a=""+Q(gz({id:a.UK,style:2,xd:"nfd-apply",content:"Apply"},b));return R(a)}function qif(a){return R(Q(oif({id:a.cKa,kVb:a.dKa,f2b:!0})))};function wif(a){v5.call(this,a);this.F=new P;this.C=new VQ("");this.C.Qc("nfd-currency-other-formats")}t(wif,v5);r=wif.prototype;r.Aa=function(){var a=W(tif,{f0:Vv(this,"nfd-icwr"),cKa:Vv(this,"nfd-i"),dKa:this.V,DCb:Vv(this,"nfd-ic"),UK:Vv(this,"nfd-a")});this.wb(a)};
r.Ga=function(){v5.prototype.Ga.call(this);var a=Xv(this,"nfd-ic");this.F.Va(a);this.F.Sd(this.J);this.F.Fa(this.C,!0);this.getHandler().listen(this.C,"aftershow",this.MLb).listen(this.C,"action",this.SGa).listen(this.R,"input",La(this.jVa,null))};r.oP=function(a){v5.prototype.oP.call(this,a);a.C&&this.D.setValue(Mz[a.C][1]);this.jVa(a)};
r.jVa=function(a){a=a?a.C:void 0;var b=this.C;b.hf(null);if(a){var c=this.Ra(),d=c.C;xif(this,c);c=aEd(d,Mz[d][2]);c=new nW(yif(c),$Dd[d],d);xif(this,c);c=aEd(d,d+" "+Mz[d][1]);d=new nW(yif(c),$Dd[d],d);xif(this,d)}else this.Ra().C=null;var e="[$"+this.getValue()+"]";d=a?$Dd[a]:null;c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new nW(yif(c[e]),d,a);xif(this,f)}b.Ye(0);this.SGa();V(b.Sb().getElement(),"number-format-menu")};function xif(a,b){var c=new x5(function(d){return Vfa(d,25)},Hxd(b,1E3),b);a.qa(c);a.qa(b);c.Ho(!0);a=a.C;for(b=0;b<a.Ei();b++)if(a.Tf(b).Rg()==c.Rg())return;a.Pc(c)}r.SGa=function(){for(var a=this.C,b=0;b<a.Ei();b++)a.Tf(b).dc(!1);a.PP()};r.MLb=function(){this.C.zf().dc(!0)};function yif(a){var b=new mg;I(b,2,a);b.setType(4);return b};function zif(a){w5.call(this,a);this.setTitle("Custom currencies")}t(zif,w5);r=zif.prototype;r.wZ=n(1000.12);r.Vha=function(){return new wif("Custom currency")};r.b8=function(){var a=this;hAd();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=$Dd[e]:Hhf(d,cEd(d.Ul()))}var f=[];Id(Mz,function(k,l){k=bEd(l);a.qa(k);f.push(k)});var h=vZd();qd(f,function(k,l){return h(k.Mv(),l.Mv())});return b.concat(f)};
r.u1=function(){var a=new mg;a.setType(4);I(a,3,1);var b=this.input.C.zf().getValue().Ul();I(a,2,b);return a};r.hNa=function(){return this.input.Ra().C};function Aif(a){P.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}t(Aif,P);Aif.prototype.Aa=function(){var a=W(uif);this.F=St("nfd-sample-label",a);this.D=Rt("nfd-rendered-sample",a);this.wb(a)};function Bif(a,b){v5.call(this,a);this.C=new Aif(b);this.Pb(new nW(""))}t(Bif,v5);Bif.prototype.Aa=function(){var a=W(pif,{cKa:Vv(this,"nfd-i"),dKa:this.V,f0:Vv(this,"nfd-icwr"),UK:Vv(this,"nfd-a")});this.wb(a)};Bif.prototype.Ga=function(){v5.prototype.Ga.call(this);this.Fa(this.C,!0);Cif(this)};Bif.prototype.zVa=function(){Cif(this)};Bif.prototype.oP=function(a){v5.prototype.oP.call(this,a);Cif(this)};
function Cif(a){var b=a.Ra();if(b){var c=a.C;a=b.Ul().split(";").length-1;tu(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=Hxd(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.Ul()),k=d<=a;N(p_a(e),k);tu(e,f);uv(e,"color",h||"")}d=b.wf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.Ul()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.Ul());c=c.D[3];N(p_a(c),3<=a);tu(c,d);uv(c,"color",b||"")}};function Dif(a){w5.call(this,a);this.setTitle("Custom number formats")}t(Dif,w5);Dif.prototype.wZ=n(1234.56);Dif.prototype.Vha=function(){return new Bif("Custom number format",1234.56)};
Dif.prototype.b8=function(){var a=this.F;a.push(new nW("0"));a.push(new nW("0.00"));a.push(new nW("#,##0"));a.push(new nW("#,##0.00"));a.push(new nW("#,##0_);(#,##0)"));a.push(new nW("#,##0_);[Red](#,##0)"));a.push(new nW("#,##0.00_);(#,##0.00)"));a.push(new nW("#,##0.00_);[Red](#,##0.00)"));a.push(new nW("$#,##0_);($#,##0)"));a.push(new nW("$#,##0_);[Red]($#,##0)"));a.push(new nW("$#,##0.00_);($#,##0.00)"));a.push(new nW("$#,##0.00_);[Red]($#,##0.00)"));a.push(new nW("@"));a.push(new nW("0%"));a.push(new nW("0.00%"));
a.push(new nW("0.00E+00"));a.push(new nW("##0.0E+0"));a.push(new nW("# ?/?"));a.push(new nW("# ??/??"));a.push(new nW('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new nW('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new nW('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new nW('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};Dif.prototype.u1=function(){var a=new mg;a.setType(2);I(a,3,1);var b=this.input.getValue();I(a,2,b);return a};function Eif(a){var b=a.description;a=a.cXb;return R('<div class="waffle-dv-rec-chip" title="'+U(b)+'"><div class="waffle-dv-rec-range">'+Q(a)+'</div><div class="waffle-dv-rec-description">'+Q(b)+"</div></div>")}function Fif(){return R('<div class="waffle-dv-no-suggestions" role="alert" aria-live="polite">No suggestions for selected data</div>')};function Gif(){var a=new VQ(null);a.Wj(!0);return a};function Hif(a,b,c){M.call(this);this.Ac=B(A(),"docs-egmd");this.D=a;this.qh=b;this.Cb=c;this.R=this.H=this.Da=this.Ba=this.V=this.F=null;this.Zb=new Sz;this.qa(this.Zb);this.Vd=new Sz;this.qa(this.Vd);this.xa=this.O=null;this.jd=new Sz;this.qa(this.jd);this.Ie=new Sz;this.qa(this.Ie);this.Pa=this.Ka=this.Na=this.ea=this.L=null;this.zd=new Sz;this.qa(this.zd);this.Kd=new Sz;this.qa(this.Kd);this.Ic=new Sz;this.qa(this.Ic);this.Zd=new Sz;this.qa(this.Zd);this.Ta=this.rc=null;this.C=new DZ("");this.qa(this.C);
this.$a=this.J=this.xb=this.eb=this.kf=this.hc=this.Tb=this.Xa=null;this.Bg=this.Rc=!1;this.Ib=this.tf=this.Qa=this.Ya=null;this.Xd=new hn(this);this.qa(this.Xd);this.Lh=new qk;this.Xf=this.Ah=this.Jg=this.Jf=this.uh=this.Ha=null;this.Tu();a=this.Xd;a.listen(this.F,"action",this.Xnb);a.listen(this.V,"action",this.Xma);a.listen(this.Ba,"action",this.Xma);a.listen(this.Da,"action",this.Xma);a.listen(this.J,"focus",La(this.BSa,!0));a.listen(this.J,"blur",La(this.BSa,!1));a.listen(this.J,"change",this.Jma);
a.listen(this.J,"keyup",this.Jma);b=[this.O,this.xa,this.H,this.R,this.L,this.ea,this.Ka,this.Pa];for(c=0;c<b.length;c++)this.Xd.listen(b[c],"change",v(this.nLb,this,b[c])),this.Xd.listen(b[c],"keyup",v(this.Snb,this,b[c]));a.listen(this.Qa,"change",v(this.HIa,this));a.listen(this.Na,"change",v(this.oAb,this));a.Df(this.$a,cn,this.qvb)}x(Hif,M);var Iif="placeholder"in document.createElement("input");
function Jif(a){var b=a.Xf;b||(b=[{Xj:"List from a range",type:4},{Xj:"List of items",type:3},{Xj:"Number",type:0},{Xj:"Text",type:1},{Xj:"Date",type:2},{Xj:"Custom formula is",type:5},{Xj:"Tick box",type:6}],a.Xf=b);return b}
function Kif(a){var b=a.Ah;b||(b=[{Xj:"contains",code:9,inputs:0,example:"Approved"},{Xj:"does not contain",code:10,inputs:0,example:"Approved"},{Xj:"equals",code:13,inputs:0,example:"Approved"},{Xj:"is a valid email",code:14,inputs:-1,example:null},{Xj:"is a valid URL",code:15,inputs:-1,example:null}],a.Ah=b);return b}
function Lif(a){var b=a.Jf;if(!b){b=a.Ac?"11/2017":"15/11/2014";var c=a.Ac?"11/2018":"15/11/2015",d=a.Ac?"11/2017":"15/11/2014";b=[{Xj:"is a valid date",code:30,inputs:-1,example:null},{Xj:"equal to",code:16,inputs:2,example:d},{Xj:"before",code:17,inputs:2,example:d},{Xj:"on or before",code:19,inputs:2,example:d},{Xj:"after",code:18,inputs:2,example:d},{Xj:"on or after",code:20,inputs:2,example:d},{Xj:"between",code:21,inputs:3,example:b,fR:c},{Xj:"not between",code:22,inputs:3,example:b,fR:c}];
a.Jf=b}return b}function Mif(a){var b=a.Jg;b||(b=[{Xj:"range",code:23,inputs:6,example:null},{Xj:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.Jg=b);return b}
function Nif(a){var b=a.uh;b||(b=[{Xj:"between",code:7,inputs:8,example:"10",fR:"100"},{Xj:"not between",code:8,inputs:8,example:"10",fR:"100"},{Xj:"less than",code:3,inputs:7,example:"10"},{Xj:"less than or equal to",code:4,inputs:7,example:"10"},{Xj:"greater than",code:1,inputs:7,example:"10"},{Xj:"greater than or equal to",code:2,inputs:7,example:"10"},{Xj:"equal to",code:5,inputs:7,example:"10"},{Xj:"not equal to",code:6,inputs:7,example:"10"}],a.uh=b);return b}
function Oif(){return{Xj:"",code:29,inputs:0,example:"=ISODD(A1)"}}function Pif(){return{Xj:"",code:31,inputs:-1,example:""}}r=Hif.prototype;
r.Tu=function(){var a=this.D,b,c,d,e,f,h,k,l,m,p,q,u,w,y,E=a.oa(),O;var S=E.Aa("TR","waffle-dv-trrules",E.Aa("TD","waffle-dv-label",E.Aa("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),E.Aa("TD",{colspan:"7"},l=E.Aa("DIV","goog-inline-block"),O=E.Aa("DIV","goog-inline-block"),h=E.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=E.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=E.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=E.Aa("SPAN","waffle-dv-separator","and"),k=E.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=E.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=E.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.Ic.Va(h);this.Zd.Va(k);this.jd.Va(c);this.Ie.Va(d);this.Zb.Va(e);this.Vd.Va(f);var T=Gif();Uv(T,l);var ia=Gif();Uv(ia,l);var la=Gif();Uv(la,l);var qa=Gif();Uv(qa,l);var Ia=Qif(a,O);(u=T.getElement())&&Dw(u,"labelledby",
"waffle-dv-criteria");var Aa;var Ra=E.Aa("TR","waffle-dv-trrules waffle-dv-trrules-showitems",E.Aa("TD"),E.Aa("TD",{colspan:"7"},Aa=E.Aa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show drop-down list in cell")));u=Rif(this);jT(u,Aa);Uv(u,Aa);var Na=E.Aa("TR","waffle-dv-trrules waffle-dv-trrules-showitems",E.Aa("TD"),E.Aa("TD",{colspan:"7"},m=E.Aa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Use custom cell values")));var Ka=Rif(this);jT(Ka,m);Uv(Ka,m);var Oa=E.Aa("TR","waffle-dv-trrules",
E.Aa("TD"),E.Aa("TD","waffle-dv-customcheckboxlabel",E.Aa("SPAN",{id:"customCheckboxInputLabel_checked"},"Ticked:")),E.Aa("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},p=E.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));var Ua=E.Aa("TR","waffle-dv-trrules",E.Aa("TD"),E.Aa("TD","waffle-dv-customcheckboxlabel",E.Aa("SPAN",{id:"customCheckboxInputLabel_unchecked"},"Unticked:")),E.Aa("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},q=E.Aa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));
this.zd.Va(p);this.Kd.Va(q);Dw(p,"labelledby","customCheckboxInputLabel_checked");Dw(q,"labelledby","customCheckboxInputLabel_unchecked");iW(this.zd,"e.g. TRUE");iW(this.Kd,"e.g. FALSE");var Qb=E.Aa("TR","waffle-dv-trrules",E.Aa("TD","waffle-dv-label",E.Aa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),E.Aa("TD",{colspan:"7"},E.Aa("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},E.Aa("INPUT",{type:"radio",id:"showWarningOnInvalidData_radio",
name:"onInvalidData",role:"radio"}),E.Aa("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),E.Aa("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),E.Aa("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new X7d;Y7d(m,"onInvalidData",Qb);var Gb=E.Aa("TR","waffle-dv-trrules waffle-dv-trrules-appearance",E.Aa("TD",null,E.Aa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),E.Aa("TD",{colspan:"7"},w=E.Aa("SPAN",
"waffle-dv-label waffle-dv-checkbox-label","Show validation help text:")));var Rb=Rif(this);jT(Rb,w);Uv(Rb,w);w=Rb.La();var Tb=S2a(w,"labelledby");Dw(w,"labelledby","waffle-dv-appearance "+Tb);w=E.Aa("TR","waffle-dv-trrules",E.Aa("TD"),E.Aa("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},y=E.Aa("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),Tb=E.Aa("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));uu(Tb,!0);a=a.xa.childNodes[0];
E.appendChild(a,S);E.appendChild(a,Ra);E.appendChild(a,Na);E.appendChild(a,Oa);E.appendChild(a,Ua);E.appendChild(a,Qb);E.appendChild(a,Gb);E.appendChild(a,w);this.C.render(l);E=this.C;E.Cpa=this.Ac?36:29;E.resize();E=this.C;E.lpa=200;E.resize();this.C.getElement().style.width="324px";Iif?this.C.getElement().placeholder="Enter items separated by a comma...":(E=this.C.getElement(),Gy(E,"Enter items separated by a comma...","Enter items separated by a comma..."));if(E=this.C.getElement())Gw(E,"Enter items separated by a comma..."),
Jw(E,["waffle-dv-list-options-textarea","jfk-textinput"]);this.J=y;T.setVisible(!0);E=Jif(this);Sif(this,E,T);E=Nif(this);Sif(this,E,qa);E=Kif(this);Sif(this,E,ia);E=Lif(this);Sif(this,E,la);Tif(this,T,qa,ia,la,h,k,c,d,e,f,b,l,Ia,Ra,w,u,Aa,Tb,Rb,O,m,Ka,p,q,Na,Oa,Ua)};
function Tif(a,b,c,d,e,f,h,k,l,m,p,q,u,w,y,E,O,S,T,ia,la,qa,Ia,Aa,Ra,Na,Ka,Oa){a.F=b;a.F.setVisible(!0);a.Ba=c;a.V=e;a.Da=d;a.rc=q;a.L=f;a.ea=h;a.O=k;a.xa=l;a.H=m;a.R=p;a.Ta=u;a.Ha=w;a.Xa=la;a.Na=Ia;a.Ka=Aa;a.Pa=Ra;a.kf=Na;a.eb=Ka;a.xb=Oa;N(a.kf,!1);N(a.eb,!1);N(a.xb,!1);ia.dc(!1);a.Qa=ia;a.Ib=qa;Uif(a,!1);a.Tb=y;O.dc(!0);a.Ya=O;a.tf=S;a.hc=E;N(a.hc,!0);Vif(a);Wif(a);a.$a=T;N(a.$a,!1)}
function Xif(a,b){N(a.Tb,23==b||24==b);a.tf.innerText="Show drop-down list in cell";b=31==b;N(a.kf,b);var c=a.Na.isChecked();N(a.eb,b&&c);N(a.xb,b&&c)}function Sif(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.oa();e=new ry(b[d].Xj,null,e);c.Pc(e);Cw(e.getElement(),"menuitem")}c.Ye(0)}r.Xma=function(){Wif(this);this.J.value=Yif(this);this.dispatchEvent("change")};r.Xnb=function(){Vif(this);Wif(this);this.J.value=Yif(this);this.dispatchEvent("change")};r.BSa=ca("Bg");
r.Jma=function(a){this.Rc||a&&!X2a(a)||this.J.value===Zif(this)||(this.Rc=!0,N(this.$a,!0))};r.qvb=function(){this.Rc=!1;this.J.value=Yif(this);N(this.$a,!1)};r.HIa=function(){N(this.hc,this.Qa.isChecked())};r.oAb=function(){var a=this.Na.isChecked();a||$if(this);N(this.eb,a);N(this.xb,a);ajf(this)};function ajf(a){a.J.value=Yif(a)}function bjf(a){ajf(a);a.C.resize()}r.nLb=function(a){ajf(this);cjf(this,a)?(this.D.C=0,y5(a),this.dispatchEvent("change")):(this.D.C=1,z5(a),this.dispatchEvent("error"))};
r.Snb=function(){this.dispatchEvent("keyup")};function cjf(a,b){if(0!=A5(a))return!0;var c=b.value;if(null!=c&&Lv(b)){if(!djf(a.D))return!0;a=B5(a,c,ejf(a).code);return null!=a&&(Wf(a,3)||Wf(a,5)&&a.lq().hasValue()&&3==H(a.lq().getValue(),1))}return!0}function z5(a){a.select();V(a,"waffle-input-error")}function y5(a){a&&Kw(a,"waffle-input-error")}function $if(a){y5(a.C.getElement());y5(a.H);y5(a.R);y5(a.L);y5(a.ea);y5(a.Ka);y5(a.O);y5(a.xa);y5(CV(a.Ha));a.D.C=0;a.dispatchEvent("change")}
function fjf(a,b){return a.Ac?b:"e.g. "+b}function A5(a){return Jif(a)[a.F.Vh()].type}function Vif(a){var b=A5(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.V.setVisible(c);a.Ba.setVisible(d);a.Da.setVisible(e);N(a.Ta,f);N(a.Xa,h);N(a.L,!1);N(a.ea,!1);N(a.O,!1);N(a.xa,!1);N(a.H,!1);N(a.R,!1);f&&a.C.resize();a.dispatchEvent("change")}
function ejf(a){var b;null!=gjf(a)?b=gjf(a):a.V.isVisible()?b=Lif(a)[a.V.Vh()]:a.Ba.isVisible()?b=Nif(a)[a.Ba.Vh()]:5==A5(a)?b=Oif():6==A5(a)?b=Pif():b=Kif(a)[a.Da.Vh()];return b}function gjf(a){var b=Mif(a);return 4==A5(a)?b[0]:3==A5(a)?b[1]:null}
function Wif(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,p=ejf(a);-1!=p.inputs&&(0==p.inputs?d=!0:1==p.inputs?k=e=d=!0:2==p.inputs?f=!0:3==p.inputs?k=h=f=!0:7==p.inputs?b=!0:8==p.inputs?k=c=b=!0:5==p.inputs?l=!0:6==p.inputs&&(m=!0));var q=ejf(a);if(3==A5(a))Iif?a.C.getElement().placeholder="Enter items separated by a comma...":(q=a.C.getElement(),Gy(q,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(q.example)if(0==q.inputs||1==q.inputs)iW(a.jd,fjf(a,q.example)),
iW(a.Ie,fjf(a,q.fR)||"");else if(2==q.inputs||3==q.inputs)iW(a.Zb,fjf(a,q.example)),iW(a.Vd,fjf(a,q.fR)||"");else if(7==q.inputs||8==q.inputs)iW(a.Ic,fjf(a,q.example)),iW(a.Zd,fjf(a,q.fR)||"");$if(a);N(a.L,b);N(a.ea,c);N(a.O,d);N(a.xa,e);N(a.H,f);N(a.R,h);N(a.Ta,l);l&&a.C.resize();N(a.Xa,m);Xif(a,p.code);N(a.rc,k)}
function B5(a,b,c){var d=djf(a.D);if(""==b||null==d.C)return null;var e=d.rect,f=e.Bc();e=e.xc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.C,f,e,b,c,!0))?a.Lh.Sc(Dg.va(),b):null}
function hjf(a){var b=new Ig,c=ejf(a),d=c.code,e=[];switch(c.inputs){case 0:e.push(B5(a,a.O.value,d));break;case 1:e.push(B5(a,a.O.value,d));e.push(B5(a,a.xa.value,d));break;case 2:e.push(B5(a,a.H.value,d));break;case 3:e.push(B5(a,a.H.value,d));e.push(B5(a,a.R.value,d));break;case 7:e.push(B5(a,a.L.value,d));break;case 8:e.push(B5(a,a.L.value,d));e.push(B5(a,a.ea.value,d));break;case 5:a=a.C.getValue().split(",");for(c=0;c<a.length;c++)e.push(l_d(a[c]));break;case 6:c=Mac("="+a.Ha.getValue());e.push(B5(a,
c,d));break;case -1:a.Na.isChecked()&&(e.push(B5(a,Cd(a.Ka.value),d)),Bd(a.Pa.value)||e.push(B5(a,Cd(a.Pa.value),d)))}for(a=0;a<e.length;a++)if(!e[a])return null;d=VIb(d,e);Kg(b,d);return b}function ijf(a){var b=Cd(a.Ha.getValue());!a.Cb.D.D[Cd(ef(b).toLowerCase())]&&pXd(a.Cb,b)&&(b=sXd(a.Cb,b,!0));return b}function Yif(a){return a.Rc||a.Bg?a.J.value:Zif(a)}
function Zif(a){var b="";var c=A5(a);var d=4==c;c=3==c||4==c;if(a.V.isVisible())c=Lif(a)[a.V.Vh()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date ";else if(a.Da.isVisible())c=Kif(a)[a.Da.Vh()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid URL":b+"Enter text that ";else if(c)c=gjf(a),b+="Click and enter a value from ";else if(5==A5(a))c=Oif(),b="Enter a value that satisfies the formula:";else if(6==A5(a))if(c=Pif(),a.Na.isChecked()&&!Bd(Cd(a.Ka.value))){b=Cd(a.Ka.value);var e=
Cd(a.Pa.value);b=Bd(e)?"Enter "+(b+" or blank."):"Enter "+(b+(" or "+(e+".")))}else b="Enter TRUE or FALSE.";else c=Nif(a)[a.Ba.Vh()],b+="Enter a number ";-1!=c.inputs&&(b+=c.Xj);e=ijf(a);23==c.code&&""!=e&&d&&(d=sXd(a.Cb,e,!0))&&(b+=" "+d);Bd(ef(a.O.value))||0!=c.inputs&&1!=c.inputs?Bd(ef(a.H.value))||2!=c.inputs&&3!=c.inputs?Bd(ef(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.H.value:b+=" "+a.O.value;Bd(ef(a.xa.value))||1!=c.inputs?Bd(ef(a.R.value))||3!=c.inputs?Bd(ef(a.ea.value))||
8!=c.inputs||(b+=" and "+a.ea.value):b+=" and "+a.R.value:b+=" and "+a.xa.value;return b}function Uif(a,b){Z7d(a.Ib,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function jjf(a,b){switch(b){case 0:a.F.Ye(2);break;case 1:a.F.Ye(3);break;case 2:a.F.Ye(4);break;case 3:a.F.Ye(1);break;case 4:a.F.Ye(0);break;case 5:a.F.Ye(5);break;case 6:a.F.Ye(6)}}
function kjf(a,b,c,d,e){a.F.Ye(0);a.V.Ye(0);a.Ba.Ye(0);a.Da.Ye(0);a.J.value="";a.L.value="";a.ea.value="";a.H.value="";a.R.value="";a.O.value="";a.xa.value="";a.C.setValue("");a.Ha.setValue("");Uif(a,!1);var f=a.Rc=!1,h=!1,k=!1,l=!1,m=!1,p=!1,q=!1,u=!1,w=!1,y=!1,E=!1,O=!1,S=!1,T=!1,ia=!1,la=!1,qa=!1,Ia=!1,Aa=b&&Jg(b);b=Aa&&Fg(Aa);if((Aa=Aa&&Gg(Aa))&&b){for(var Ra=Mif(a),Na=Lif(a),Ka=Nif(a),Oa=Kif(a),Ua=Oif(),Qb=Pif(),Gb=0,Rb=0;Rb<Ra.length;Rb++)if(b==Ra[Rb].code){Gb=Ra[Rb].inputs;23==Ra[Rb].code?
(la=!0,jjf(a,4)):(O=!0,jjf(a,3));a.Ya.dc(!!e);break}for(e=0;e<Na.length;e++)if(b==Na[e].code){Gb=Na[e].inputs;a.V.Ye(e);jjf(a,2);S=u=!0;break}for(e=0;e<Ka.length;e++)if(b==Ka[e].code){Gb=Ka[e].inputs;a.Ba.Ye(e);jjf(a,0);T=w=!0;break}for(e=0;e<Oa.length;e++)if(b==Oa[e].code){Gb=Oa[e].inputs;a.Da.Ye(e);jjf(a,1);ia=y=!0;break}b==Ua.code&&(Gb=Ua.inputs,jjf(a,5),qa=!0);b==Qb.code&&(Gb=Qb.inputs,jjf(a,6),Ia=!0);if(S||ia||T||O||la||qa||Ia)if(ia=djf(a.D),S=ia.rect.Bc(),T=ia.rect.xc(),ia=ia.C,-1==Gb)Ia&&0<
Aa.length&&(E=!0,a.Na.dc(!0),a.zd.setValue(lH(Aa[0],ia,S,T)),1<Aa.length&&a.Kd.setValue(lH(Aa[1],ia,S,T)));else if(0==Gb)m=lH(Aa[0],ia,S,T),a.jd.setValue(m),m=!0;else if(1==Gb)p=lH(Aa[0],ia,S,T),m=lH(Aa[1],ia,S,T),a.jd.setValue(p),a.Ie.setValue(m),p=m=q=!0;else if(2==Gb)f=lH(Aa[0],ia,S,T),a.Zb.setValue(f),f=!0;else if(3==Gb)h=lH(Aa[0],ia,S,T),f=lH(Aa[1],ia,S,T),a.Zb.setValue(h),a.Vd.setValue(f),h=f=q=!0;else if(7==Gb)k=lH(Aa[0],ia,S,T),a.Ic.setValue(k),k=!0;else if(8==Gb)l=lH(Aa[0],ia,S,T),k=lH(Aa[1],
ia,S,T),a.Ic.setValue(l),a.Zd.setValue(k),l=k=q=!0;else if(5==Gb){O=!0;Ia=[];for(Gb=0;Gb<Aa.length;Gb++)Ia.push(lH(Aa[Gb],ia,S,T));a.C.setValue(Ia.join(","));a.C.resize()}else 6==Gb&&(la=!0,Ia=lH(Aa[0],ia,S,T),null!=Ia&&(Ia=Ia.substring(1),Aa=!!vN(Ia),Ia=(Gb=xN(Ia,a.qh,!1,!0))?zN(Gb.rect,VI(a.qh,Gb.C).$d()):Ia,Aa||(Ia=wN(Ia)),a.Ha.setValue(Ia)));else a.F.Ye(0),la=!0;N(a.rc,q);a.V.setVisible(u);a.Ba.setVisible(w);a.Da.setVisible(y);N(a.H,f);N(a.R,h);N(a.O,m);N(a.xa,p);N(a.L,k);N(a.ea,l);N(a.eb,E);
N(a.xb,E);N(a.Tb,!0);N(a.Ta,O);a.C.resize();N(a.Xa,la);null!=b&&Xif(a,b)}else Tif(a,a.F,a.Ba,a.Da,a.V,a.L,a.ea,a.O,a.xa,a.H,a.R,a.rc,a.Ta,a.Ha,a.Tb,a.hc,a.Ya,a.tf,a.$a,a.Qa,a.Xa,a.Ib,a.Na,a.Ka,a.Pa,a.kf,a.eb,a.xb);a.HIa();c=c||"";u=c.lastIndexOf("</strong>");-1!=u&&(c=$e(Cd(c.substring(u+9))));a.Qa.dc(!!c);c&&(Yif(a)!=c&&a.Jma(),a.J.value=c,N(a.hc,!0));Uif(a,d)}function Rif(a){a=a.D.oa();return new kT(!1,hT.getInstance(),a)}
r.Ia=function(){this.Tb=this.Ya=this.$a=this.J=this.rc=this.Pa=this.Ka=this.ea=this.L=this.xa=this.O=this.R=this.H=null;F(this.Ha);this.Ha=null;F(this.Ya);this.Ya=null;F(this.Da);this.Da=null;F(this.Ba);this.Ba=null;F(this.V);this.V=null;F(this.F);this.F=null;F(this.Qa);this.Qa=null;F(this.Ib);this.Ib=null;Hif.Oa.Ia.call(this)};function ljf(a,b,c,d,e,f,h){qA.call(this);this.xb=a;this.Zd=b;this.Ya=c;this.Rc=d;this.V=e;this.Ta=f;this.Qa=h;this.ea=new P(this.oa());this.Fa(this.ea);this.Tb=new ny("",new mV,this.oa());this.Fa(this.Tb);this.Xa=new P(this.oa());this.Fa(this.Xa);this.qe=new bV(!1,"#4285f4");this.Fa(this.qe);this.hc=new jP(c,"waffle-dv-highlight-styled-border","waffle-dv-highlight-styled-rect");this.qa(this.hc);this.H=this.xa=null;this.Zb=new hn(this);this.qa(this.Zb);this.eb=this.O=this.L=this.F=null;this.Ha=B(A(),
"fedvs");this.$a=this.R=null;this.Cb=-1;this.Ac=[];this.rc=[];this.Kd=-1;a=NK(this.Ya).Nc();this.Xd=Ul(a.Bc(),a.xc(),a.$c(),a.cd());this.Ib=!1;this.Ic=new hn(this);this.qa(this.Ic);this.O=new dx;this.C=0;B(A(),"docs-egmd")?(this.O.set("cancel","Cancel",!1,!0),this.O.set("clear","Remove validation"),this.O.set("save","Save")):(this.O.set("save","Save"),this.O.set("clear","Remove validation"),this.O.set("cancel","Cancel",!1,!0));gx(this,this.O);cx(this,!1);this.render();V(ax(this),"waffle-data-validation-dialog");
a=this.Eb();b=this.oa();this.setTitle("Data validation");this.L||(c=b.Aa("DIV",{"class":"waffle-input-error-butter-wrap"}),d=b.Aa("DIV",{"class":"waffle-input-error-butter-container"},c),b.appendChild(a,d),this.L=new pz(d),this.L.setType("warning"),this.L.setContent(""),this.L.render(c),z7a(this.L,!0),this.L.setVisible(!1));this.Ha&&(d=b.Aa("DIV","waffle-dv-recs-title-bar"),e=b.Aa("DIV",{id:mjf.Zwa},"Suggested validations"),c=b.Aa("DIV","waffle-dv-rec-wrapper"),f=b.Aa("DIV","waffle-dv-feedback-link",
"Send feedback"),b.appendChild(a,d),b.appendChild(d,f),b.appendChild(d,e),b.appendChild(a,c),this.Tb.Va(f),N(f,fB),this.ea.Va(c),d=b.Aa("DIV","waffle-dv-rec-spinner-container"),b.appendChild(c,d),this.Xa.Va(d),this.qe.render(d),this.qe.setActive(!0));this.xa=b.Aa("TABLE",{cellSpacing:"0","class":"waffle-dv-table"},b.Aa("TBODY"));b.appendChild(a,this.xa);this.Ha&&V(this.xa,"waffle-dv-table-with-suggestions");a=this.Eb();a=Lt(a);b=a.Aa("TR","waffle-dv-trrules");b.appendChild(a.Aa("TD","waffle-dv-label",
a.Aa("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));c=a.Aa("TD",{colspan:"7"});this.F=Qif(this,c);njf(this);b.appendChild(c);a.appendChild(this.xa.childNodes[0],b);(a=CV(this.F))&&Dw(a,"labelledby","waffle-dv-cell-range");this.H=new Hif(this,this.xb,this.V);sx(this,"save");ojf(this)}t(ljf,qA);function njf(a){if(a.F){var b=a.xb.getActiveGrid();b&&(b=zN(NK(a.Ya).Nc(),b.$d(),!0),a.F.setValue(b))}}
function ojf(a){a.Zb.listen(a,"dialogselect",a.mLb).listen(a.H,"error",a.Rnb).listen(a.H,"change",a.lLb).listen(a.F,"change",function(){a.H&&ajf(a.H);if(a.Ha){var b=djf(a);a.Ib||a.R&&b&&b.intersects(AY(a.V,a.$a))||pjf(a)}});a.Ha&&a.Zb.listen(a.Ta,"recommender-calc-ended",a.kLb).listen(a.Tb,"action",function(){(Jt(),ws).Fb({source:"dataValidationDialogFeedback"})})}r=ljf.prototype;r.Rnb=function(){qjf(this)};r.lLb=function(){qjf(this);jx(this.O,"save",!0)};
function rjf(a){var b=a.oa();a=a.ea.La();var c=W(Fif);b.appendChild(a,c)}
r.kLb=function(a){var b=this;this.qe.setActive(!1);N(this.Xa.La(),!1);a=a.C;if(0==a.length)rjf(this);else for(var c=this.oa(),d=this.ea.La(),e=0,f={SP:0};f.SP<a.length;f={qK:f.qK,DC:f.DC,rW:f.rW,SP:f.SP,g4:f.g4,BC:f.BC},f.SP++){var h=a[f.SP],k=H(h,13);if(3<=e||!k)break;e++;f.g4=gK(h);f.rW=zN(zm(f.g4));f.DC=H(k,3);this.Ac.push(f.DC);this.rc.push(f.rW);h="";switch(Fg(f.DC)){case 14:h="Is valid email";break;case 15:h="Is valid URL";break;case 30:h="Is valid date";break;case 24:h="List: "+Gg(f.DC).map(function(l){return H(l.lq().getValue(),
2)}).join();break;case 1:h="Greater than "+H(Gg(f.DC)[0].lq().getValue(),3);break;case 7:h=Gg(f.DC);h="Between "+(H(h[0].lq().getValue(),3)+(" and "+H(h[1].lq().getValue(),3)));break;case 5:h=Gg(f.DC),h="Equal to "+H(h[0].lq().getValue(),3)}k=mjf;f.BC=W(Eif,{description:h,cXb:f.rW});f.qK=new hz("",c);f.qK.mf(8,!0);f.qK.Va(f.BC);Dw(f.BC,"describedby",k.Zwa);this.ea.Fa(f.qK);c.appendChild(d,f.BC);this.Ic.listen(f.qK,"action",function(l){return function(){sjf(b,l.qK,l.DC,l.rW,l.SP)}}(f)).listen(f.BC,
"mouseenter",function(l){return function(){FY(b.hc,ym(l.g4))}}(f)).listen(f.BC,"mouseleave",function(){kP(b.hc)}).listen(f.BC,"focus",function(l){return function(){Cv(l.BC,d)}}(f))}};
function sjf(a,b,c,d,e){var f=Iw(b.La(),"waffle-dv-rec-chip-selected");a.ea.Pe(function(h){h.Yi("waffle-dv-rec-chip-selected",!1);h.fc(!1)});b.Yi("waffle-dv-rec-chip-selected",!f);b.fc(!f);a.Ib=!0;f?(a.show(!0),a.R=null,a.$a=null,a.Cb=-1):(b=new Ig,Kg(b,c),kjf(a.H,b,null,null,!0),bjf(a.H),a.F.setValue(d),a.R=c,a.$a=d,a.Cb=e);a.Ib=!1}r.mLb=function(a){if("save"==a.key){if(!tjf(this)){a.preventDefault();return}}else if("clear"==a.key&&!ujf(this)){a.preventDefault();return}this.F&&this.F.Ma(!1)};
function qjf(a){var b=vjf(a.C);b&&a.L.setContent(b);a.L.setVisible(0!=a.C);b=2==a.C||4==a.C;var c=a.oa().Ov(a.F.getElement());Mw(c,"waffle-input-error",b);b&&CV(a.F).select()}
function vjf(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date";case 8:return"Please enter a valid ticked value.";case 9:return"Enter different values for ticked and unticked cell contents.";case 10:return"Formulas are not permitted as custom ticked/unticked values."}return null}
function wjf(a){var b=a.H,c=A5(b);if(0==c){c=b.L;var d=b.ea,e=cjf(b,c),f=cjf(b,d);e&&f?b.D.C=0:(e||z5(c),f||z5(d),b.D.C=1)}else if(1==c)c=b.O,d=b.xa,e=!Lv(c)||!Bd(ef(c.value)),f=!Lv(d)||!Bd(ef(d.value)),e&&f?b.D.C=0:(e||z5(c),f||z5(d),b.D.C=6);else if(2==c)c=b.H,d=b.R,e=!Lv(c)||!Bd(ef(c.value)),f=!Lv(d)||!Bd(ef(d.value)),e&&f?b.D.C=0:(e||z5(c),f||z5(d),b.D.C=7);else if(3==c||4==c)c=0,4==A5(b)?(d=ijf(b),pXd(b.Cb,d)?(d=ijf(b),d=AY(b.Cb,d),e=djf(b.D),null!=d&&null!=e&&d.C==e.C&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==A5(b)&&b.C.getElement()&&Bd(ef(b.C.getValue()))&&(c=5),d=c,c=0==d,b.D.C=d,d=b.Xa&&Lv(b.Xa),b.Ta&&Lv(b.Ta)?(Mw(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.oa().Ov(b.Ha.getElement()),Mw(d,"waffle-input-error",!c),b.Ha.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error");else if(6==c){if(b.Na.isChecked()){c=b.Ka;e=b.Pa;d=Cd(ef(c.value));e=Cd(ef(e.value));f="true"==d.toLowerCase()&&"true"==e.toLowerCase()||"false"==d.toLowerCase()&&"false"==e.toLowerCase();
var h=mf(d)==mf(e);f=d==e||h||f;Bd(d)?(z5(c),b.D.C=8):f?b.D.C=9:rE(d)||rE(e)?b.D.C=10:b.D.C=0}}else b.D.C=0;b=a.F.getValue();b=pXd(a.V,b);2==a.C&&b?a.C=0:0!=a.C||b||(a.C=2);qjf(a);return 0!=a.C}
function xjf(a){switch(a){case 1:return 35283;case 2:return 35284;case 3:return 35285;case 4:return 35286;case 5:return 35282;case 6:return 35291;case 7:return 35271;case 8:return 35289;case 9:return 35272;case 10:return 35290;case 13:return 35292;case 14:return 35293;case 15:return 35294;case 16:return 35277;case 17:return 35275;case 18:return 35274;case 19:return 35280;case 20:return 35279;case 21:return 35276;case 22:return 35278;case 30:return 35281;case 23:return 35287;case 24:return 35288;case 31:return 35358;
case 29:return 35273}return null}
function tjf(a){if(wjf(a))return!1;var b=a.H,c=b.Ib.isChecked("rejectInvalidData_radio"),d=Yif(b);b.Qa.isChecked()||(d="");var e=hjf(b);if(!e)return!1;var f=new Mo;I(f,1,e);I(f,2,d);I(f,3,c);AWd(f,Lv(b.Tb)&&b.Ya.isChecked());b=yjf(a);if(!b)return!1;d=new hj;e=Jg(e);var h=a.R&&Fg(a.R)==Fg(e);c=Gg(e);if(h){var k=zjf(a,Ghf(a.V,a.$a)),l=Ajf(a);k=Am(k,b);L(d,12,!l||!k);var m=new Ihf;L(m,1,!k);L(m,2,!l);L(m,3,a.Cb);Ti(d,17,dna[0],m)}else{for(var p=m=k=l=!1,q=!1,u=0;u<a.rc.length;u++){var w=zjf(a,Ghf(a.V,
a.rc[u]));if(w){var y=Am(w,b);w=vva(w,b);var E=a.Ac[u],O=Fg(E)==Fg(e);E=Gg(E);E=sd(E,c,function(S,T){return S.equals(T)});q=q||E;l=l||y&&O&&E;k=k||y;m=m||y&&O;p=p||w}}u=new Jhf;L(u,1,l);L(u,2,k);L(u,3,m);L(u,4,p);L(u,5,q);Ti(d,18,dna[0],u)}uWd(d,H4d(Fg(e)));l=ka(a.Ac);for(k=l.next();!k.done;k=l.next())Ehf(d,H4d(Fg(k.value)));l=Ma()-a.Kd;L(d,14,l);l=new cj;Si(l,58,d);d=gy(hy(new fy,l),1).build();a.Qa.C(h?35578:35301,d);h=xjf(Fg(e));null!=h&&a.Qa.C(h);31==Fg(e)&&a.Qa.C(0<c.length?35604:35603,d);a.Rc.C(new k5d(f,
b));return!0}function Ajf(a){var b=hjf(a.H);if(!b||!a.R)return!1;b=Gg(Jg(b));a=Gg(a.R);return sd(a,b,function(c,d){return c.lq().getValue().equals(d.lq().getValue())})}
function ujf(a){var b=yjf(a);if(!b)return!1;try{if(!hjf(a.H))return a.Qa.C(35300),!0;var c=Jg(hjf(a.H)),d=a.R&&Fg(a.R)==Fg(c),e=!1,f=new hj;if(d){var h=fTb(NK(a.Ya).Wo().wc(),Ghf(a.V,a.F.getValue()));Ok(h,function(p){rJ(p)&&(e=!0);return e});if(!e){var k=new Jhf;L(k,6,!0);Ti(f,18,dna[0],k)}}var l=new cj;Si(l,58,f);var m=gy(hy(new fy,l),1).build();a.Qa.C(35300,m);return!0}finally{a.Rc.C(new k5d(new Mo,b))}}function yjf(a){var b=Ghf(a.V,a.F.getValue());return zjf(a,b)}
function zjf(a,b){var c=a.F.getValue();a=(a=AY(a.V,c))?a.C:null;return b&&null!=a?tm(b,a):null}function djf(a){var b=a.F.getValue();return AY(a.V,b)}function Qif(a,b){var c=a.xb.C.$d();a=new BV(a.Ya,v(a.jLb,a),!1,"e.g. Sheet1!A2:D5",!0,c,a.oa());a.render(b);return a}r.setVisible=function(a){qA.prototype.setVisible.call(this,a);a&&this.eb&&(this.eb.focus(),this.eb=null)};r.jLb=function(a,b,c,d){this.eb=CV(a);this.Zd.sf(this,a,b,c,!1,!0,d)};
r.show=function(a){var b="",c=!1,d=gJ(this.xb),e=rJ(kJ(d,KJ(d)));d=null;var f=!1;e&&(e=e.C,d=H(e,1),b=H(e,2),c=H(e,3),f=H(e,4));kjf(this.H,d,b,c,f);(b=hjf(this.H))&&Jg(b);this.setVisible(!0);this.F&&this.F.Ma(!0);njf(this);bjf(this.H);pjf(this,a);this.Kd=Ma()};
function pjf(a,b){a.Ha&&!b&&(YVd(a.Ta)?(a.qe.setActive(!0),N(a.Xa.La(),!0),a.ea.hd(!0),a.Ic.Ec(),zXd(a.Ta),b=djf(a),null==b||bm(b.rect)||b.rect.equals(a.Xd)?rYd(a.Ta,!0,!1,[6]):JXd(a.Ta,!0,!1,!1,[6],[djf(a).rect])):(a.qe.setActive(!1),N(a.Xa.La(),!1),rjf(a)))}r.Ia=function(){F(this.H);this.H=null;F(this.F);this.O=this.xa=this.F=null;F(this.L);qA.prototype.Ia.call(this)};var mjf={Zwa:"waffle-dv-recs-title"};function C5(a,b){wy.call(this,b,new Bjf(a))}x(C5,wy);r=C5.prototype;r.Gf=function(a,b,c){C5.Oa.Gf.call(this,a,b,c);a.Db()&&this.Db()&&a.getParent()==this&&Cjf(this)};r.Ga=function(){C5.Oa.Ga.call(this);Cjf(this)};r.Dc=function(a){C5.Oa.Dc.call(this,a);Cjf(this)};r.removeChild=function(a,b){a=C5.Oa.removeChild.call(this,a,b);Cjf(this);return a};r.$l=function(a,b){a=C5.Oa.$l.call(this,a,b);Cjf(this);return a};
r.Re=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=Qx(this);if(c){b=39==b;this.Fe()&&(b=!b);c=c.getElement();c=Oc(c.parentNode.childNodes,c);var d=(d=(d=Qx(this))?F_a(d.getElement(),Djf):null)?Oc(d.parentNode.childNodes,d):-1;var e=d==(this.getElement()?this.getElement().childNodes.length:0)-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=Ejf(this,e);b?b=Ejf(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.vda(this.Xs()+b);b=!0}else b=!1}b=!b}return b?
C5.Oa.Re.call(this,a):!0};function Ejf(a,b){return 0==(a.getElement()?a.getElement().childNodes.length:0)?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function Cjf(a){var b,c=a.Ad(),d=a.Mc(),e=jd(Qt("div",Djf,a.getElement())),f=a.getElement();for(b=e.length;b<c.D&&b<d;b++)e[b]=a.oa().Aa("DIV",Djf),f.appendChild(e[b]);f=e.length;c=Array(f);d=[];b=0;for(var h=!1,k=0;k<a.Mc();k++)a.Hc(k)instanceof vy?(d.push(new Fjf(b,k,!0)),b=k+1):a.Hc(k)instanceof py&&(0==k?h=!0:(a.Hc(k-1),d.push(new Fjf(b,k-1,!1)),b=k));k=a.Mc();0<d.length&&Nc(d).end!=k-1&&d.push(new Fjf(b,k-1,!1));b=h;h=a.Mc();if(0==d.length&&b)c[0]=h;else{b=d.length-Math.max(0,d.length-f);b=a.Mc()-
b;b=Math.ceil(b/f);if(0==d.length)for(h=0;h<f;h++)c[h]=(h+1)*b-1;else Gjf(d,b,f);f=d.length;for(b=0;b<f;b++)c[b]=d[b].end}for(f=d=0;f<a.Mc();f++){for(;f>c[d];)++d;b=a.Hc(f);h=b.getElement();h.parentNode!=e[d]&&e[d].appendChild(h);f==c[d]&&b instanceof vy?N(h,!1):N(h,!0)}for(a=e.length-1;a>d;--a)e[a].parentNode.removeChild(e[a]),e[a]=null}
function Gjf(a,b,c){function d(p){return p.end-p.start-(p.qBb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;fd(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,fd(a,l,1))}}function Fjf(a,b,c){this.start=a;this.end=b;this.qBb=c}function Bjf(a){uy.call(this);this.D=a}x(Bjf,uy);var Djf="docs-multi-menu-col";function Hjf(a){D.call(this);this.C=a}t(Hjf,D);Hjf.prototype.create=function(){return new C5(this.C)};function Ijf(a,b){v5.call(this,a);this.ea=new P;this.H=new Jjf;this.F=new P;a=(new Hjf(3)).create();a.Fa(new py("Date"),!0);a.Fa(new ry("Day","DAY_TOKEN"),!0);a.Fa(new ry("Month","MONTH_TOKEN"),!0);a.Fa(new ry("Year","YEAR_TOKEN"),!0);a.Fa(new py("Time:"),!0);a.Fa(new ry("Hours","HOURS_TOKEN"),!0);a.Fa(new ry("Minutes","MINUTES_TOKEN"),!0);a.Fa(new ry("Seconds","SECONDS_TOKEN"),!0);a.Fa(new ry("Milliseconds","MILLIS_TOKEN"),!0);a.Fa(new ry("a.m./p.m.","AM_PM_TOKEN"),!0);a.Fa(new py("Duration"),!0);
a.Fa(new ry("Elapsed hours","ELAPSED_HOURS_TOKEN"),!0);a.Fa(new ry("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Fa(new ry("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new Otc(a);this.C=b}t(Ijf,v5);r=Ijf.prototype;r.Aa=function(){var a=W(sif,{f0:Vv(this,"nfd-icwr"),UK:Vv(this,"nfd-a")});this.wb(a)};
r.Ga=function(){v5.prototype.Ga.call(this);V(this.getElement(),"nfd-date-time-input");var a=Xv(this,"nfd-icwr"),b=this.ea;b.Va(a);b.Sd(this);b.Fa(this.L,!0);V(this.L.getElement(),"nfd-date-time-menu-button");V(this.L.Sb().getElement(),"nfd-date-time-menu");Gw(this.L.La(),"Add a date or time format");b.Fa(this.H,!0);C.ud||V(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Fa(a,!0);uv(a.getElement(),"display","inline");this.getHandler().listen(this,"Qh",La(this.iNa,"left")).listen(this,"Uh",
La(this.QHa,"left")).listen(this,"Vh",La(this.QHa,"right")).listen(this,"Wh",La(this.PIa,"left")).listen(this,"Xh",La(this.PIa,"right")).listen(this,"Th",La(this.iNa,"right")).listen(this.L,"action",this.Jib)};r.nCa=function(){this.ea.getElement().focus()};
r.oP=function(a){this.Pb(a.clone());var b=this.F;b.hd(!0);tu(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.Ul());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?tu(this.H.getElement(),d[2]):(e=b.Hc(b.Mc()-1),d=d[2],tu(e.gC.getElement(),wu(e.gC.getElement())+d)):Kjf(this,e).setValue(d[1])}0<b.Mc()&&b.Hc(b.Mc()-1).Jz.getElement().focus()};
r.getValue=function(){for(var a=this.H.toString(),b=0;b<this.F.Mc();b++)a+=this.F.Hc(b).toString();a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a);b="";for(var c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=aga(e,"["),e=aga(e,"]")):c=!0}b+=e}return b};r.Jib=function(a){a=a.target.getValue();Kjf(this,a).Jz.getElement().focus()};
function Kjf(a,b){jif(a,!1);switch(b){case "DAY_TOKEN":var c=Ljf(a);break;case "MONTH_TOKEN":c=Mjf(a);break;case "YEAR_TOKEN":c=Njf(a);break;case "HOURS_TOKEN":c=Ojf();break;case "MINUTES_TOKEN":c=Pjf();break;case "SECONDS_TOKEN":c=Qjf();break;case "MILLIS_TOKEN":c=Rjf();break;case "AM_PM_TOKEN":c=Sjf(a);break;case "ELAPSED_HOURS_TOKEN":c=Tjf();break;case "ELAPSED_MINUTES_TOKEN":c=Ujf();break;case "ELAPSED_SECONDS_TOKEN":c=Vjf()}b=c;b.Fa(new vy,!0);b.Fa(new ry("Delete"),!0);c=new Wjf(c,"");a.F.Fa(c,
!0);return c}r.iNa=function(a,b){b=b.target;if(b instanceof Jjf){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.Hc(Yv(this.F,b)+1),!b))return}a=wu(b.gC.getElement());var c=b.getParent(),d=Yv(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=wu(b),tu(b,c+a),Xjf(this.H,c.length)):(d--,b=c.Hc(d),c=wu(b.gC.getElement()),tu(b.gC.getElement(),wu(b.gC.getElement())+a),Xjf(b.gC,c.length))};
r.PIa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.Hc(Yv(this.F,b)+a))&&a.Jz.getElement().focus()};r.QHa=function(a,b){var c="left"==a?-1:0;(b=this.F.Hc(Yv(this.F,b.target)+c))||"left"!=a?b&&(b=b.gC):b=this.H;c=wu(b.getElement()).length;Xjf(b,"left"==a?c:0)};
function Ljf(a){function b(f){return"Day ("+(f+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,e),"Day without leading zero ("+(e+")"),d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,e),"Day with leading zero ("+(e+")"),d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,e),"Day as abbreviation ("+(e+")"),d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,
e),"Day as full name ("+(e+")"),d));a=new wy;for(d=0;d<c.length;d++)a.Fa(c[d],!0);return a}
function Mjf(a){function b(f){return"Month ("+(f+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,e),"Month without leading zero ("+(e+")"),d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,e),"Month with leading zero ("+(e+")"),d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,e),"Month as abbreviation ("+(e+")"),d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,
e),"Month as full name ("+(e+")"),d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,e),"First letter of the month ("+(e+")"),d));a=new wy;for(d=0;d<c.length;d++)a.Fa(c[d],!0);return a}
function Njf(a){function b(f){return"Year ("+(f+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,e),"Two-digit year ("+(e+")"),d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,e),"Full numeric year ("+(e+")"),d));a=new wy;for(d=0;d<c.length;d++)a.Fa(c[d],!0);return a}
function Ojf(){function a(e){return"Hour ("+(e+")")}var b=[],c="1";b.push(new x5(La(a,c),"Hour without leading zero ("+(c+")"),"h"));c="01";b.push(new x5(La(a,c),"Hour with leading zero ("+(c+")"),"hh"));c=new wy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function Pjf(){function a(e){return"Minute ("+(e+")")}var b=[],c="1";b.push(new x5(La(a,c),"Minute without leading zero ("+(c+")"),"m"));c="01";b.push(new x5(La(a,c),"Minute with leading zero ("+(c+")"),"mm"));c=new wy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function Qjf(){function a(e){return"Second ("+(e+")")}var b=[],c="1";b.push(new x5(La(a,c),"Second without leading zero ("+(c+")"),"s"));c="01";b.push(new x5(La(a,c),"Second with leading zero ("+(c+")"),"ss"));c=new wy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function Rjf(){function a(e){return"Milliseconds ("+(e+")")}var b=[],c="1";b.push(new x5(La(a,c),"Precision to 1/10 of a second ("+(c+")"),"0"));c="01";b.push(new x5(La(a,c),"Precision to 1/100 of a second ("+(c+")"),"00"));c="001";b.push(new x5(La(a,c),"Precision to 1/1000 of a second ("+(c+")"),"000"));c=new wy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function Sjf(a){function b(f){return"a.m./p.m. ("+(f+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,e),"Full ("+(e+")"),d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,e),"Shortened lowercase ("+(e+")"),d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);c.push(new x5(La(b,e),"Shortened uppercase ("+(e+")"),d));a=new wy;for(d=0;d<c.length;d++)a.Fa(c[d],!0);return a}
function Tjf(){function a(e){return"Elapsed hours ("+(e+")")}var b=[],c="1";b.push(new x5(La(a,c),"Elapsed hours without leading zero ("+(c+")"),"[h]"));c="01";b.push(new x5(La(a,c),"Elapsed hours with leading zero ("+(c+")"),"[hh]"));c=new wy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function Ujf(){function a(e){return"Elapsed minutes ("+(e+")")}var b=[],c="1";b.push(new x5(La(a,c),"Elapsed minutes without leading zero ("+(c+")"),"[m]"));c="01";b.push(new x5(La(a,c),"Elapsed minutes with leading zero ("+(c+")"),"[mm]"));c=new wy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}
function Vjf(){function a(e){return"Elapsed seconds ("+(e+")")}var b=[],c="1";b.push(new x5(La(a,c),"Elapsed seconds without leading zero ("+(c+")"),"[s]"));c="01";b.push(new x5(La(a,c),"Elapsed seconds with leading zero ("+(c+")"),"[ss]"));c=new wy;for(var d=0;d<b.length;d++)c.Fa(b[d],!0);return c}function Wjf(a,b){P.call(this);this.Jz=new VQ("",a);this.Fa(this.Jz,!0);this.gC=new Jjf(b);this.Fa(this.gC,!0)}t(Wjf,P);r=Wjf.prototype;
r.Ga=function(){P.prototype.Ga.call(this);V(this.getElement(),"nfd-date-time-pill");uv(this.getElement(),"display","inline-block");this.Jz.Ye(0);this.Rd=new Cx(this.Jz.getElement());this.qa(this.Rd);this.getHandler().listen(this.Jz,"action",this.NLb).listen(this.Rd,"key",this.OLb)};r.NLb=function(){this.Jz.PP();this.Jz.zf().Ra()||this.dispatchEvent("Th")};
r.OLb=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("Th"));break;case 37:a.preventDefault();this.dispatchEvent("Uh");break;case 39:a.preventDefault(),this.dispatchEvent("Vh")}};r.toString=function(){return this.Jz.zf().Ra()+this.gC.toString()};r.setValue=function(a){this.Jz.setValue(a)};function Jjf(a){P.call(this);this.jf=a||""}t(Jjf,P);r=Jjf.prototype;
r.Aa=function(){var a=Wt("SPAN");Tt(a,{contentEditable:!0});tu(a,this.jf);var b=a.style;C.Hb&&!C.Wc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=C.ud?"-moz-pre-wrap":"pre-wrap";this.wb(a)};r.Ga=function(){P.prototype.Ga.call(this);var a=new Cx(this.getElement());this.qa(a);this.getHandler().listen(a,"key",this.PLb).listen(this.getElement(),"paste",this.QLb)};
function Xjf(a,b){if(0==wu(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=LO(c,b);a.getElement().focus();b.select()}}
r.PLb=function(a){var b=vu(this.getElement()),c=FO(),d=wu(this.getElement()).length,e=c?0==c.Al()&&0==c.oo():Bd(ef(b));b=c?c.Al()==d&&c.oo()==d:Bd(ef(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("Qh"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("Th"));break;case 40:this.dispatchEvent("Rh");break;case 38:this.dispatchEvent("Sh");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("Wh"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("Xh"));break;
case 13:a.preventDefault()}};r.toString=function(){var a=Nfa(wu(this.getElement())).replace(/"/g,'"\\""');return 0==ef(a).length?"":'"'+a+'"'};r.QLb=function(){var a=v(function(){tu(this.getElement(),wu(this.getElement()))},this);vn(a)};function Yjf(a){w5.call(this,a);this.setTitle("Custom date and time formats")}t(Yjf,w5);r=Yjf.prototype;r.tTa=n(!1);r.wZ=n(11175.5628472222);r.isEmpty=function(){return Bd(cg(this.u1(),2))};r.wf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(cg(this.u1(),2))};r.Vha=function(){return new Ijf("Custom date time format",11175.5628472222)};r.u1=function(){return Zjf(this.input.getValue())};
r.b8=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.wZ(),c.Ul());c.D=d}b=$jf(this);nd(b);for(c=0;c<b.length;c++)a.push(new nW(Zjf(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.wZ(),b[c])));return a};
function $jf(a){var b=PA,c=Sc(b.DATEFORMATS,function(h){return akf(h)},a),d=Sc(b.TIMEFORMATS,function(h){return akf(h)},a),e=c.concat(d);b=b.DATETIMEFORMATS;nd(b);a=Sc(b,function(h){return akf(h)},a);for(b=0;b<a.length;b++){var f=a[b];f=f.replace(/\{1\}/,c[0]);f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function akf(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Cd(a.join(""))}function Zjf(a){var b=new mg;b.setType(7);I(b,3,1);I(b,2,a);return b};function bkf(){var a='<div class="'+U("waffle-sdsd-source-container")+'"><div class="'+U("waffle-sdsd-rangepicker-container")+'"><div class="'+U("waffle-sdsd-rangepicker-label")+'">';a=a+'Data range</div><div class="'+(U("waffle-sdsd-range-selection")+'"></div><div style="display: none;" class="'+U("waffle-sdsd-rangepicker-error-label")+'"></div></div></div><div class="'+U("waffle-sdsd-destination-radio-container")+'"><div id="insertOptionHeader" class="'+U("waffle-sdsd-rangepicker-label")+'">');
a=a+'Insert to</div><div class="'+(U("waffle-sdsd-destination-selection")+'" role="radiogroup" aria-labelledby="insertOptionHeader"><div role="presentation"><label><input type="radio" name="destination" value="NEW_SHEET" checked="checked">');a=a+'New sheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="EXISTING_SHEET">Existing sheet</label></div></div></div><div style="display: none;" class="'+(U("waffle-sdsd-destination-container")+'"><div class="'+U("waffle-sdsd-rangepicker-container")+
'"><div class="'+U("waffle-sdsd-range-selection")+'"></div><div style="display: none;" class="'+U("waffle-sdsd-rangepicker-error-label")+'"></div></div></div>');return R(a)};function ckf(a,b,c,d,e,f,h,k){WT.call(this,void 0,k,!0,B(A(),"docs-egmd"));this.ye=c;this.xa=d;this.V=e;this.ea=h;this.R=new X7d;this.L=a;this.Fa(this.L);this.H=b;this.Fa(this.H);this.O=null;this.setTitle(f);cx(this,!1)}t(ckf,WT);r=ckf.prototype;
r.Aa=function(){WT.prototype.Aa.call(this);V(this.La(),"waffle-source-destination-selection-dialog");var a=this.Eb(),b=this.oa(),c=W(bkf);b.appendChild(a,c);this.C.setContent("Create");c=b.Ea("waffle-sdsd-range-selection",dkf(this));ekf(this.L,c);c=b.Ea("waffle-sdsd-range-selection",fkf(this));ekf(this.H,c);Y7d(this.R,"destination",a);b.Ea("waffle-sdsd-rangepicker-label",this.Eb()).id="waffle-sdsd-rangepicker-label-id"};
r.Ga=function(){WT.prototype.Ga.call(this);this.ea&&this.L.setValue(this.ea);this.getHandler().listen(this,"pd",this.ELb).listen(this.R,"Nd Od Pd Qd action select".split(" "),this.FLb).listen(this.H,"change",this.tGa).listen(this.L,"change",this.OIa).listen(this.H,"activate",this.cHa).listen(this.L,"activate",this.cHa);an(Zw(this),"click",this.V)};r.cHa=function(a){this.O=a.target.wba()};r.tGa=function(){gkf(this,fkf(this),this.H.U3("Please enter a valid destination."));this.H.focus()};
r.ELb=function(){this.xa();this.V()};r.OIa=function(){gkf(this,dkf(this),this.L.U3("Please enter a valid range."));this.L.focus()};function hkf(a){return"EXISTING_SHEET"===a8d(a.R)}function gkf(a,b,c){var d=!!c;a=a.oa().Ea("waffle-sdsd-rangepicker-error-label",b);N(a,d);d&&(tu(a,c),tK(c))}function dkf(a){return a.oa().Ea("waffle-sdsd-source-container",a.Eb())}function fkf(a){return a.oa().Ea("waffle-sdsd-destination-container",a.Eb())}
r.qB=function(){hkf(this)&&this.tGa();this.OIa();if(!(this.L.U3("error")||hkf(this)&&this.H.U3("error"))){var a=this.L.Nka(),b=this.H.Nka();WT.prototype.qB.call(this);this.ye(a,b?new UG(b.C,b.rect.top,b.rect.left):void 0);this.dispose();this.V()}};r.FLb=function(){var a=hkf(this);N(fkf(this),a);a&&(a=this.H.wba())&&a.focus()};function ekf(a,b){a.render(b);(a=a.wba())&&Dw(a,"labelledby","waffle-sdsd-rangepicker-label-id")}r.show=function(){this.setVisible(!0)};
r.setVisible=function(a){WT.prototype.setVisible.call(this,a);a&&this.O&&(this.O.focus(),this.O=null)};function ikf(){P.apply(this,arguments)}t(ikf,P);function jkf(a,b,c,d,e){ikf.call(this,e);this.F=a;this.D=c;this.C=new BV(b,v(this.DLb,this),d,d?"e.g. Sheet1!F10":"eg. Sheet1!A1:D100",!0,void 0,this.oa(),Ytd.getInstance());this.C.ea=!1;this.Fa(this.C,!0)}t(jkf,ikf);r=jkf.prototype;r.wba=function(){return CV(this.C)};r.getValue=function(){return this.C.getValue()};r.setValue=function(a){this.C.setValue(a)};
r.Nka=function(){return xN(this.getValue(),this.F.C,!1,!0)};r.U3=function(a){var b=this.getValue();if(!b)return a;b=Iac(b,this.F.C,!1,!0);return b instanceof lm?null:"range-datasource-sheet"===b?"Range can't reference connected sheets.":a};r.focus=function(){this.C.focus()};r.DLb=function(a,b,c,d){this.dispatchEvent("activate");c&&this.D.setTitle("What location?");var e=null;this.getParent()instanceof WT&&(e=this.getParent());this.D.sf(e,a,b,c,!1,!0,d)};function kkf(a,b,c){ikf.call(this,c);this.C=a;this.D=b}t(kkf,ikf);r=kkf.prototype;r.Aa=function(){ikf.prototype.Aa.call(this);this.wb(this.oa().Aa("DIV",{style:"padding: 10px 0"},this.D))};r.wba=function(){return this.getElement()};r.getValue=n("");r.setValue=ba();r.Nka=function(){return new lm(this.C,null)};r.U3=n(null);r.focus=ba();function lkf(a,b,c,d,e){D.call(this);this.H=null;this.C=a;this.D=b;this.J=c;this.O=d;this.F=e;this.L=new hn(this);this.qa(this.L);this.L.listen(a,"replaceall",this.kvb).listen(a,"replace",this.lvb).listen(a,"findnext",this.bNa).listen(a,"done",this.Ojb)}t(lkf,D);r=lkf.prototype;r.y0b=function(){this.C.setVisible(!0);mkf(this,null)};r.bNa=function(a){if(OK(this.D)){var b=NK(this.D).Ra(),c=this.H;if(!c){c=KJ(b);var d={};c=(d.cg=b.kc(),d.cr=b.uZ(c.y),d.cc=b.uD(c.x),d)}nkf(this,a,b,c)}};
function nkf(a,b,c,d){var e=new qk,f=okf(b);pkf(f,c,d);a.F.Zb.dispatchEvent(null);c=e.serialize(f);d=v(function(h){var k=e.Sc(GDb.va(),h);h=H(f,1);var l=b.type;if(OK(this.D))if(k)if(Wf(k,1)){l=H(k,1);var m={};k=(m.cg=l.Bb(),m.cr=l.xk(),m.cc=l.getColumnIndex(),m.loop=H(k,2),m);qkf(this,h,k)}else qkf(this,h,{}),"replace"==l&&this.C.focus();else rkf(this)},a);ritz_api.RitzModelApi.findNext(c,d);I(f,14,1);a.F.Tb.dispatchEvent(new Nhf("find-next-occurrence",f))}
function pkf(a,b,c){if(c){var d=c.cg,e=new Ph;I(e,1,d);I(e,2,Fhf(b,c.cr,"r"));I(e,3,Fhf(b,c.cc,"c"));I(a,10,e)}}function okf(a){var b=new IF;I(b,1,a.D);I(b,3,a.F);I(b,5,a.C);if(0==a.C||1==a.C){var c=a.O,d=new vg;I(d,1,c.C);var e=c.rect.Bc();I(d,2,e);wg(d,c.rect.$c());xg(d,c.rect.xc());yg(d,c.rect.cd());b.setSelection(d)}I(b,6,a.H||!1);I(b,7,a.L||!1);I(b,8,a.xa||!1);b.setType(a.Da?1:0);I(b,11,0);return b}
function qkf(a,b,c){c?c&&null!=c.cg?(b=c.cg,c.loop&&s5(a.C,"No more results found, looping around"),a.J.Kz(b,v(a.oLb,a,c))):(mkf(a,null),s5(a.C,"There are no entries matching "+b)):rkf(a)}r.oLb=function(a){var b=NK(this.D).Ra(),c=a.cr,d=a.cc;a.cr=b.uZ(c);a.cc=b.uD(d);mkf(this,a);a=new Bl(d,c);b=new lm(b.kc(),Xl(a));pY(this.J,b,v(this.V_a,this,a))};
r.V_a=function(a){if(!this.isDisposed()){this.C.focus();var b=NK(this.D).Ra();pJ(b.Pg(a.y,a.x))&&!this.C.H.isChecked()&&Whf(this.C,!1,"Can't replace formula");var c=b.Zs(a.y),d=b.YA(a.x);!c||!d||c.isVisible()&&d.isVisible()||(c=this.C,d=yN(a),a=kJ(b,a).getDisplayValue(),s5(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function rkf(a){s5(a.C,null);s5(a.C,"Error while searching spreadsheet. Please try again.")}
r.lvb=function(a){if(!this.F.Jd()){var b=this.H;if(b){var c=XI(this.J,b.cg);if(c){var d=c.wc(),e=Fhf(d,b.cr,"r"),f=Fhf(d,b.cc,"c");c=d.Pg(e,f);if(!pJ(c)||this.C.H.isChecked()){c=c.getDisplayValue();var h=new qk,k=okf(a);I(k,5,0);pkf(k,d,b);d=new vg;I(d,1,b.cg);I(d,2,e);wg(d,e+1);xg(d,f);yg(d,f+1);k.setSelection(d);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);skf(this,k,c,b,!1);this.F.Tb.dispatchEvent(new Nhf("replace-current-occurrence",k));this.bNa(a)}}}}};
r.kvb=function(a){if(!this.F.Jd()&&OK(this.D)){var b=okf(a);skf(this,b,a.D,a.F,!0)}};
function skf(a,b,c,d,e){b=new b8d(b);GK(b,v(function(f,h){f?(f=H(h,5),h=H(h,4),h=0==f?"No matches found":e?(new Qz(1==h?"{NUM_CHANGED,plural, =0{unused plural form}=1{Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other{Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS,plural, =0{unused plural form}=1{unused plural form}other{Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:f,NUM_SHEETS:h,ORIGINAL_VALUE:c,
NEW_VALUE:d}):'Replaced "'+(c+('" with "'+(d+'"'))),s5(this.C,null),s5(this.C,h)):rkf(this)},a));s5(a.C,null);s5(a.C,"Working...");a.O.C(b)}r.Ojb=function(){mkf(this,null)};function mkf(a,b){a.H=b;(a=a.C)&&Whf(a,null!=b)};function tkf(a,b){WT.call(this);this.setTitle("Grouping rule");this.V=a;this.R=new P;this.Fa(this.R,!0);this.H=new ukf("Minimum value","e.g. 0",!0);this.R.Fa(this.H,!0);this.O=new ukf("Maximum value","e.g. 100",!0);this.R.Fa(this.O,!0);this.L=new ukf("Interval size","e.g. 10",!1);this.Fa(this.L,!0);a=b.tj();null!=a&&this.H.D.setValue(aQ.format(a));a=b.$s();null!=a&&this.L.D.setValue(aQ.format(a));b=b.So();null!=b&&this.O.D.setValue(aQ.format(b))}t(tkf,WT);
tkf.prototype.qB=function(){var a=vkf(this.H),b=vkf(this.L),c=vkf(this.O);if(isNaN(a)||isNaN(b)||isNaN(c))var d=!1;else 0>=b?(wkf(this.L,"Must be greater than 0"),d=!1):null!=a&&null!=c&&a>=c?(wkf(this.H,"Value too large"),d=!1):d=!0;d&&(this.V.Fb(new MDd(a,b,c)),WT.prototype.qB.call(this))};
function ukf(a,b,c,d){P.call(this,d);this.L=a;this.O=b;this.R=c;this.J=new P;this.Fa(this.J,!0);this.D=new BZ;this.Fa(this.D,!0);this.H=null;this.C=new P;this.Fa(this.C,!0);this.F=new XV(this.oa(),!0,!0);this.qa(this.F)}t(ukf,P);
ukf.prototype.Ga=function(){P.prototype.Ga.call(this);this.La().className="waffle-pivot-histogram-errorable-input";this.J.La().className="waffle-pivot-histogram-dialog-caption";this.oa().pe(this.J.getElement(),this.L);this.H=this.D.Ad().iO(this.D.La());this.H.placeholder=this.O;Gw(this.H,this.L+" - "+this.O);$V(this.F,this.H);this.C.La().className="waffle-pivot-histogram-dialog-error";Cw(this.C.La(),"alert");Dw(this.C.La(),"live","polite");xkf(this)};
function vkf(a){xkf(a);var b=a.D.getValue();if(Bd(b)){if(a.R)return null;wkf(a,"Required");return NaN}b=aQ.parse(b);isNaN(b)&&wkf(a,"Must be a number");return b}function wkf(a,b){a.C.La().style.visibility="";a.oa().pe(a.C.La(),b);YV(a.F,b,!1)}function xkf(a){a.C.La().style.visibility="hidden";ZV(a.F)};function ykf(a,b){this.D=a;this.C=b}ykf.prototype.getUrl=g("D");ykf.prototype.getTitle=g("C");function zkf(a,b,c,d,e,f){$bb.call(this,a,b,"domain",d,e,f);this.F=c}x(zkf,$bb);zkf.prototype.oX=function(){var a=zkf.Oa.oX.call(this);a.domainName=this.F;return Jd(a,O6a)};bcb.set("domain",function(a){return new zkf(a.name,a.id,a.domainName,a.me,a.iconUrl,a.requiresKey)});new zkf("","DEFAULT","",!0);function Akf(){};function D5(a,b,c,d){this.mda=a;this.D=b;this.C=c;this.gCb=d;this.F=Bkf++}var Bkf=0;D5.prototype.ej=g("F");D5.prototype.getName=g("D");D5.prototype.getLabel=g("C");function Ckf(a){var b=a.dZb,c="";a=a.pSa;for(var d=a.length,e=0;e<d;e++){var f=a[e],h=b[f.ej()],k=f.getLabel();f=f.gCb;f=R('<div id="'+U(h)+'" tabindex="0" role="link" class="'+U("ess-button")+'" aria-label="'+U(k)+'"><div class="'+U("ess-icon")+" "+U(f)+'"></div></div>');c+=f}return R(c)};function Dkf(a,b){P.call(this,b);this.D=a||[];this.F=[];this.C=null}t(Dkf,P);r=Dkf.prototype;r.Ma=function(a,b){this.Md=a;this.nga=b;if(this.GAa){b=this.oa();for(var c=0,d;d=this.D[c];c++){var e=b.getElement(this.WQ.Zsa+"-"+d.ej()),f=a;Mw(e,"ess-button",f);Mw(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();Gy(e,f,d)}}};
r.Aa=function(){this.wb(this.bb.createElement("SPAN"));var a={};a.Zsa=Vv(this,"service");a.pSa=this.D;this.WQ=a;for(var b={},c=0,d;d=this.D[c];c++)b[d.ej()]=this.WQ.Zsa+"-"+d.ej();a.dZb=b;this.WQ=a;ux(this.getElement(),Ckf,this.WQ);this.GAa=!0};
r.ZWb=function(a){if(this.Md){if(this.C){var b={};b.externalSharingService=a.mda;this.C.C(9,b)}if(this.nga)this.dispatchEvent(new Ekf(new Fkf(a,this.F,this.C||void 0)));else{var c=this.C||void 0;b=a.getUrl(this.F);if(c){var d={};d.externalSharingService=a.mda;c.C(10,d)}a={KEc:!0};a.target=a.target||b.target||"google_popup";a.width=a.width||690;a.height=a.height||500;(a=dw(b,a))&&a.focus()}}};
r.Ga=function(){this.Ma(this.Md,this.nga);for(var a=this.oa(),b=this.getHandler(),c=0,d;d=this.D[c];c++){var e=a.getElement(this.WQ.Zsa+"-"+d.ej());b.Df(e,cn,v(this.ZWb,this,d))}};r.Ia=function(){P.prototype.Ia.call(this);delete this.F;delete this.D;this.C=null};r.Md=!0;r.nga=!1;r.WQ=null;r.GAa=!1;function Ekf(a,b){Sm.call(this,"Yh",b);this.context=a}t(Ekf,Sm);function Fkf(){}t(Fkf,Akf);function Gkf(){D5.call(this,"fb","Facebook","Share via Facebook","ess-facebook-icon")}x(Gkf,D5);Gkf.prototype.getUrl=function(a){var b=Sc(a,function(c){return c.getTitle()});a=Sc(a,function(c){return c.getUrl()});return"http://www.facebook.com/share.php?u="+Xe(a.join(","))+"&t="+Xe(b.join(","))};function Hkf(){D5.call(this,"gm","Gmail","Share via Gmail","ess-gmail-icon")}x(Hkf,D5);Hkf.prototype.getUrl=function(a){a=Sc(a,function(b){return b.getTitle()+" - "+b.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Xe(a.join("\n"))};function Ikf(){D5.call(this,"tw","Twitter","Share via Twitter","ess-twitter-icon")}x(Ikf,D5);Ikf.prototype.getUrl=function(a){for(var b=ua(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){f=a[e].getTitle();h=c[e]?" - ":"";var k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Xe(a)};function E5(a){P.call(this,a)}x(E5,P);function Jkf(a){a.dispatchEvent(new Sm("Zh"))}E5.prototype.EZ=function(){return{}};E5.prototype.sM=he;E5.prototype.Tsa=xa;function Kkf(a){P.call(this,a)}x(Kkf,P);Kkf.prototype.F=he;Kkf.prototype.H=xa;Kkf.prototype.J=xa;function Lkf(a,b,c){b=c||b;c=a.XWb;var d=a.YWb,e=a.S4a,f=a.y9a,h=a.vVb,k='<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">';a='Make your content visible to anyone by publishing it to the web. You can link to or embed your document. <a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+(Mhf(a.locale)+'&answer=183965">Learn more</a>');
k=k+a+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link';k+='</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">';k+="Embed";k+='</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+
U(e)+'" readonly="readonly" aria-label="';k+=tw("Link to published document.");k+=" "+U(h)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">';k+="Or share this link using:";k+='</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="';
k+=tw("HTML embed code of published document.");k+=" "+U(h)+'">'+l2a(f)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+Q(gz({id:"pub-dialog-publish-link-button",style:2,value:d},b))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+Q(xA({fn:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"},b));k+="Published content and settings";k+='</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+
Q(gz({id:"pub-dialog-publish-button",value:c},b))+'<div class="pub-dialog-checkbox-container"></div></div></div></div></div>';return R(k)};function F5(a,b,c,d,e,f,h,k,l,m){qA.call(this);this.$a=a||"";this.Kd=b;this.Ic=c;this.Ac=d;this.rc=l||"/publishsettings";this.C=new Mkf(e);this.xb=new Dkf([new Hkf,new Gkf,new Ikf]);this.Fa(this.xb);this.xa=new hz(null,this.oa());this.Fa(this.xa);this.ea=new hz(null,this.oa());this.Fa(this.ea);this.O=new CW(void 0,BW.getInstance(),this.oa());this.Fa(this.O);this.R=new CW(void 0,BW.getInstance(),this.oa());this.Fa(this.R);this.Ta=0;this.Tb=new Nkf;this.Fa(this.Tb);this.eb=this.Cb=null;this.H=f||new E5;
this.Fa(this.H);this.F=h||new E5;this.Fa(this.F);this.Qa=k||new Kkf;this.Fa(this.Qa);this.V=this.L=null;this.Ha=new Ubb(void 0,Okf,this.oa(),2);this.qa(this.Ha);this.Ya=this.Rc=null;this.Xd=m||new P;this.hc=this.Xa=this.Ib=null;this.Mi=!0}x(F5,qA);var Okf="Press "+((C.xf?"\u2318+C":"Ctrl+C")+" to copy.");r=F5.prototype;r.Yc=function(){F5.Oa.Yc.call(this);this.Ha.Yc()};r.show=function(){Pkf(this,v(function(){this.setVisible(!0)},this))};
r.setVisible=function(a){F5.Oa.setVisible.call(this,a);var b=Cu(this.oa());a?this.getHandler().listen(b,"resize",this.Yc):this.getHandler().Gc(b,"resize",this.Yc)};r.Aa=function(){F5.Oa.Aa.call(this);var a=this.oa(),b=W(Lkf,{XWb:Qkf(this),YWb:Rkf(this,Skf(this))?"Published":"Publish",S4a:this.C.ul?Tkf(this,this.H.EZ()):"",y9a:this.C.ul?Ukf(this,this.F.EZ()):"",locale:"en-GB",vVb:Okf});a.appendChild(this.Eb(),b);this.setTitle("Publish to the web");gx(this,null);V(this.Eb(),"pub-dialog-content")};
r.Ga=function(){var a=this.oa(),b=a.getElement("pub-dialog-sharing-services-links");this.xb.render(b);b=a.getElement("pub-dialog-link-options");this.H.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.Ib=a.getElement("pub-dialog-links-notice");this.Xd.render(this.Ib);b=a.getElement("pub-dialog-published-content");this.Qa.render(b);F5.Oa.Ga.call(this);b=this.getHandler();var c=this.Ea("pub-dialog-checkbox-container");this.C.domain&&(this.O.Ae("pub-dialog-dom-signin-req"),this.O.render(c),
this.O.dc(this.C.Zx),this.O.setContent("Require viewers to sign in with their "+(this.C.F+" account")),b.listen(this.O,"change",this.m1b));this.C.C&&(this.R.Ae("pub-dialog-auto-publish-checkbox"),this.R.render(c),this.R.setContent("Automatically republish when changes are made"),b.listen(this.R,"change",this.i1b));this.Cb=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.eb=a.getElement("pub-dialog-embed-tab-content");this.V=a.getElement("pub-dialog-embed-code");
EA(this.Ha,this.L);this.Tb.Va(a.getElement("pub-dialog-links-tab-bar"));this.Rc=a.getElement("pub-dialog-sharing-services");this.Ya=a.getElement("pub-dialog-status-info");this.xa.Va(a.getElement("pub-dialog-publish-link-button"));this.ea.Va(a.getElement("pub-dialog-publish-button"));this.hc=new rO("pub-dialog-settings-header","pub-dialog-settings-content",this.C.ul);this.qa(this.hc);b.listen(this.Tb,"select",this.nwb).listen(this.L,"focus",this.bSa).listen(this.V,"focus",this.bSa).listen(this.ea,
"action",this.$Wb).listen(this.getElement(),"keyup",this.v4a).listen(this.H,"Zh",this.Qua).listen(this.F,"Zh",this.Qua).listen(this.xa,"action",this.gub).listen(this.Qa,"$h",this.hub).listen(this.hc,"toggle",this.Yc);Vkf(this)};
function Vkf(a){if(a.Db()){var b=a.oa(),c=a.C.ul,d=a.C.D;a.Qa.H(a.C.Co);a.O.Ma(!d);a.ea.setContent(Qkf(a));a.ea.Ma(a.C.ul||!a.C.Co||!a.C.Co.isEmpty());a.C.C&&a.R.dc(a.C.By);a.Qua();b=b.Ki("pub-dialog-state-publishing");Pc(b,function(e){N(e,c)});tu(a.Ya,a.C.ul?"This document is published to the web.":"This document is not published to the web.");a.C.ul?V(a.Ya,"pub-dialog-state-published"):Kw(a.Ya,"pub-dialog-state-published");a.Yc()}}r.v4a=function(a){this.isVisible()&&27==a.keyCode&&a.stopPropagation()};
function Wkf(a,b){var c=window.location.href,d=Uk(c);c=Xk(c);var e=Dd(c,"/"+a.Ac+"/")?"/"+a.Ac:"";a.C.Zx&&a.C.domain&&(e="/a/"+a.C.domain+e);c=d[1];var f=d[2],h=d[3];d=d[4];a=a.C.H||a.$a;b=nFa.test(b)?b:Mta("/d/"+a,b);return zta(c,f,h,d,Mta(e,b))}
r.Qua=function(){var a=this.H.sM();if(a=Rkf(this,a)){var b=this.C.ul?Tkf(this,this.H.EZ()):"";this.L.value=b;this.xb.F=[new ykf(b,this.Kd)]}N(this.L,a);N(this.Rc,a&&!this.C.D);a=this.F.sM();if(a=Rkf(this,a))this.V.value=this.C.ul?Ukf(this,this.F.EZ()):"";N(this.V,a);a=Rkf(this,Skf(this));N(this.Ib,a);this.xa.Ma(!a);this.xa.setContent(Rkf(this,Skf(this))?"Published":"Publish")};
r.nwb=function(a){a=a.target;this.oa();Lbb(this.Ha);"pub-dialog-link-tab"==a.getId()?(this.Ta=0,N(this.Cb,!0),N(this.eb,!1),EA(this.Ha,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.Ta=1,N(this.Cb,!1),N(this.eb,!0),EA(this.Ha,this.V));Vkf(this)};r.bSa=function(a){vn(function(){a.target.select()},0)};r.m1b=function(){this.C.ul?Xkf(this,2,!1):this.C.Zx=!this.C.Zx};r.i1b=function(){this.C.ul?Xkf(this,0,!1):this.C.By=!this.C.By};function Qkf(a){return a.C.ul?"Stop publishing":"Start publishing"}
function Pkf(a,b){zk(wk(a.Ic.cf(a.rc),"id",a.$a),v(function(c){this.C.ul=!!LK(c,"published");this.C.Zx=!!LK(c,"requireSignin");this.C.D=!!LK(c,"domainClosed");this.C.domain=NXb(c,"domain");this.C.F=NXb(c,"domainDisplay");this.C.By=!Number(LK(c,"revision"));this.C.Co=this.RDa(c.Le());this.C.H=NXb(c,"publishedDocumentId");b()},a)).Ve()}r.RDa=he;r.xDa=he;function Ykf(a){return{By:a.C.By,ul:a.C.ul,Zx:a.C.Zx,Co:a.C.Co}}
function Xkf(a,b,c){c=ra(c)?c:!0;var d=Ykf(a);switch(b){case 0:d.By=!d.By;break;case 1:d.ul=!d.ul;break;case 2:d.Zx=!d.Zx;break;default:throw Error("Unknown toggle op: "+b);}d.ul||(d.Co=a.xDa());Zkf(a,d,c)}
function Zkf(a,b,c){$kf(a,!1);yk(zk(xk(uo(wk(a.Ic.cf(a.rc),"id",a.$a),alf(a,b)),2),v(function(){this.C.By=b.By;this.C.ul=b.ul;this.C.Zx=b.Zx;this.C.Co=b.Co;this.C.ul&&this.C.Co&&(Rkf(this,this.H.sM())||this.H.Tsa(this.C.Co),Rkf(this,this.F.sM())||this.F.Tsa(this.C.Co));$kf(this,!0);Vkf(this);if(c&&this.C.ul)switch(this.Ta){case 0:this.L.focus();this.L.select();break;case 1:this.V.focus();this.V.select();break;default:throw Error("Cannot handle selected link type "+this.Ta);}},a)),v(function(){X1b("An error occurred whilst saving publishing settings.",
void 0,this.Db()?this:void 0);$kf(this,!0);Vkf(this)},a)).Ve()}function alf(a,b){var c={id:a.$a,requireSignin:b.Zx,published:b.ul};a.C.C&&!b.By&&(c.revision=a.C.C);b.Co&&(a=blf(b.Co),$d(c,a));return c}function $kf(a,b){for(var c=[a.R,a.ea,a.xa,a.O],d=0;d<c.length;d++){var e=c[d];!b&&e.pk()&&(a.Xa=e);e.Ma(b)}b&&a.Xa&&(a.isVisible()&&a.Xa.isVisible()&&(c=a.Xa.getElement())&&c.focus(),a.Xa=null);a.Qa.J(b)}
r.$Wb=function(a,b){if(b||window.confirm(this.C.ul?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.ea.setContent("Saving..."),Xkf(this,1)};function Skf(a){switch(a.Ta){case 0:return a.H.sM();case 1:return a.F.sM();default:throw Error("Cannot handle selected link type "+a.Ta);}}
r.gub=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=Skf(this),b=Ykf(this);b.ul=!0;a&&(b.Co&&this.C.ul?b.Co=clf(b.Co,a):b.Co=a);this.xa.setContent("Publishing...");Zkf(this,b,!0)}};r.hub=function(){var a=this.Qa.F();if(this.C.ul)if(a&&a.isEmpty())Xkf(this,1);else{var b=Ykf(this);b.Co=a;Zkf(this,b)}else this.C.Co=a,Vkf(this)};function Rkf(a,b){var c;(c=a.C.ul)&&!(c=!b||!a.C.Co)&&(a=a.C.Co,c=a.F||!b.F&&Xc(b.D.Ld(),a.daa,a)&&Xc(b.C,a.M$,a));return c}
function Mkf(a){this.C=a;this.D=this.Zx=this.ul=!1;this.By=!0;this.H=this.F=this.domain=""}function Nkf(){uU.call(this)}x(Nkf,uU);Nkf.prototype.Re=function(a){return a.keyCode&&27==a.keyCode?!1:Nkf.Oa.Re.call(this,a)};function dlf(a,b,c,d){this.F=a;this.Xh=b;this.C=c;this.D=d}function elf(a,b){return new dlf(!1,null,new flf(a,b||"interactive"),null)}function flf(a,b){this.id=a;this.format=b};function G5(a,b,c){this.F=a;this.D=new iJ(b);this.C=c}r=G5.prototype;r.daa=function(a){return this.F||this.D.contains(a)};function glf(a,b){return Uc(a.C,function(c){return c.id==b.id})}r.M$=function(a){return this.F||this.D.contains(a.Xh)||glf(this,a)};function hlf(a,b){a.C=Rc(a.C,function(c){return c.Xh!=b})}function ilf(a,b){glf(a,b)&&(a.C=Rc(a.C,function(c){return c.id!=b.id}))}
function clf(a,b){var c=a.F||b.F;if(c)return new G5(c,[],[]);var d=a.clone();Pc(b.D.Ld(),function(e){d.D.contains(e)||(d.D.add(e),hlf(d,e))});Pc(b.C,function(e){d.M$(e)||d.C.push(e)});return d}function blf(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.Ld().join(","),charts:Sc(a.C,function(b){return b.id}).join(",")}}r.isEmpty=function(){return!this.F&&this.D.isEmpty()&&ad(this.C)};r.clone=function(){return new G5(this.F,this.D.Ld(),jd(this.C))};
r.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&sd(this.C,a.C,function(b,c){return b.id==c.id&&b.Xh==c.Xh})};function jlf(a,b){this.id=a;this.Xh=b};function klf(a,b,c,d){P.call(this,void 0);this.C=c||new dlf(!0,null,null,"html");this.O=d;this.L=a;this.J=b;this.D=new VQ("",llf(a,b));this.D.Wj(!0);this.Fa(this.D,!0);a=new wy;a.Fa(new ry("Interactive","interactive"),!0);a.Fa(new ry("Image","image"),!0);this.H=new VQ("",a);this.Fa(this.H,!0);a=new wy;a.Fa(new ry("Web page","html"),!0);a.Fa(new ry("Comma-separated values (.csv)","csv"),!0);a.Fa(new ry("Tab-separated values (.tsv)","tsv"),!0);a.Fa(new ry("PDF document (.pdf)","pdf"),!0);a.Fa(new ry("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Fa(new ry("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new VQ("",a);this.Fa(this.F,!0);mlf(this)}t(klf,E5);
function llf(a,b){var c=new wy;c.Fa(new ry("Entire Document",new nlf("entireDocument",null)),!0);c.Fa(new vy,!0);var d=Dbc(b);Pc(a.D,function(e){c.Fa(new ry(e.$d(),new nlf("sheet",e.Bb())),!0);if(e=d[e.Bb()])for(var f={},h=0;h<e.length;f={nW:f.nW},h++){var k=e[h];6==k.getType()&&k.isSaved()&&(f.nW=new ry("",new nlf("chart",UK(k))),IN(k).then(function(l){return function(m){l.nW.Vj(m.getTitle())}}(f)),c.Fa(f.nW,!0),V(f.nW.Eb(),"pub-dialog-link-options-chart-menu-item"))}});return c}r=klf.prototype;
r.Ga=function(){E5.prototype.Ga.call(this);V(this.getElement(),"pub-dialog-link-options-container");V(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");V(this.D.Eb(),"pub-dialog-link-options-document-part-menu-button-content");V(this.D.Sb().getElement(),"pub-dialog-link-options-document-part-menu");Gw(this.D.La(),"Sheet or chart selection");Gw(this.H.La(),"Chart format");Gw(this.F.La(),"Sheet format");this.getHandler().listen(this.D,"change",this.Ijb).listen(this.H,"change",
this.qgb).listen(this.F,"change",this.Zwb).listen(this.D,"afterhide",function(a){a.stopPropagation()}).listen(this.H,"afterhide",function(a){a.stopPropagation()}).listen(this.F,"afterhide",function(a){a.stopPropagation()})};
r.Ijb=function(){var a=this.D.zf().Ra();switch(a.type){case "entireDocument":this.C=new dlf(!0,null,null,this.C.D||"html");break;case "sheet":a=a.id;var b=this.C.D;b&&!olf(this,a,b)&&(b=null);this.C=new dlf(!1,a,null,b||"html");break;case "chart":this.C=elf(a.id,this.C.C?this.C.C.format:null)}mlf(this);Jkf(this)};r.qgb=function(){var a=this.H.zf().Ra();this.C.C&&(this.C.C.format=a,Jkf(this))};r.Zwb=function(){var a=this.F.zf().Ra();this.C.D=a;Jkf(this)};
function mlf(a){var b=jd(a.D.Qj.C);b=Yc(b,function(c){c=c.Ra();if(!c)return!1;switch(c.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.Xh&&c.id==this.C.Xh;case "chart":return null!=this.C.C&&c.id==this.C.C.id;default:return!1}},a);Py(a.D,b);b=!!a.C.C;N(a.H.getElement(),b);null!=a.C.C&&a.H.setValue(a.C.C.format);N(a.F.getElement(),a.O&&!b);b||(plf(a),a.F.setValue(a.C.D))}
function plf(a){for(var b=a.F.Sb(),c=0;c<b.Mc();c++){var d=b.Hc(c),e=d.getValue();d.Ma(null==a.C.Xh||olf(a,a.C.Xh,e))}}function olf(a,b,c){if($c(qlf,c))return!1;a=VI(a.L,b);return null!=a&&1==a.getSheetType()&&$c(rlf,c)?!1:!0}r.EZ=g("C");r.sM=function(){if(this.C.F)return new G5(!0,[],[]);if(null!=this.C.Xh)return new G5(!1,[this.C.Xh],[]);var a=this.J.Uk(this.C.C.id);a=new jlf(this.C.C.id,a.Bb());return new G5(!1,[],[a])};
r.Tsa=function(a){if(!a.F){var b=a.D.Ld();0<b.length?this.C=new dlf(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=elf(a[0].id)));mlf(this)}};var qlf=["xlsx","ods"],rlf=["csv","tsv"];function nlf(a,b){this.type=a;this.id=b};function slf(a,b){VQ.call(this,void 0,void 0);this.R=a;this.O=b;this.C=new G5(!0,[],[]);this.L=!1;this.D=new bW("Entire Document");this.Pc(this.D);this.Pc(new vy);tlf(this);this.Wj(!0);ulf(this)}t(slf,VQ);function tlf(a){var b=Dbc(a.O);Pc(a.R.D,function(c){var d=new bW(c.$d(),c);a.Pc(d);(c=b[c.Bb()])&&Pc(c,function(e){if(6==e.getType()&&e.isSaved()){var f=new bW("",e);IN(e).then(function(h){f.Vj(h.getTitle())});a.Pc(f);V(f.Eb(),"pub-dialog-published-content-chart-menu-item")}})})}
slf.prototype.Ga=function(){VQ.prototype.Ga.call(this);V(this.getElement(),"pub-dialog-published-content-menu-button");V(this.Eb(),"pub-dialog-published-content-menu-button-content");V(this.Sb().getElement(),"pub-dialog-published-content-menu");this.getHandler().listen(this,"afterhide",function(a){a.stopPropagation()})};
slf.prototype.fw=function(a){if(a.target==this.D){a=this.D.isChecked();var b=this.C;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.Ra(),b instanceof QG?(b=b.Bb(),a?(a=this.C,a.D.contains(b)||(a.D.add(b),hlf(a,b))):(a=this.C,a.D.contains(b)&&(a.D.remove(b),hlf(a,b)))):(b=new jlf(UK(b),b.Bb()),a?(a=this.C,a.M$(b)||a.C.push(b)):ilf(this.C,b));this.L=!0;ulf(this)};slf.prototype.Cd=function(a,b){VQ.prototype.Cd.call(this,a,b);!a&&this.L&&(this.L=!1,this.dispatchEvent(new Sm("$h")))};
function ulf(a){var b=a.C.F;a.D.dc(b);Pc(k5a(a.Sb()),function(c){var d=c.Ra();d&&(d instanceof QG?(c.dc(a.C.daa(d.Bb())),c.Ma(!b)):(d=new jlf(UK(d),d.Bb()),c.dc(a.C.M$(d)),c.Ma(!a.C.daa(d.Xh))))});vlf(a)}
function vlf(a){if(a.C.F)a.setContent("Entire Document");else{var b=Rc(a.R.D,v(function(h){return this.C.daa(h.Bb())},a)),c=Sc(b,function(h){return h.$d()});b=[];for(var d=a.C.C,e=0;e<d.length;e++){var f=a.O.Uk(d[e].id);f&&b.push(IN(f))}Hya(b).then(function(h){for(var k=[],l=0;l<h.length;l++){var m=h[l];m.pR&&k.push(m.value.getTitle())}h=id(c,k);h=0<h.length?h.join(", "):"None";a.setContent(h)})}};function wlf(a,b){P.call(this,void 0);this.C=new slf(a,b);this.Fa(this.C,!0);this.D=!1}t(wlf,Kkf);wlf.prototype.Ga=function(){Kkf.prototype.Ga.call(this);V(this.getElement(),"pub-dialog-published-content-container")};wlf.prototype.F=function(){return this.C.C};wlf.prototype.H=function(a){var b=this.C;b.C=a.clone();ulf(b)};wlf.prototype.J=function(a){!a&&this.C.pk()&&(this.D=!0);this.C.Ma(a);a&&this.D&&(this.Db()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function xlf(a){var b='<div class="pub-dialog-chart-notice">';a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. <a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+(Mhf(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return R(b+a+"</div>")};function ylf(a,b,c,d,e,f,h){var k=null!=h?elf(h):null;h=new klf(c,d,k,!0);k=new klf(c,d,k,!1);F5.call(this,a,b,e,"spreadsheets",f,h,k,new wlf(c,d),"/publishingsettings",new zlf);this.Zd=c;this.Zb=d}t(ylf,F5);
ylf.prototype.RDa=function(a){if(a.entireDocument)return new G5(!0,[],[]);var b=a.charts||"";a=Rc((a.sheets||"").split(","),function(c){return null!=VI(this.Zd,c)},this);b=Rc(b.split(","),v(function(c){return!!this.Zb.Uk(c)},this));b=Sc(b,function(c){var d=this.Zb.Uk(c);return new jlf(c,d.Bb())},this);return new G5(!1,a,b)};ylf.prototype.xDa=function(){return new G5(!0,[],[])};
function Tkf(a,b){if(b.F||null!=b.Xh){var c="html"==b.D;a=Wkf(a,c?"/pubhtml":"/pub");null!=b.Xh&&(a=al(a,"gid",b.Xh,"single","true"));c||(a=al(a,"output",b.D))}else a=al(Wkf(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function Ukf(a,b){var c=Tkf(a,b);if(b.F||null!=b.Xh)c=al(c,"widget","true","headers","false");a=b.C?(a=a.Zb.Uk(b.C.id))?a.Vc():null:null;a=a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"";c=Ze(c);return"<iframe "+a+'src="'+c+'"></iframe>'}function zlf(){P.apply(this,arguments)}t(zlf,P);zlf.prototype.Aa=function(){this.wb(W(xlf,{locale:"en-GB"}))};function Alf(a,b,c,d){MR.call(this,134,a,b);this.F=c;this.C=d}t(Alf,MR);Alf.prototype.Hd=function(){var a=this.Ra().kc(),b=tm(this.getRect(),a);a=new FG;I(a,1,b);b=ka(this.F);for(var c=b.next();!c.done;c=b.next())Yf(a,2,c.value);I(a,3,this.C);return a};Alf.prototype.tM=function(){return rGb.va()};function Blf(a,b,c){b=c||b;c=a.VYb;var d=a.Y9a;Ca(a.zQ);a=a.zQ;c='<div class="'+U("waffle-rd-section")+'" role="group" tabindex="0" aria-labelledby="'+U("waffle-rd-title-data")+'"><div id="'+U("waffle-rd-title-data")+'" class="'+U("waffle-rd-selection-description")+'" tabindex="0">'+Q(c)+'</div><div class="'+U("waffle-rd-expand-to-range")+'"'+(d?"":' style="display: none;"')+' tabindex="0" role="button">'+Q(d)+'</div><div class="'+U("waffle-rd-ignore-headers")+'"><span class="'+U("waffle-rd-checkbox")+
'"></span><div class="'+U("waffle-rd-checkbox-label")+'">'+Q("Data has header row")+'</div></div></div><div class="'+U("waffle-rd-section")+'" role="group" tabindex="0" aria-labelledby="'+U("waffle-rd-title-cta")+'"><div id="'+U("waffle-rd-title-cta")+'" class="'+U("waffle-rd-section-title")+'">';c=c+"Columns to analyse</div>"+(Clf({zQ:a},b)+"</div>");return R(c)}
function Clf(a){Ca(a.zQ);a=a.zQ;for(var b='<div class="'+U("waffle-rd-columns-container")+'">',c=a.length,d=0;d<c;d++){var e=a[d];b+='<div class="'+U("waffle-rd-columns-checkbox")+'"><span class="'+U("waffle-rd-checkbox")+'"></span><div class="'+U("waffle-rd-checkbox-label")+'">'+Q(e.label)+"</div></div>"}return R(b+"</div>")};function Dlf(a,b,c,d,e){qA.call(this,void 0,!1);this.C=a;this.Qa=b;this.Ha=c;this.ea=d;this.R=e;this.O=gy(new fy,1).build();this.V=this.xa=null;this.F={};this.L=null;this.H=new kT(!1,hT.getInstance(),this.oa())}t(Dlf,qA);r=Dlf.prototype;r.Ia=function(){qA.prototype.Ia.call(this);F(this.xa);F(this.V);F(this.F);F(this.L)};
r.Aa=function(){qA.prototype.Aa.call(this);this.setTitle("Remove duplicates");V(ax(this),"waffle-rd-dialog-gm");if(!Elf){var a=new dx;a.set("cancel","Cancel",!1,!0);a.set("save","Remove duplicates");Elf=a}gx(this,Elf);sx(this,"save");var b=this.C.Nc();a=b.height+(" rows and "+(b.width+" columns selected"));var c=E3a(this);c&&Gw(c,"Remove duplicates "+a);c=null;Flf(this)&&(c="Expand to "+zN(this.ea));b=Glf(this,b);b=Sc(b,function(d){return Hlf(d)});a=W(Blf,{VYb:a,Y9a:c,zQ:b});c=this.Eb();this.oa().appendChild(c,
a)};r.Ga=function(){qA.prototype.Ga.call(this);this.V=St("waffle-rd-expand-to-range",void 0);this.xa=St("waffle-rd-selection-description",void 0);this.L=St("waffle-rd-columns-container",void 0);this.getHandler().listen(this,"dialogselect",this.wLb).listen(this,"change",this.Pgb).listen(this.H,"change",this.vnb).Df(this.V,cn,this.JGa);var a=this.C.Nc(),b=St("waffle-rd-ignore-headers",void 0);b=hu(b);var c=iu(b),d=this.H;d.Va(b);jT(d,c);d.Ma(1<a.height);Ilf(this,a)};
r.wLb=function(a){var b=this;if("save"==a.key){a=Jlf(this);var c=Klf(this,a),d=!!this.H.zm();a=new Alf(this.C,a,c,d);GK(a,function(e,f){e?(f&&(e=H(f,1),e=(new Qz("{ROWS,plural, =0{No duplicate rows were found.}=1{1 duplicate row found and removed.}other{{ROWS} duplicate rows found and removed.}}")).format({ROWS:e}),f=H(f,2),f=(new Qz("{ROWS,plural, =1{1 unique row remains.}other{{ROWS} unique rows remain.}}")).format({ROWS:f}),f=Ie(e+"\n\n"+f),sK(f,"Remove duplicates")),b.R.C(35997,b.O)):b.R.C(35996,
b.O)});this.Ha.C(a);this.R.C(this.H.zm()?35993:35994,this.O)}else"cancel"==a.key&&this.R.C(35995,this.O)};r.JGa=function(){if(Flf(this)){var a=this.ea,b=this.Qa;OJ(this.C,a);YN(b.L);CR(b,!0);b=a.height+(" rows and "+(a.width+" columns selected"));this.xa&&tu(this.xa,b);var c=E3a(this);c&&Gw(c,"Remove duplicates "+b);Llf(this);this.L&&(b=Glf(this,a),b=Sc(b,function(d){return Hlf(d)}),b=W(Clf,{zQ:b}),bu(this.L),au(this.L,b.childNodes),Ilf(this,a));this.H.Ma(1<a.height);this.R.C(35998,this.O);this.focus()}};
r.Pgb=function(a){var b=Jd(this.F,function(e,f){return-1!=f});b=Nd(b);var c=this.F[-1];if(a.target==c){var d=c.zm();Pc(b,function(e){e.dc(d)})}a=Tc(b,function(e,f){return e+(f.zm()?1:0)},0);c.dc(a==b.length);jx(this.D,"save",0<a)};r.vnb=function(){var a=this,b=this.C.Nc();b=Glf(this,b);Pc(b,function(c){var d=c.getColumn();d=a.F[d].getElement();d=iu(d);c=c.getLabel();tu(d,c)})};function Jlf(a){var b=a.C.Nc(),c=im(b,"r");a.H.zm()&&1<c&&(b=fva(b,-1));return b}function Llf(a){(a=a.V)&&N(a,!1)}
r.P0a=function(){MJ(this.C)&&this.JGa()};function Flf(a){var b=a.C.Nc();return!!a.ea&&a.ea.Mh()>b.Mh()}r.ZZb=function(){return MJ(this.C)&&!Flf(this)};function Ilf(a,b){var c=a.Ki("waffle-rd-columns-checkbox");b=Glf(a,b);for(var d=0;d<c.length;d++){var e=b[d],f=hu(c[d]),h=iu(f),k=a.F[e.getColumn()],l=a,m=new kT(!1,hT.getInstance(),l.oa());m.Sd(l);var p=e.getColumn();l=l.F[p]=m;l.Va(f);jT(l,h);e=k?k.zm():e.zm();l.dc(e)}}
function Glf(a,b){var c=[];c.push(new Mlf(-1,"Select all"));var d=b.xc(),e=b.cd(),f=a.H.zm();for(b=b.Bc();d<e;d++){var h=uN(d),k=af(a.C.Pg(b,d).getDisplayValue(),25);c.push(new Mlf(d,Bd(k)||!f?"Column "+h:"Column "+(h+(" - "+k))))}return c}function Klf(a,b){var c=b.xc();b=b.cd();for(var d=[],e=null,f=c;f<b;f++)a.F[f].zm()?e?(e=cg(e,1),e=kva(e,f+1-c)):e=kva(f-c,f+1-c):e&&(d.push(e),e=null);e&&d.push(e);return d}var Elf=null;function Mlf(a,b){this.C=a;this.D=b}Mlf.prototype.getColumn=g("C");
Mlf.prototype.getLabel=g("D");Mlf.prototype.zm=n(!0);function Hlf(a){return{column:a.C,label:a.D,checked:!0}};function Nlf(a){a=""+Olf({id:"waffle-resize-selection-custom",wt:a.wia,hk:rw("<br/>"+Q(oif({id:"waffle-resize-input",xd:"waffle-resize-inset-input"})))});a+=Olf({id:"waffle-resize-selection-auto",wt:"Fit to data",hk:rw("")});return R(a)}function Olf(a){var b=a.id,c=a.wt;a=a.hk;return R('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+U(b)+'"><label for="'+U(b)+'" class="waffle-resize-label">'+Q(c)+"</label>"+Q(a)+"</div>")}
function Plf(a){a=a.wia;a='<div id="waffle-resize-input-error-butter-container" class="waffle-input-error-butter-container"><div id="waffle-resize-butter-bar-wrap" class="waffle-input-error-butter-wrap"></div></div>'+Olf({id:"waffle-resize-selection-custom",wt:"Specify row height",hk:rw('<div class="waffle-resize-row-input-container">'+Q(oif({id:"waffle-resize-input",xd:"waffle-resize-row-input"}))+'<label for="waffle-resize-input" class="waffle-resize-row-input-label">'+Q(a)+"</label></div>")});
a+=Olf({id:"waffle-resize-selection-auto",wt:"Fit to data",hk:rw("")});return R(a)};function Qlf(a,b,c,d,e){qA.call(this);this.H=a;this.V=b;var f=fm(this.H.Nc());this.O=f;this.C=Rc(GJ(this.H),function(h){return fm(h)==f});this.R=new Sz;this.L=new X7d;this.Qa=c;this.Ta=d;this.xa=e;this.ea=this.D;this.F=null;this.Ha=this.H instanceof Loc}t(Qlf,qA);r=Qlf.prototype;r.Aa=function(){qA.prototype.Aa.call(this);this.setTitle(Rlf(this));"r"==this.O?this.Eb().appendChild(W(Plf,{wia:Slf(this)})):this.Eb().appendChild(W(Nlf,{wia:Slf(this)}));sx(this,"ok")};
r.Ga=function(){qA.prototype.Ga.call(this);var a=this.oa(),b="r"==this.O;this.R.Va(a.getElement("waffle-resize-input"));var c=this.H.Nc(),d=fm(c);c=zHb(eTb(this.H,d,dm(c,d)));this.R.setValue(String(c));Y7d(this.L,"waffle-resize-selection");if(b){a:{b=null;for(c=0;c<this.C.length;c++){d=this.C[c];for(var e=d.top,f=0;f<d.height;f++){var h=ritz_api.RitzModelApi.isDimensionForcedSize(this.H.Ta,!0,e+f);if(null==b)b=h;else if(b!=h){b=null;break a}}}b=b?"waffle-resize-selection-custom":"waffle-resize-selection-auto"}null!=
b?Z7d(this.L,b):jx(this.ea,"ok",!1);this.F=new pz(a.getElement("waffle-resize-input-error-butter-container"));this.F.setType("warning");this.F.setContent("");this.F.render(a.getElement("waffle-resize-butter-bar-wrap"));z7a(this.F,!0);this.F.setVisible(!1)}else Z7d(this.L,"waffle-resize-selection-custom");this.Ha&&this.L.Ma("waffle-resize-selection-auto",!1);this.getHandler().listen(this,"dialogselect",this.yLb).listen(this.R.getElement(),"focus",this.qAb).listen(this.R.getElement(),"change",this.xLb).listen(this.L,
"change",this.wvb)};r.qAb=function(){Z7d(this.L,"waffle-resize-selection-custom");jx(this.ea,"ok",!0)};r.wvb=function(){"r"==this.O&&(jx(this.ea,"ok",!0),this.F.setVisible(!1))};r.xLb=function(){"r"==this.O&&this.F.setVisible(!1)};r.focus=function(){this.Db()&&"waffle-resize-selection-custom"==$7d(this.L)&&Vz(this.R)};
function Rlf(a){var b=a.C[0];if("r"==a.O){var c=b.Bc();b=b.$c()-1;var d=String(sN(c+1)),e=String(sN(b+1));return 1<a.C.length?"Resize selected rows":c==b?"Resize row "+d:"Resize rows "+(d+(" - "+e))}c=b.xc();b=b.cd()-1;d=uN(c);return 1<a.C.length?"Resize selected columns":c==b?"Resize column "+d:"Resize columns "+(d+(" - "+uN(b)))}function Slf(a){return"c"==a.O?"Enter new column width in pixels. (Default: "+(BHb+")"):"pixels (Default: "+(AJ+")")}
r.yLb=function(a){if("ok"==a.key){var b="r"==this.O;if("waffle-resize-selection-custom"==$7d(this.L)){var c=lf(this.R.getValue()),d=isNaN(c)?"Entered value is not a number.":2>c||2E3<c?"Size must be between 2 and 2000 pixels.":null;null!=d?("r"==this.O?(this.F.setContent(d),this.F.setVisible(!0)):sK(d),a.preventDefault()):(this.xa.C(b?35979:35308),a=this.Ha?new fid(this.H,c,this.C):new did(this.H,this.C[0],c,this.C.slice(1)),b&&(a.L=!0),this.V.C(a))}else"waffle-resize-selection-auto"==$7d(this.L)&&
(b?(this.xa.C(35980),this.V.C(new did(this.H,this.C[0],null,this.C.slice(1)))):(NK(this.Qa),this.xa.C(35307),hid(this.C,this.Ta,this.V)))}};function Tlf(a){Gi(this,a,0,-1,null,null)}x(Tlf,Fi);r=Tlf.prototype;r.Pv=function(){return K(this,2)};r.kC=function(a){L(this,2,a)};r.getType=function(){return K(this,3)};r.setType=function(a){L(this,3,a)};r.clearType=function(){L(this,3,void 0)};r.hasType=function(){return null!=K(this,3)};function Ulf(a){a=a.eDb;return R('<div><div class="'+U("waffle-notification-helplink-container")+'" align="right"></div><div class="'+U("waffle-notification-rulearea-container")+" "+U("waffle-dialog-notifications-bounds")+'"><div class="'+U("waffle-notification-editrule-container")+'"></div><div class="'+U("waffle-notification-listrule-container")+'"></div></div>'+(a?"":'<div class="'+U("waffle-notification-addbutton-container")+'"></div>')+"</div>")}
function Vlf(a){var b=a.x9a;a='<div class="'+U("waffle-dialog-notifications")+'"><div class="'+U("waffle-notification-rule-area")+'"><div class="'+U("waffle-dialog-notifications-toplabel")+'">';b="Notify me at "+(Q(b)+" when...");a=a+b+('</div><div class="'+U("waffle-notification-top-group")+'" role="radiogroup"><div class="'+U("waffle-notification-any-change-container")+" "+U("waffle-dialog-notifications-input")+'" role="presentation"></div><div class="'+U("waffle-notification-form-submit-container")+
" "+U("waffle-dialog-notifications-input")+'" role="presentation"></div></div><div class="'+U("waffle-notification-rule-area-separator")+'"></div><div class="'+U("waffle-dialog-notifications-label")+'">');a=a+'Notify me with...</div><div class="'+(U("waffle-notification-bottom-group")+'" role="radiogroup"><div class="'+U("waffle-notification-daily-digest-container")+" "+U("waffle-dialog-notifications-input")+'" role="presentation"></div><div class="'+U("waffle-notification-right-away-container")+
" "+U("waffle-dialog-notifications-input")+'" role="presentation"></div></div></div><div class="'+U("waffle-notification-buttons-container")+'"></div></div>');return R(a)}
function Wlf(a){a=a.tYb;return R('<div class="'+U("waffle-notification-rule-row")+'"><div class="'+U("waffle-notification-rule-description")+'"><span class="'+U("waffle-notification-rule-text")+'">'+Q(a)+'</span></div><div class="'+U("waffle-notification-rulerow-buttons-container")+'"><div class="'+U("waffle-notification-rulerow-edit-container")+'"></div><div class="'+U("waffle-notification-rulerow-delete-container")+'" width="50px"></div></div><div class="'+U("waffle-notification-rule-separator")+
'"></div></div>')};function Xlf(a){P.call(this,a);a=dB.getInstance();this.ea=B(A(),"docs-egmd");this.R=this.O=this.H=this.L=this.J=this.F=null;this.V=a.C.email;this.C=this.D=null}t(Xlf,P);r=Xlf.prototype;
r.Aa=function(){P.prototype.Aa.call(this);var a=this.oa(),b=W(Vlf,{x9a:this.V});this.wb(b);this.C=new aZ;this.qa(this.C);this.F=new $Y;this.F.yE(a.Aa("LABEL",null,"Any changes are made"));this.F.render(this.Ea("waffle-notification-any-change-container"));this.C.wI(this.F);this.J=new $Y;this.J.yE(a.Aa("LABEL",null,"A user submits a form"));this.J.render(this.Ea("waffle-notification-form-submit-container"));this.C.wI(this.J);this.D=new aZ;this.qa(this.D);this.H=new $Y;this.H.yE(a.Aa("LABEL",null,"Email - daily digest"));
this.H.render(this.Ea("waffle-notification-daily-digest-container"));this.D.wI(this.H);this.L=new $Y;this.L.yE(a.Aa("LABEL",null,"Email - straight away"));this.L.render(this.Ea("waffle-notification-right-away-container"));this.D.wI(this.L);b=this.Ea("waffle-notification-buttons-container");this.R=new hz("Cancel",a);this.Fa(this.R,!1);this.R.render(b);this.O=iz("Save",a);this.Fa(this.O,!1);this.O.render(b);this.ea&&V(this.O.getElement(),"waffle-notification-end-button")};
r.Ga=function(){P.prototype.Ga.call(this);this.getHandler().listen(this.O,"action",this.AYb,!0).listen(this.R,"action",v(this.dispatchEvent,this,new Sm("cancelRuleEdit"))).listen(this.C,"change",this.cqa).listen(this.D,"change",this.cqa)};r.Pb=function(a){P.prototype.Pb.call(this,a);a?1==a.getType()?bZ(this.C,this.F):2==a.getType()&&bZ(this.C,this.J):bZ(this.C,null);a?2==a.Pv()?bZ(this.D,this.H):1==a.Pv()&&bZ(this.D,this.L):bZ(this.D,null);this.cqa()};
r.focus=function(){var a=cZ(this.C),b=dZ(this.C,0);(a||b).getElement().focus()};r.setVisible=function(a){this.getElement()&&N(this.getElement(),a)};r.AYb=function(){this.dispatchEvent(new Sm("saveRule",Ylf(this)))};function Ylf(a){var b=new Tlf,c=a.Ra();c&&(c=K(c,1),L(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?b.kC(1):a.H.isChecked()&&b.kC(2);return b}r.cqa=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.Ma(a)};function Zlf(a){var b=a.qua;return R("<div><div>"+Q(a.P2a)+"</div>"+Q(p5c({id:"waffle-confirm-suppress-checkbox",xd:"waffle-confirm-suppress-checkbox"},void 0))+'<span id="waffle-confirm-suppress-label">'+Q(b)+"</span></div>")};function $lf(a,b,c,d,e,f,h){var k=B(A(),"docs-egmd");if(Ga(c)){var l=new dx;k&&l.set("cancel",c.cancel,!1,!0);l.set("ok",c.ok,!0);k||l.set("cancel",c.cancel,!1,!0)}else l=k?Cab():C3a();return amf(d||"Heads up!",a,b,l,e,f,h)}
function amf(a,b,c,d,e,f,h){b=Ie(b);if(f){b=hw(Zlf({P2a:b,qua:f}));var k=new lT;var l=c;c=function(){l(k.isChecked())}}a=Z3a(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Fa(k),k.Va(zu(a.oa(),"waffle-confirm-suppress-checkbox")),c=zu(a.oa(),"waffle-confirm-suppress-label"),jT(k,c),k.dc(!1));return a};function bmf(a,b){P.call(this,b);this.Pb(a)}t(bmf,P);
bmf.prototype.Aa=function(){P.prototype.Aa.call(this);var a=this.Ra(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==a.Pv()?c+="send digest email":1==a.Pv()&&(c+="send email");a=W(Wlf,{tYb:"If "+(b+(" then "+c))});this.wb(a);a=Ix(ly,"waffle-notifications-add");this.D=new ny("Edit",a,this.oa());this.D.Qc("goog-link-button");this.D.Qc("menuMainLink");this.Fa(this.D,!1);this.D.render(this.Ea("waffle-notification-rulerow-edit-container"));this.C=new ny("Delete",
a,this.oa());this.C.Qc("goog-link-button");this.C.Qc("menuMainLink");this.Fa(this.C,!1);this.C.render(this.Ea("waffle-notification-rulerow-delete-container"))};bmf.prototype.Ga=function(){P.prototype.Ga.call(this);this.getHandler().listen(this.D,"action",this.H);this.getHandler().listen(this.C,"action",this.F)};bmf.prototype.H=function(){this.dispatchEvent(new Sm("edit",this.Ra()))};
bmf.prototype.F=function(){var a=v(function(){this.dispatchEvent(new Sm("del",this.Ra()))},this),b=v(function(){this.C.getElement().focus()},this);$lf("Are you sure that you want to delete this notification rule?",a,void 0,void 0,b)};function cmf(a){P.call(this,a)}t(cmf,P);cmf.prototype.Aa=function(){var a=this.oa().Aa("DIV",{className:"waffle-dialog-notifications-list",width:"100%"});this.wb(a)};cmf.prototype.setVisible=function(a){this.getElement()&&N(this.getElement(),a)};function dmf(a,b,c){qA.call(this,void 0,!1,c);this.V=b;this.L=a;this.setTitle("Set notification rules");cx(this,!1);a=new dx;a.set("cancel","Done",!1,!0);gx(this,a);this.C=new Xlf(c);this.Fa(this.C,!1);this.H=new cmf;this.Fa(this.H,!1);this.F=new ny("Add another notification rule",cO.getInstance(),this.oa());this.Fa(this.F,!1);this.O=new ny("Help",cO.getInstance(),this.oa());this.Fa(this.F,!1);this.R=B(A(),"docs-egmd")}t(dmf,qA);r=dmf.prototype;
r.Aa=function(){qA.prototype.Aa.call(this);var a=this.oa();V(ax(this),"waffle-notifications-dialog");a.appendChild(this.Eb(),W(Ulf,{eDb:this.R}));if(this.R){var b=a.Aa("DIV","waffle-notification-helpbutton-container");this.O.render(b);a.appendChild(Yw(this),b);b=a.Aa("DIV","waffle-notification-addbutton-container");this.F.render(b);a.Gu($w(this),b,0)}else b=a.Aa("A",{target:"_blank"},"Help"),Qe(b,"https://support.google.com/docs/answer/91588"),a.appendChild(this.Ea("waffle-notification-helplink-container"),
b),this.F.render(this.Ea("waffle-notification-addbutton-container"));this.H.render(this.Ea("waffle-notification-listrule-container"));this.C.render(this.Ea("waffle-notification-editrule-container"));sx(this,"")};r.Ga=function(){qA.prototype.Ga.call(this);this.getHandler().listen(this,"edit",this.BLb).listen(this,"del",this.ALb).listen(this.F,"action",this.zLb).listen(this,"saveRule",this.zYb).listen(this,"cancelRuleEdit",this.V1a).listen(this.O,"action",function(){return dw("https://support.google.com/docs/answer/91588")})};
r.Q0=function(a){this.isDisposed()||(this.C.setVisible(!1),emf(this,!1),gta(this.L,"/notifications/list",v(this.N1b,this,a)).Ve())};
r.N1b=function(a,b,c){if(!this.isDisposed()){b=c.Le();c=[];for(var d=0;d<b.length;d++)c[d]=new Tlf(b[d]);this.Pb(c);if(a&&0==c.length)fmf(this,null,!1);else{if(a=this.Ra())if(b=this.H,b.hd(!0),b.oa().hd(b.Eb()),b.Pb(a),c=b.oa(),0==a.length)c.appendChild(b.Eb(),c.Aa("DIV",null,c.Aa("DIV",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Fa(new bmf(a[d],c),!0);emf(this,!0);this.focus()}}};
r.zYb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();K(a,1)?uo(gta(this.L,"/notifications/set",v(this.Q0,this,!1)),{rule:b}).Ve():uo(gta(this.L,"/notifications/create",v(this.Q0,this,!1)),{rule:b}).Ve();if(1==a.getType())a=1==a.Pv()?36011:36010;else if(2==a.getType())a=1==a.Pv()?36013:36012;else throw Error("Unexpected rule type: "+a.getType());b=gy(new fy,1).build();this.V.C(a,b)};r.V1a=function(){this.C.setVisible(!1);this.Q0(!1)};r.BLb=function(a){fmf(this,a?a.target:null,!0)};
r.zLb=function(){fmf(this,null,!0)};function fmf(a,b,c){emf(a,!1);var d=a.C;d.Pb(b);d.setVisible(!0);c&&a.C.focus()}r.ALb=function(a){this.H.setVisible(!1);a=a.target;uo(gta(this.L,"/notifications/delete",v(this.Q0,this,!1)),{rule_id:K(a,1)}).Ve()};function emf(a,b){a.H.setVisible(b);var c=$w(a);N(c,b);a.F.setVisible(b)}r.show=function(){this.setVisible(!0);this.Q0(!0)};function gmf(a,b,c,d,e){vK.call(this,68);this.O=a;this.L=b;this.F=c;this.J=d;this.C=e}t(gmf,vK);gmf.prototype.Hd=function(){var a=new xG;this.O&&I(a,1,this.O);ra(this.L)&&I(a,2,this.L);ra(this.F)&&I(a,3,this.F);this.J&&I(a,4,this.J);ra(this.C)&&I(a,5,this.C);return a};gmf.prototype.k0=function(a,b){(ra(this.F)||ra(this.J)||ra(this.C))&&ritz_api.RitzModelApi.requestCalculation(!0);vK.prototype.k0.call(this,a,b)};function hmf(a,b,c){b=c||b;c=a.v_b;var d='<tr class="dialog-settings-general-settings-div"><div class="dialog-settings-display-language">';a='<span id="ds-settings-link-desc">Display language: </span><a aria-labelledby="ds-settings-link-desc ds-settings-link" id="ds-settings-link" target="_blank">'+(Q(a.e4a)+"</a>");d=d+a+"</div>";c&&(d+='<div class="dialog-settings-english-name-div">'+Q(p5c({id:"waffle-settings-dialog-english-name-checkbox"},b))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">',
d+="Always use English function names</label></div>");return R(d+"</tr>")}function imf(){return R('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function jmf(a,b,c,d){qA.call(this);this.Ib=a;this.Ac=b;this.L=c;this.hc=d;this.C={};this.xb=this.$a=!1;this.Zb=this.Cb=this.eb="";this.rc=new qk;this.H=[];this.F=this.rc.Sc(NNa.va(),ritz_api.RitzModelApi.getWorkbookProperties());this.setTitle("Settings for this spreadsheet");this.Xa=!1;this.V=null;this.Qa=new lT;this.Fa(this.Qa);this.R=new XV;this.Fa(this.R);this.O=new XV;this.Fa(this.O);this.Ya=new uU;this.Fa(this.Ya);this.Ha=this.Ta=null;this.Tb=new Nz(1);this.ea=this.xa="";kmf(this,0);kmf(this,
1);kmf(this,2);kmf(this,3);this.C[4]=new Sz;this.C[5]=new Sz}t(jmf,qA);function kmf(a,b){a.C[b]=Gif();a.C[b].dP=!0}r=jmf.prototype;
r.Aa=function(){qA.prototype.Aa.call(this);var a=this.Eb();V(this.getElement(),"dialog-settings");var b=this.oa(),c=[lmf(b,"Locale","waffle-settings-label-locale"),mmf(this,b,"This affects formatting details such as functions, dates and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),nmf(this),lmf(b,"Time zone","waffle-settings-label-timezone"),mmf(this,b,"Your spreadsheet's history will be recorded in this time zone. This will change all time-related functions.",
1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),nmf(this)],d=[];d.push(lmf(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(mmf(this,b,"This affects how often NOW, TODAY, RAND and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(nmf(this));d.push(lmf(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=b.Aa("A",{target:"_blank",href:"https://support.google.com/docs/answer/58515"},
" Learn more about iterative calculation.");d.push(mmf(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=lmf(b,"Max. number of iterations","waffle-settings-label-maxiterations");d.push(e);this.H.push(e);e=mmf(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");
omf(e);d.push(e);this.H.push(e);e=lmf(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.H.push(e);e=mmf(this,b,"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");omf(e);d.push(e);this.H.push(e);"OFF"==this.C[3].zf().getValue()&&pmf(this);d.push(nmf(this));c=id(c,d);c.push(W(hmf,{e4a:this.Cb,v_b:this.Xa}));this.Ta=b.Aa("TABLE","dialog-settings",
b.Aa("TBODY",null,c));this.Ha=b.Aa("table","dialog-settings",b.Aa("tbody",null,d));c=W(imf);b.appendChild(a,c);this.Ya.Va(c);b.appendChild(a,this.Ta);b.appendChild(a,this.Ha);N(this.Ha,!1);qmf||(a=new dx(b),B(A(),"docs-egmd")?(a.set("cancel","Cancel",!1,!0),a.set("save","Save settings",!0)):(a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0)),qmf=a);gx(this,qmf);rmf(this,4,Wf(this.F,3)&&H(this.F,3).f$()?H(this.F,3).T7().toString():"50");rmf(this,5,Wf(this.F,3)&&H(this.F,3).b$()?H(this.F,
3).B7().toString():"0.05");sx(this,"save")};function omf(a){a=a.firstChild.firstChild;V(a,"jfk-textinput");uv(a,"width","7em")}function pmf(a){for(var b=0;b<a.H.length;b++)N(a.H[b],!1)}function lmf(a,b,c){return a.Aa("TR",null,a.Aa("TD",{id:c,"class":"dialog-settings-label"},b))}
function mmf(a,b,c,d,e,f,h){b=b.Aa("TR",null,b.Aa("TD","dialog-settings-input"),b.Aa("TD",{id:f,"class":"dialog-settings-text"},c,h||null));a=a.C[d];a.render(b.firstChild);a=a.La();Dw(a,"labelledby",e);Dw(a,"describedby",f);return b}function nmf(a){a=a.oa();return a.Aa("TR",null,a.Aa("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.Aa("HR",{"class":"dialog-settings-sep"})))}
r.Ga=function(){qA.prototype.Ga.call(this);Xm(this,"dialogselect",v(this.CLb,this));this.getHandler().listen(this.C[3],"action",this.L_b);this.getHandler().listen(this.Ya,"select",this.Xyb);var a=this.C[4].getElement();this.R.nj(a);$V(this.R,a,a);this.R.render();ZV(this.R);this.getHandler().listen(a,"change",v(this.n2b,this));a=this.C[5].getElement();this.O.nj(a);$V(this.O,a);this.O.render();ZV(this.O);this.getHandler().listen(a,"change",v(this.m2b,this));if(this.Xa){a=this.oa().getElement("waffle-settings-dialog-english-name-checkbox");
var b=this.oa().getElement("waffle-settings-dialog-english-name-checkbox-label");this.Qa.Va(a);jT(this.Qa,b);this.Qa.dc(acc(this.L.F))}};
r.setVisible=function(a){if(a){if(!this.$a){smf(this);return}var b=this.L.L;rmf(this,0,b.C);b=b.H||gMc().name();this.V&&this.V[b]&&(b=this.V[b]);rmf(this,1,b);rmf(this,2,Wf(this.F,3)&&H(this.F,3).mna()?H(this.F,3).Oja().toString():"");rmf(this,3,Wf(this.F,3)&&Wf(H(this.F,3),1)?H(H(this.F,3),1)?"ON":"OFF":"OFF")}qA.prototype.setVisible.call(this,a);this.$a&&!this.xb&&((a=Ot("ds-settings-link"))&&Qe(a,this.eb),this.xb=!0)};
function smf(a){zk(xo(a.Ac.cf("/info/settings"),tmf(a)),v(function(b){b=b.Le();(b={locale:b.l?umf(b.l):null,AUa:b.tz?umf(b.tz):null,c1b:b.tza,k4a:b.dls,mEb:b.dln,k2b:b.hl},b.locale)&&b.AUa&&(vmf(this,0,b.locale),vmf(this,1,b.AUa),vmf(this,2,wmf),vmf(this,3,xmf),this.eb=b.k4a,this.Cb=b.mEb,this.Zb=b.k2b,this.V=b.c1b,this.Xa=ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.Zb),this.$a=!0);this.setVisible(!0)},a)).Ve()}
function tmf(a){var b=vl(Cu(a.oa()).location.href);a=tl(b,"hl");b=tl(b,"forcehl");return["hl",a,"forcehl",b]}function vmf(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];e=new ry(e.caption,e.value);a.Pc(e);Cw(e.getElement(),"menuitem")}a.Sb().getElement().style.overflow="auto";a.Wj(!0)}function umf(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b}function rmf(a,b,c){(a=a.C[b])&&a.setValue(c)}
r.CLb=function(a){if("save"==a.key)if("ON"!=this.C[3].zf().getValue()||""==this.xa&&""==this.ea){ymf(this);a=this.L.L.C;var b=this.L.L.H;this.V&&b&&this.V[b]&&(b=this.V[b]);this.Ib.C(zmf(this));Amf(this,0,a)||Amf(this,1,b)?(this.Ib.C(Bmf(this)),Cmf(this)):(this.Xa?(b=acc(this.L.F),a=this.Qa.isChecked(),b!=a?(Dcc(this.L,a),b=gy(new fy,1).build(),this.hc.C(a?2433:2434,b),a=!0):a=!1):a=!1,a&&Cmf(this))}else a.preventDefault(),ymf(this),""!=this.xa&&YV(this.R,this.xa,!0),""!=this.ea&&YV(this.O,this.ea,
!0)};r.L_b=function(a){if("ON"==a.target.getValue())for(a=0;a<this.H.length;a++)N(this.H[a],!0);else pmf(this);ymf(this)};function ymf(a){ZV(a.R);ZV(a.O)}r.n2b=function(){this.xa="";var a=this.C[4].getValue()||"";a=this.Tb.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.xa="Please enter an integer value.";else if(0>=a||1E4<a)this.xa="Please enter a value between 1 and 10000."};
r.m2b=function(){this.ea="";var a=this.C[5].getValue()||"";a=this.Tb.parse(a);isNaN(a)?this.ea="Please enter a numeric value.":0>a&&(this.ea="Please enter a non-negative value.")};r.Xyb=function(a){switch(a.target.getId()){case "general-settings-tab":N(this.Ta,!0);N(this.Ha,!1);break;case "calculation-settings-tab":N(this.Ta,!1),N(this.Ha,!0)}};
function zmf(a){var b=a.C,c=b[2].zf().getValue(),d=b[3].zf().getValue();a=b[4].getValue()||"";b=b[5].getValue()||"";var e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new gmf(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}function Bmf(a){var b=a.C;a=a.L.L;var c=b[0].zf();c=null==c?a.C:c.getValue();b=b[1].zf();b=null==b?a.H||gMc().name():b.getValue();return new dMc(c,b)}function Amf(a,b,c){a=a.C[b].zf();return null!=a&&a.getValue()!=c}
function Cmf(a){Lm(a.L.D.D,function(){Cu(a.oa()).location.reload()})}r.Ia=function(){Id(this.C,F);delete this.C;qA.prototype.Ia.call(this)};var qmf=null,wmf=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],xmf=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];function Dmf(a,b,c,d,e,f,h,k){qA.call(this,void 0,!1,k);this.R=this.H=this.O=this.ea=this.V=null;this.Qa=a;this.C=b;this.xa=h;this.F=[];this.Ha=new gEd(a,d,e,f);this.L=B(A(),"docs-egmd")}t(Dmf,qA);r=Dmf.prototype;
r.Aa=function(){qA.prototype.Aa.call(this);var a=this.oa();if(this.L){var b=ax(this);V(b,"waffle-sort-dialog-gm");V(b,"docs-material")}var c=this.C.Nc();b=yN(jm(c));var d=yN(new Bl(c.left+c.width-1,c.top+c.height-1));this.setTitle("Sort range from "+(b+(" to "+d)));Emf||(b=new dx,this.L?(b.set("cancel","Cancel",!1,!0),b.set("save","Sort")):(b.set("save","Sort"),b.set("cancel","Cancel",!1,!0)),Emf=b);gx(this,Emf);sx(this,"save");var e;b=a.Aa("DIV","waffle-sort-dialog-data-header",d=a.Aa("SPAN",this.L?
void 0:"jfk-checkbox"),e=a.Aa("SPAN","waffle-sort-dialog-data-header-checkbox-label","Data has header row"));var f=this.R=new kT(!1,hT.getInstance(),a);f.Va(d);jT(f,e);1==c.height&&f.Ma(!1);VN(this.Qa,this.C.kc(),c,!1)||(f.dc(!0),f.Ma(!1));B(A(),"fetdrisd")&&ritz_api.TablesApi.getTables((new qk).serialize(tm(c,this.C.kc())),v(function(h){if(0<h.length){var k=h[0];h=wm(k.getDimensionTableAccessor().getHeaderRange());if(k=ritz_api.TablesApi.isRowBased(k)&&1==qva(nm(h)))k=tm(c,this.C.kc()),k=h.Bb()==
k.Bb()&&lva(nm(h),nm(k))&&lva(sm(h),sm(k));k&&f.dc(!0)}},this));d=this.Eb();a.appendChild(d,b);this.V=a.Aa("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.Aa("TABLE",{cellSpacing:"0",width:"100%"},this.ea=a.Aa("TBODY")));a.appendChild(d,this.V);b=Fmf(this);this.F.push(b);this.L?(this.H=new ny("Add another sort column",my.getInstance(),a),this.Fa(this.H,!0),uu(this.H.getElement(),!0)):(b=a.Aa("SPAN","menuMainLink waffle-sd-add","+ Add another sort column"),a.appendChild(d,b),uu(b,
!0),Cw(b,"button"),this.O=b)};r.Ga=function(){qA.prototype.Ga.call(this);var a=this.getHandler();a.listen(this,"dialogselect",this.JLb).listen(this.R,"change",this.Ymb);this.L?a.listen(this.H,"action",this.NFa):a.Df(this.O,cn,this.NFa)};
function Fmf(a){var b=a.oa(),c=0==a.F.length,d=new Gmf(a,c,a.C,a.F.length,b),e=b.Aa("TR",null,b.Aa("TD",{colspan:a.L?"5":"4"},b.Aa("DIV","waffle-sd-row-separator")));d.render(a.ea);b.appendChild(a.ea,e);c||(b=a.getHandler(),d.C&&b.Df(d.C,cn,v(a.D3a,a,d)));a=Hmf(a);Imf(d,a);return d}r.D3a=function(a){var b=this.F;if(1<b.length){var c=Oc(b,a);-1!=c&&(hd(b,c),b=a.getElement(),b=iu(b),a.dispose(),du(b),this.O&&(N(this.O,!0),this.O.focus()),this.H&&this.H.setVisible(!0),tK("Sort criteria removed."))}};
function Hmf(a){var b=a.C.Nc(),c=b.xc();b=b.cd();var d=Sc(a.F,function(k){return Jmf(k)},a);if(d)for(var e=a.C.eM(d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=a.C.uD(f);if(!$c(d,h))return h}return null}r.Ymb=function(){for(var a=this.F,b=0;b<a.length;b++)Imf(a[b])};
r.NFa=function(){var a=im(this.C.Nc(),"c");a=Math.max(10,a);this.F.length<a&&(this.F.push(Fmf(this)),tK("Sort criteria added."));Cv(Nc(this.F).getElement(),this.V,!0);this.V.scrollLeft=0;this.F.length>=a&&(this.L&&this.H?this.H.setVisible(!1):N(this.O,!1))};
r.JLb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.F,d=0;d<c.length;d++){var e=c[d];a.push(Jmf(e));e=e.F.isChecked();b.push(e?1:0)}c=this.C.Nc();d=im(c,"r");this.R.isChecked()&&1<d&&(c=fva(c,-1));d=gy(new fy,1).build();this.xa.C(this.R.isChecked()?35697:35698,d);a=new dEd(a,b,this.C,c,this.R.isChecked());hEd(this.Ha,this.C,a)}};r.Ia=function(){qA.prototype.Ia.call(this);zf(this.F)};var Emf=null;
function Gmf(a,b,c,d,e){P.call(this,e);this.L=this.O=this.F=this.D=this.C=null;this.R=-1;this.ea=a;this.H=b;this.J=c;this.V=B(A(),"docs-egmd")}t(Gmf,P);function Jmf(a){return(a=a.D.zf())?a.getValue():-1}
Gmf.prototype.Aa=function(){var a=this.oa(),b=this.H?"Sort by":"then by",c,d;var e=Qu("delete-grey600-24");this.H||(this.C=this.V?W(xA,{icon:e}):a.Aa("SPAN",{title:"Remove sort criteria."},"x"));var f=a.Aa("TD","waffle-sd-delete",this.H?"":this.C),h=a.Aa("TD","waffle-sd-td-rules",a.Aa("LABEL",{id:Vv(this,"csl")},b)),k=b=a.Aa("TD","waffle-sd-column-selector"),l=a.Aa("TD","waffle-sd-td-ascending",d=a.Aa("DIV",null,c=a.Aa("DIV",{"class":"waffle-sort-dialog-radio-option",title:"Ascending"}),e=a.Aa("DIV",
{"class":"waffle-sort-dialog-radio-option",title:"Descending"})));f=this.V?a.Aa("TR","waffle-sd-tr-rules",h,k,l,f):a.Aa("TR","waffle-sd-tr-rules",f,h,k,l);Cw(d,"radiogroup");d=this.F=new $Y(a,Iu(a,FA(tE(!0,this.Fe()))),"ascending");d.render(c);a=this.O=new $Y(a,Iu(a,FA(tE(!1,this.Fe()))),"descending");a.render(e);this.L=new aZ([d,a]);bZ(this.L,d);a=this.D=Gif();a.render(b);Dw(a.getElement(),"label",this.H?"Select first column to sort by:":"Select next column to sort by:");this.C&&(uu(this.C,!0),Cw(this.C,
"button"),Gw(this.C,"Remove sort criteria."));this.wb(f)};function Imf(a,b){var c=a.oa(),d=a.ea.R.isChecked(),e=a.J.Nc(),f=e.Bc(),h=e.xc();e=e.cd();a.R=b||Jmf(a);for(b=a.D.Ei();0<b;b--)a.D.gm(0);for(;h<e;h++)b=af(a.J.Pg(f,h).getDisplayValue(),25),b=new ry(Bd(b)||!d?"Column "+uN(h):b,a.J.uD(h),c),b.Qc("waffle-sd-menu-item"),a.D.Pc(b);a.D.Ye(0);0<=a.R&&a.D.setValue(a.R)}
Gmf.prototype.Ia=function(){P.prototype.Ia.call(this);this.D=this.C=this.J=this.ea=null;F(this.F);F(this.O);F(this.L);this.L=this.O=this.F=null};function Kmf(a,b,c,d){u5.call(this,a,b,c,d,!1)}t(Kmf,u5);Kmf.prototype.O=n("If you continue to edit, the following features will be removed or replaced in the file. The original file with full Office features is always available from File > Version history");function Lmf(a,b,c){return Y3a(a||"There was a problem",Ie(b),void 0,void 0,void 0,void 0,c)};function Mmf(){jK.apply(this,arguments)}t(Mmf,jK);r=Mmf.prototype;r.W$a=function(){return Lmf};r.rab=function(){return $lf};r.CRb=function(a,b,c,d){var e=new wA;a=new rx(a,b,c,d,void 0,!0,void 0);sx(a,"ok");b=v(e.Va,e);a.Sna=b;a.qa(e);a.Mi=!0;a.U8=Bea(Bd);return a};r.Abb=function(){return Qlf};r.m3a=function(a,b,c,d,e,f,h){return new Dmf(a,b,c,d,e,f,h,void 0)};r.k3a=function(a,b,c,d,e){return new Dlf(a,b,c,d,e)};r.Cab=function(){return ljf};r.ZDa=function(){return ckf};r.Oka=function(){return jkf};
r.YDa=function(){return kkf};r.qDa=function(){return Qhf};r.Qab=function(){return lkf};r.Fbb=function(){return jmf};r.Ebb=function(){return ylf};r.tbb=function(){return tkf};r.Dbb=function(){return dmf};r.wab=function(){return Dif};r.Bbb=function(){return zif};r.Cbb=function(){return Yjf};r.vab=function(){return iif};r.Kab=function(){return cif};r.Sbb=function(){return Kmf};r.fab=function(){return gif};r.Y$a=function(){return dif};pK("dialogs",Mmf);
